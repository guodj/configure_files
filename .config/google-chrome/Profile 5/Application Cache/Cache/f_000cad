Af.prototype.laa=ea(35,function(){return yc(this,3)});ex.prototype.laa=ea(34,function(){return yc(this,5)});Af.prototype.d9=ea(33,function(){return B(this,3)});ex.prototype.d9=ea(32,function(){return B(this,5)});Af.prototype.oaa=ea(31,function(){return yc(this,2)});ex.prototype.oaa=ea(30,function(){return yc(this,4)});Af.prototype.t9=ea(29,function(){return B(this,2)});ex.prototype.t9=ea(28,function(){return B(this,4)});function Mwc(a){for(var b in a.C)a.cb(b,!0)}function Nwc(a,b){a.D=b}
function Owc(a){return pC()?(new cC(a.Z)).qc("title"):""}function Pwc(a,b){var c=Xj(a,b);return t(c)?String(Xj(a,b)):null}function Qwc(a){return"%"+a.charCodeAt(0).toString(16)}var Rwc=/['()]/g;function Swc(a){return a.Cm()+ib(a.C)}function Twc(a){var b=new Yd;b.setType(0);var c=new Id,d=new Gd;D(d,1,2);a=Wa(a);D(d,2,a);c.mb(d);d=new nd;d.setType(0);D(c,1,d);D(b,5,c);return b}function Uwc(a){a=Xa(String(a));Rwc.lastIndex=0;return Rwc.test(a)?a.replace(Rwc,Qwc):a}
function Vwc(a){return V("<li class='nfd-format-pill'><div class='nfd-format-display'>"+U(a.wfb)+"</div><div class='nfd-format-sample'>"+U(a.uQb)+"</div></li>")};function Wwc(a,b,c){T.call(this);this.Hf(a);this.D=b;this.C=c}x(Wwc,T);q=Wwc.prototype;q.qa=function(){var a=this.pb(),b=this.C?Haa(wN(a),30):wN(a),a=this.C?hRb(a,this.D):"";this.Aa=Dq(Vwc,{wfb:b,uQb:a})};q.Ja=function(){Wwc.$.Ja.call(this);kl(this.getElement(),!0);var a=new Mp(this.getElement());F(this,a);this.getHandler().R(a,"key",this.H_b).R(this.getElement(),"mousedown",this.G_b).R(this.getElement(),"dblclick",this.Npb)};
q.H_b=function(a){function b(a,b){for(;b=a(b);)if(To(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(dl,this.getElement());break;case 38:b(Uoa,this.getElement())}};q.G_b=function(a){a.preventDefault();this.dispatchEvent("change")};q.Npb=function(){this.dispatchEvent("action")};function Xwc(a,b,c){T.call(this);this.D=b;this.C=c;Ywc(this,a)}x(Xwc,T);Xwc.prototype.qa=function(){this.Aa=this.oa().qa("UL","nfd-pill-container")};function Ywc(a,b){z(b,function(b){a.Ta(new Wwc(b,a.D,a.C),!0)})}Xwc.prototype.filter=function(a){a=a.toLowerCase();this.og(function(b){var c=Ua(ib(a)),d=wN(b.pb()).toLowerCase(),c=c||ab(d,a);S(b.getElement(),c)})};function UW(a){qp.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Wia();this.Ta(this.input,!0);this.J=new T;this.Ta(this.J,!0);a=this.C9();Rb(a,void 0,Swc);this.C=new Xwc(a,this.g0(),this.LUa());this.J.Ta(this.C,!0);Fp(this,null);this.Kj=!0}x(UW,qp);q=UW.prototype;q.BXa=Jf;q.LUa=If;q.isEmpty=function(){return Ua(this.input.Va())};q.Wf=function(){return this.input.pb().Wf()};q.qa=function(){UW.$.qa.call(this);var a=Rk("DIV","dialog-separator");Zk(a,up(this))};
q.Ja=function(){UW.$.Ja.call(this);mo(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.bsb).R(this.C,"action",this.sva).R(this.input.O,"action",this.sva).R(this.input,"afterhide",this.Gkb);this.input.V&&this.getHandler().R(this.input.V,"input",this.z_b);var a=this.input.ma;a&&this.getHandler().R(a,"key",this.A_b);a=this.C9()[0];this.input.kO(a)};q.Gkb=function(a){a.stopPropagation()};q.bsb=function(a){this.input.kO(a.target.pb());Zwc(this.input,!1)};
q.z_b=function(){this.C.filter(this.input.Va());Zwc(this.input,!this.input.pb().Wf())};q.A_b=function(a){13==a.keyCode&&this.sva()};q.sva=function(){this.Wf()&&!this.isEmpty()?(X.y4.Qc(new rN(this.p4(),void 0,this.BXa())),this.setVisible(!1)):(Zwc(this.input,!0),this.input.eHa())};function VW(a,b,c,d,e){eq.call(this,b,c,d,e);this.C=a}x(VW,eq);VW.prototype.Kn=function(){var a=VW.$.Kn.call(this),b=this.getParent();return b&&b instanceof Ur&&!b.sb()?this.C(a,this.pb()):a};function WW(a){T.call(this);this.J=new T;F(this,this.J);this.D=new WN("");F(this,this.D);this.O=new Or("");F(this,this.O);this.Z=a;this.ma=null}x(WW,T);q=WW.prototype;
q.Ja=function(){WW.$.Ja.call(this);var a=lp(this,"nfd-icwr");this.J.tb(a);this.Ta(this.J);if(a=lp(this,"nfd-i"))this.D.tb(a),this.D.Bd(this.J),oo(this.D.getElement(),"jfk-textinput"),a=new oq,a.tb(this.D.getElement()),F(this,a),this.V=a=new nq(this.D.getElement()),F(this,a),this.ma=a=new Mp(this.D.getElement()),F(this,a),a=new hp(this.D.getElement()),this.getHandler().R(a,"focusout",Ga(this.zXa,!1)).R(a,"focusin",Ga(this.zXa,!0)).R(this.V,"input",this.y_b);a=lp(this,"nfd-a");this.O.tb(a);this.Ta(this.O)};
q.Va=function(){return this.D.Va()};q.y_b=function(){var a=this.pb(),b=this.Va();D(a.DH,2,b);this.AXa()};q.AXa=Jf;q.zXa=function(a){to(this.J.getElement(),"nfd-input-focus",a)};q.kO=function(a){this.Hf(a.clone());this.D.mb(wN(a));try{this.D.getElement().focus()}catch(b){}};q.eHa=function(){this.D.getElement().focus()};function Zwc(a,b){a=a.J.getElement();to(a,"nfd-invalid",b)};function $wc(a){var b;a=a||{};return V('<input class="jfk-textinput'+(a.Je?" "+W(a.Je):"")+'"'+(a.id?'id="'+W(a.id)+'"':"")+(a.maxLength?'maxlength="'+W(a.maxLength)+'"':"")+(a.ica&&a.AVb?'label="'+W(a.ica)+'"':"")+(a.name?'name="'+W(a.name)+'"':"")+(a.ica?'placeholder="'+W(a.ica)+'"':"")+'type="'+W(null==(b=a.type)?"text":b)+'"'+(a.pattern?'pattern="'+W(a.pattern)+'"':"")+(a.value?'value="'+W(a.value)+'"':"")+(a.dir?'dir="'+W(a.dir)+'"':"")+(a.attributes?" "+Kq(a.attributes):"")+">")};function axc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.m1)+"'>"+bxc(a)+"</div>"+cxc(a)+"</div>")}function dxc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.m1)+"'></div>"+cxc(a)+"</div>")}
function exc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.m1)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+bxc(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+W(a.aHb)+"'></div></div></div></div>"+cxc(a)+"</div>")}
function fxc(){var a;a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+gxc({label:""})+gxc({label:Gq("Negative:")})+gxc({label:Gq("Zero:")})+gxc({label:Gq("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return V(a)}function gxc(a){return V("<tr><td class='nfd-sample-label'>"+U(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function cxc(a){a=""+U(Nr({id:a.aia,style:2,Je:"nfd-apply",content:Fq("Apply")}));return V(a)}function bxc(a){return V(U($wc({id:a.BOa,ica:a.COa,AVb:!0})))};function hxc(a){WW.call(this,a);this.F=new T;this.C=new RG("")}x(hxc,WW);q=hxc.prototype;q.qa=function(){this.Aa=Dq(exc,{m1:jp(this,"nfd-icwr"),BOa:jp(this,"nfd-i"),COa:this.Z,aHb:jp(this,"nfd-ic"),aia:jp(this,"nfd-a")})};q.Ja=function(){hxc.$.Ja.call(this);var a=lp(this,"nfd-ic");this.F.tb(a);this.F.Bd(this.J);this.F.Ta(this.C,!0);this.getHandler().R(this.C,"aftershow",this.B_b).R(this.C,"action",this.HLa).R(this.V,"input",Ga(this.AWa,null))};
q.kO=function(a){hxc.$.kO.call(this,a);a.C&&this.D.mb(Hm[a.C][1]);this.AWa(a)};
q.AWa=function(a){a=a?a.C:void 0;var b=this.C;b.xg(null);if(a){var c=this.pb(),d=c.C;ixc(this,c);c=d8b(d,Hm[d][2]);c=new rN(jxc(c),sQ[d],d);ixc(this,c);c=d8b(d,d+" "+Hm[d][1]);d=new rN(jxc(c),sQ[d],d);ixc(this,d)}else this.pb().C=null;var e="[$"+this.Va()+"]",d=a?sQ[a]:null,c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new rN(jxc(c[e]),d,a);ixc(this,f)}b.Qf(0);this.HLa();mo(b.Tc().getElement(),"number-format-menu")};function ixc(a,b){var c=new VW(function(a){return Haa(a,25)},hRb(b,1E3),b);F(a,c);F(a,b);c.Uq(!0);a=a.C;for(b=0;b<a.ql();b++)if(a.Gf(b).Kn()==c.Kn())return;a.cf(c)}q.HLa=function(){for(var a=this.C,b=0;b<a.ql();b++)a.Gf(b).Cc(!1);Gs(a)};q.B_b=function(){this.C.Tf().Cc(!0)};function jxc(a){var b=new nd;D(b,2,a);b.setType(4);return b};function kxc(a){UW.call(this,a);rp(this,"Custom currencies")}x(kxc,UW);q=kxc.prototype;q.g0=n(1000.12);q.Wia=function(){return new hxc("Custom currency")};q.C9=function(){var a=this;$Tb();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=sQ[e]:Nwc(d,f8b(d.Cm()))}var f=[];ac(Hm,function(b,c){b=e8b(c);F(a,b);f.push(b)});var h=Dkc();Ub(f,function(a,b){return h(wN(a),wN(b))});return b.concat(f)};q.p4=function(){var a=new nd;a.setType(4);D(a,3,1);var b=this.input.C.Tf().Va().Cm();D(a,2,b);return a};
q.BXa=function(){return this.input.pb().C};function lxc(a){T.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(lxc,T);lxc.prototype.qa=function(){var a=Dq(fxc);this.F=Mk("nfd-sample-label",a);this.D=Koa("nfd-rendered-sample",a);this.Aa=a};function XW(a,b){WW.call(this,a);this.C=new lxc(b);this.Hf(new rN(""))}x(XW,WW);XW.prototype.qa=function(){this.Aa=Dq(axc,{BOa:jp(this,"nfd-i"),COa:this.Z,m1:jp(this,"nfd-icwr"),aia:jp(this,"nfd-a")})};XW.prototype.Ja=function(){XW.$.Ja.call(this);this.Ta(this.C,!0);mxc(this)};XW.prototype.AXa=function(){mxc(this)};XW.prototype.kO=function(a){XW.$.kO.call(this,a);mxc(this)};
function mxc(a){var b=a.pb();if(b){var c=a.C;a=b.Cm().split(";").length-1;il(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=hRb(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Cm()),k=d<=a;S(fl(e),k);il(e,f);wo(e,"color",h||"")}d=b.Wf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Cm()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Cm());c=c.D[3];S(fl(c),3<=a);il(c,d);wo(c,"color",b||"")}};function YW(a){UW.call(this,a);rp(this,"Custom number formats")}x(YW,UW);YW.prototype.g0=n(1234.56);YW.prototype.Wia=function(){return new XW("Custom number format",1234.56)};
YW.prototype.C9=function(){var a=this.F;a.push(new rN("0"));a.push(new rN("0.00"));a.push(new rN("#,##0"));a.push(new rN("#,##0.00"));a.push(new rN("#,##0_);(#,##0)"));a.push(new rN("#,##0_);[Red](#,##0)"));a.push(new rN("#,##0.00_);(#,##0.00)"));a.push(new rN("#,##0.00_);[Red](#,##0.00)"));a.push(new rN("$#,##0_);($#,##0)"));a.push(new rN("$#,##0_);[Red]($#,##0)"));a.push(new rN("$#,##0.00_);($#,##0.00)"));a.push(new rN("$#,##0.00_);[Red]($#,##0.00)"));a.push(new rN("@"));a.push(new rN("0%"));a.push(new rN("0.00%"));
a.push(new rN("0.00E+00"));a.push(new rN("##0.0E+0"));a.push(new rN("# ?/?"));a.push(new rN("# ??/??"));a.push(new rN('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new rN('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new rN('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new rN('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};YW.prototype.p4=function(){var a=new nd;a.setType(2);D(a,3,1);var b=this.input.Va();D(a,2,b);return a};function ZW(a,b){fs.call(this,b,new nxc(a))}x(ZW,fs);q=ZW.prototype;q.Hi=function(a,b,c){ZW.$.Hi.call(this,a,b,c);a.Dc()&&this.Dc()&&a.getParent()==this&&oxc(this)};q.Ja=function(){ZW.$.Ja.call(this);oxc(this)};q.Fe=function(a){ZW.$.Fe.call(this,a);oxc(this)};q.removeChild=function(a,b){a=ZW.$.removeChild.call(this,a,b);oxc(this);return a};q.lr=function(a,b){a=ZW.$.lr.call(this,a,b);oxc(this);return a};
q.nk=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Xr(this);if(c){b=39==b;this.Vf()&&(b=!b);var c=c.getElement(),c=tb(c.parentNode.childNodes,c),d;d=(d=(d=Xr(this))?ipa(d.getElement(),pxc):null)?tb(d.parentNode.childNodes,d):-1;var e;e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=qxc(this,e);b?b=qxc(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.eda(this.pk+b);b=!0}else b=!1}b=!b}return b?ZW.$.nk.call(this,a):!0};
q.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function qxc(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function oxc(a){for(var b=a.He(),c=a.Cd(),d=Ob(Lk("div",pxc,a.getElement())),e=a.getElement(),f=d.length;f<b.D&&f<c;f++)d[f]=a.oa().qa("DIV",pxc),e.appendChild(d[f]);for(var e=d.length,b=Array(e),c=[],f=0,h=!1,k=0;k<a.Cd();k++)a.Ed(k)instanceof es?(c.push(new rxc(f,k,!0)),f=k+1):a.Ed(k)instanceof as&&(0==k?h=!0:(a.Ed(k-1),c.push(new rxc(f,k-1,!1)),f=k));k=a.Cd();0<c.length&&sb(c).end!=k-1&&c.push(new rxc(f,k-1,!1));f=h;h=a.Cd();if(0==c.length&&f)b[0]=h;else{f=c.length-Math.max(0,c.length-e);f=a.Cd()-
f;f=Math.ceil(f/e);if(0==c.length)for(h=0;h<e;h++)b[h]=(h+1)*f-1;else sxc(c,f,e);e=c.length;for(f=0;f<e;f++)b[f]=c[f].end}for(e=c=0;e<a.Cd();e++){for(;e>b[c];)++c;f=a.Ed(e);h=f.getElement();h.parentNode!=d[c]&&d[c].appendChild(h);e==b[c]&&f instanceof es?S(h,!1):S(h,!0)}for(a=d.length-1;a>c;--a)d[a].parentNode.removeChild(d[a]),d[a]=null}
function sxc(a,b,c){function d(a){return a.end-a.start-(a.TFb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Jb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Jb(a,l,1))}}function rxc(a,b,c){this.start=a;this.end=b;this.TFb=c}function nxc(a){ds.call(this);this.D=a}x(nxc,ds);var pxc="docs-multi-menu-col";function txc(a){this.C=a}x(txc,E);txc.prototype.create=function(){return new ZW(this.C)};function uxc(a,b){WW.call(this,a);this.ea=new T;this.H=new $W;this.F=new T;a=(new txc(3)).create();a.Ta(new as("Date"),!0);a.Ta(new eq("Day","DAY_TOKEN"),!0);a.Ta(new eq("Month","MONTH_TOKEN"),!0);a.Ta(new eq("Year","YEAR_TOKEN"),!0);a.Ta(new as("Time"),!0);a.Ta(new eq("Hours","HOURS_TOKEN"),!0);a.Ta(new eq("Minutes","MINUTES_TOKEN"),!0);a.Ta(new eq("Seconds","SECONDS_TOKEN"),!0);a.Ta(new eq("Milliseconds","MILLIS_TOKEN"),!0);a.Ta(new eq("AM/PM","AM_PM_TOKEN"),!0);a.Ta(new as("Duration"),!0);a.Ta(new eq("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Ta(new eq("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ta(new eq("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new ghb(a);this.C=b}x(uxc,WW);q=uxc.prototype;q.qa=function(){this.Aa=Dq(dxc,{m1:jp(this,"nfd-icwr"),aia:jp(this,"nfd-a")})};
q.Ja=function(){uxc.$.Ja.call(this);mo(this.getElement(),"nfd-date-time-input");var a=lp(this,"nfd-icwr"),b=this.ea;b.tb(a);b.Bd(this);b.Ta(this.L,!0);mo(this.L.getElement(),"nfd-date-time-menu-button");mo(this.L.Tc().getElement(),"nfd-date-time-menu");jo(this.L.Aa,"Add a date or time format");b.Ta(this.H,!0);Pc||mo(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ta(a,!0);wo(a.getElement(),"display","inline");this.getHandler().R(this,"Xe",Ga(this.CXa,"left")).R(this,"af",Ga(this.DMa,"left")).R(this,
"bf",Ga(this.DMa,"right")).R(this,"cf",Ga(this.kNa,"left")).R(this,"df",Ga(this.kNa,"right")).R(this,"$e",Ga(this.CXa,"right")).R(this.L,"action",this.Fob)};q.eHa=function(){this.ea.getElement().focus()};
q.kO=function(a){this.Hf(a.clone());var b=this.F;b.Rd(!0);il(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Cm());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?il(this.H.getElement(),d[2]):(e=b.Ed(b.Cd()-1),d=d[2],il(e.mA.getElement(),ml(e.mA.getElement())+d)):vxc(this,e).mb(d[1])}0<b.Cd()&&b.Ed(b.Cd()-1).qy.getElement().focus()};
q.Va=function(){for(var a=this.H.toString(),b=0;b<this.F.Cd();b++)a+=this.F.Ed(b).toString();for(var a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a),b="",c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=db(e,"["),e=db(e,"]")):c=!0}b+=e}return b};q.Fob=function(a){a=a.target.Va();vxc(this,a).qy.getElement().focus()};
function vxc(a,b){Zwc(a,!1);var c;switch(b){case "DAY_TOKEN":c=wxc(a);break;case "MONTH_TOKEN":c=xxc(a);break;case "YEAR_TOKEN":c=yxc(a);break;case "HOURS_TOKEN":c=zxc();break;case "MINUTES_TOKEN":c=Axc();break;case "SECONDS_TOKEN":c=Bxc();break;case "MILLIS_TOKEN":c=Cxc();break;case "AM_PM_TOKEN":c=Dxc(a);break;case "ELAPSED_HOURS_TOKEN":c=Exc();break;case "ELAPSED_MINUTES_TOKEN":c=Fxc();break;case "ELAPSED_SECONDS_TOKEN":c=Gxc()}b=c;b.Ta(new es,!0);b.Ta(new eq("Delete"),!0);c=new Hxc(c,"");a.F.Ta(c,
!0);return c}q.CXa=function(a,b){b=b.target;if(b instanceof $W){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Ed(mp(this.F,b)+1),!b))return}a=ml(b.mA.getElement());var c=b.getParent(),d=mp(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=ml(b),il(b,c+a),Ixc(this.H,c.length)):(d--,b=c.Ed(d),c=ml(b.mA.getElement()),il(b.mA.getElement(),ml(b.mA.getElement())+a),Ixc(b.mA,c.length))};
q.kNa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Ed(mp(this.F,b)+a))&&a.qy.getElement().focus()};q.DMa=function(a,b){var c="left"==a?-1:0;(b=this.F.Ed(mp(this.F,b.target)+c))||"left"!=a?b&&(b=b.mA):b=this.H;c=ml(b.getElement()).length;Ixc(b,"left"==a?c:0)};function Hxc(a,b){T.call(this);this.qy=new RG("",a);this.Ta(this.qy,!0);this.mA=new $W(b);this.Ta(this.mA,!0)}x(Hxc,T);q=Hxc.prototype;
q.Ja=function(){Hxc.$.Ja.call(this);wo(this.getElement(),"display","inline-block");this.qy.Qf(0);this.C=new Mp(this.qy.getElement());F(this,this.C);this.getHandler().R(this.qy,"action",this.C_b).R(this.C,"key",this.D_b)};q.C_b=function(){Gs(this.qy);this.qy.Tf().pb()||this.dispatchEvent("$e")};q.D_b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("$e"));break;case 37:a.preventDefault();this.dispatchEvent("af");break;case 39:a.preventDefault(),this.dispatchEvent("bf")}};
q.toString=function(){return this.qy.Tf().pb()+this.mA.toString()};q.mb=function(a){this.qy.mb(a)};function $W(a){T.call(this);this.C=a||""}x($W,T);q=$W.prototype;q.qa=function(){var a=Rk("SPAN");Nk(a,{contentEditable:!0});il(a,this.C);var b=a.style;Mc&&!Vc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Pc?"-moz-pre-wrap":"pre-wrap";this.Aa=a};
q.Ja=function(){$W.$.Ja.call(this);var a=new Mp(this.getElement());F(this,a);this.getHandler().R(a,"key",this.E_b).R(this.getElement(),"paste",this.F_b)};function Ixc(a,b){if(0==ml(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=Lv(c,b);a.getElement().focus();b.select()}}
q.E_b=function(a){var b=ll(this.getElement()),c=Cv(),d=ml(this.getElement()).length,e=c?0==c.wi()&&0==c.qo():Ua(ib(b)),b=c?c.wi()==d&&c.qo()==d:Ua(ib(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Xe"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("$e"));break;case 40:this.dispatchEvent("Ye");break;case 38:this.dispatchEvent("Ze");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("cf"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("df"));break;
case 13:a.preventDefault()}};q.toString=function(){var a=qaa(ml(this.getElement())).replace(/"/g,'"\\""');return 0==ib(a).length?"":'"'+a+'"'};q.F_b=function(){var a=v(function(){il(this.getElement(),ml(this.getElement()))},this);ek(a)};
function wxc(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new VW(Ga(b,e),a,d));d=new fs;for(e=0;e<c.length;e++)d.Ta(c[e],!0);return d}
function xxc(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new VW(Ga(b,e),a,d));d=new fs;for(e=0;e<c.length;e++)d.Ta(c[e],!0);return d}
function yxc(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new VW(Ga(b,e),a,d));d=new fs;for(e=0;e<c.length;e++)d.Ta(c[e],!0);return d}
function zxc(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Axc(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Bxc(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Cxc(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Dxc(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new VW(Ga(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new VW(Ga(b,e),a,d));d=new fs;for(e=0;e<c.length;e++)d.Ta(c[e],!0);return d}
function Exc(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Fxc(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c}
function Gxc(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new VW(Ga(a,d),e,c));c=new fs;for(d=0;d<b.length;d++)c.Ta(b[d],!0);return c};function Jxc(a){UW.call(this,a);rp(this,"Custom date and time formats")}x(Jxc,UW);q=Jxc.prototype;q.LUa=Hf;q.g0=n(11175.5628472222);q.isEmpty=function(){return Ua(Ec(this.p4(),2))};q.Wf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Ec(this.p4(),2))};q.Wia=function(){return new uxc("Custom date time format",11175.5628472222)};q.p4=function(){return Kxc(this.input.Va())};
q.C9=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.g0(),c.Cm());c.D=d}b=Lxc(this);Rb(b);for(c=0;c<b.length;c++)a.push(new rN(Kxc(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.g0(),b[c])));return a};
function Lxc(a){var b=Wt,c=wb(b.DATEFORMATS,function(a){return Mxc(a)},a),d=wb(b.TIMEFORMATS,function(a){return Mxc(a)},a),e=c.concat(d),b=b.DATETIMEFORMATS;Rb(b);a=wb(b,function(a){return Mxc(a)},a);for(b=0;b<a.length;b++){var f=a[b],f=f.replace(/\{1\}/,c[0]),f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function Mxc(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Wa(a.join(""))}function Kxc(a){var b=new nd;b.setType(7);D(b,3,1);D(b,2,a);return b};function Nxc(a,b){this.C=a;this.D=b};function Oxc(){};function Pxc(a){for(var b="",c=a.TTa,d=c.length,e=0;e<d;e++){var f=c[e],h=a.KRb[f.Mi()];f.getName();var k=f.Mh(),f=f.KGb,f=V('<div id="'+W(h)+'" tabindex="0" role="link" class="ess-button" aria-label="'+W(k)+'"><div class="ess-icon '+W(f)+'"></div></div>'),b=b+f}return V(b)};function Qxc(a,b){T.call(this,b);this.C=a||[];this.F=[];this.D=null}x(Qxc,T);q=Qxc.prototype;q.Hha=!0;q.dha=!1;q.xR=null;q.yFa=!1;q.cb=function(a,b){this.Hha=a;this.dha=b;if(this.yFa){b=this.oa();for(var c=0,d;d=this.C[c];c++){var e=b.getElement(this.xR.Rsa+"-"+d.Mi()),f=a;to(e,"ess-button",f);to(e,"ess-disabled-button",!f);f=d.getName();d=d.Mh();Mr(e,f,d)}}};
q.qa=function(){this.Aa=this.xb.createElement("SPAN");var a={};a.Rsa=jp(this,"service");a.TTa=this.C;this.xR=a;for(var b={},c=0,d;d=this.C[c];c++)b[d.Mi()]=this.xR.Rsa+"-"+d.Mi();a.KRb=b;this.xR=a;sq(this.getElement(),Pxc,this.xR);this.yFa=!0};
q.HPb=function(a){if(this.Hha)if(this.D&&this.D.xY(9),this.dha)this.dispatchEvent(new Rxc(new Sxc));else{var b=this.D||void 0;a=a.C(this.F);b&&b.xY(10);b={gAc:!0};b.target=b.target||a.target||"google_popup";b.width=b.width||690;b.height=b.height||500;(b=Vn(a,b))&&b.focus()}};q.Ja=function(){this.cb(this.Hha,this.dha);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.C[c];c++){var e=a.getElement(this.xR.Rsa+"-"+d.Mi());b.Ei(e,gd,v(this.HPb,this,d))}};
q.xa=function(){Qxc.$.xa.call(this);delete this.F;delete this.C;this.D=null};function Rxc(a,b){I.call(this,"ef",b);this.context=a}x(Rxc,I);function Sxc(){}x(Sxc,Oxc);function aX(a,b,c,d){this.F=b;this.D=c;this.KGb=d;this.H=Txc++}var Txc=0;aX.prototype.Mi=g("H");aX.prototype.getName=g("F");aX.prototype.Mh=g("D");function Uxc(){aX.call(this,0,"Facebook","Share via Facebook","ess-facebook-icon")}x(Uxc,aX);Uxc.prototype.C=function(a){var b=wb(a,function(a){return a.D});a=wb(a,function(a){return a.C});return"http://www.facebook.com/share.php?u="+Xa(a.join(","))+"&t="+Xa(b.join(","))};function Vxc(){aX.call(this,0,"Gmail","Share via Gmail","ess-gmail-icon")}x(Vxc,aX);Vxc.prototype.C=function(a){a=wb(a,function(a){return a.D+" - "+a.C});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Xa(a.join("\n"))};function Wxc(){aX.call(this,0,"Google+","Share via Google+","ess-gplus-icon")}x(Wxc,aX);Wxc.prototype.C=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Xa(a[0].C)};function Xxc(){aX.call(this,0,"Twitter","Share via Twitter","ess-twitter-icon")}x(Xxc,aX);Xxc.prototype.C=function(a){for(var b=Da(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].C,h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){var f=a[e].D,h=c[e]?" - ":"",k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Xa(a)};function bX(a){T.call(this,a)}x(bX,T);function Yxc(a){a.dispatchEvent(new I("ff"))}bX.prototype.j0=function(){return{}};bX.prototype.RL=Jf;bX.prototype.Lsa=sa;function cX(a){T.call(this,a)}x(cX,T);cX.prototype.F=Jf;cX.prototype.H=sa;cX.prototype.J=sa;function Zxc(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+Uwc(a.locale)+'&answer=183965">Learn more</a>'),b=b+('<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
W(a.V$a)+'" readonly="readonly" aria-label="'+Jq("Link to published document.")+" "+W(a.nSa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
Jq("HTML embed code of published document.")+" "+W(a.nSa)+'">'+Tza(a.Geb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+U(Nr({id:"pub-dialog-publish-link-button",style:2,value:a.GPb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+U(it({IB:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
U(Nr({id:"pub-dialog-publish-button",value:a.EPb}))+'<div class="pub-dialog-checkbox-container">');a.mHb&&(c="Require viewers to sign in with their "+(U(a.domain)+" account"),b+=U(Pq({id:"pub-dialog-dom-signin-req",checked:a.Mt,disabled:a.bL}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.bL?'class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.QR&&(b+=U(Pq({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return V(b+"</div></div></div></div>")};function dX(a,b,c,d,e,f,h,k,l,m){Rq.call(this);this.Hb=a||"";this.Jg=b;this.Od=c;this.Hd=d;this.od=l||"/publishsettings";this.C=new $xc(e);this.Pb=new Qxc([new Wxc,new Vxc,new Uxc,new Xxc]);this.Ta(this.Pb);this.ma=new Or(null,this.oa());this.Ta(this.ma);this.V=new Or(null,this.oa());this.Ta(this.V);this.jb=new Qq(void 0,this.oa());this.Ta(this.jb);this.va=new Qq(void 0,this.oa());this.Ta(this.va);this.qb=0;this.zc=new ayc;this.Ta(this.zc);this.Lb=this.Yb=null;this.J=f||new bX;this.Ta(this.J);this.F=
h||new bX;this.Ta(this.F);this.Wa=k||new cX;this.Ta(this.Wa);this.O=this.L=null;this.Db=new bt(void 0,byc,this.oa(),2);F(this,this.Db);this.Ag=this.we=null;this.Og=m||new T;this.Pc=this.Ab=this.jc=null;this.Kj=!0}x(dX,Rq);var byc="Press "+((Sc?"\u2318+C":"Ctrl+C")+" to copy.");q=dX.prototype;q.show=function(){cyc(this,v(function(){this.setVisible(!0)},this))};
q.setVisible=function(a){dX.$.setVisible.call(this,a);var b=tl(this.oa());a?this.getHandler().R(b,"resize",this.Id):this.getHandler().Sc(b,"resize",this.Id)};
q.qa=function(){dX.$.qa.call(this);var a=this.oa(),b=vq(Zxc,{mHb:!!this.C.domain,QR:this.C.QR(),Mt:this.C.Mt,domain:this.C.C,bL:this.C.bL,EPb:dyc(this),GPb:eX(this,eyc(this))?"Published":"Publish",V$a:this.C.Wk?fyc(this,this.J.j0()):"",Geb:this.C.Wk?gyc(this,this.F.j0()):"",locale:"en",nSa:byc});a.appendChild(this.mc(),b);rp(this,"Publish to the web");Fp(this,null);mo(this.mc(),"pub-dialog-content")};
q.Ja=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.Pb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.jc=a.getElement("pub-dialog-links-notice");this.Og.render(this.jc);b=a.getElement("pub-dialog-published-content");this.Wa.render(b);dX.$.Ja.call(this);var b=this.getHandler(),c=a.getElement("pub-dialog-dom-signin-req");c&&(this.jb.tb(c),yq(this.jb,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.jb,"change",this.JUb));this.C.QR()&&(this.va.tb(a.getElement("pub-dialog-auto-publish-checkbox")),yq(this.va,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.va,"change",this.FUb));this.Yb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Lb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");$s(this.Db,this.L);this.zc.tb(a.getElement("pub-dialog-links-tab-bar"));this.we=a.getElement("pub-dialog-sharing-services");
this.Ag=a.getElement("pub-dialog-status-info");this.ma.tb(a.getElement("pub-dialog-publish-link-button"));this.V.tb(a.getElement("pub-dialog-publish-button"));this.Pc=new vI("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Wk);F(this,this.Pc);b.R(this.zc,"select",this.rBb).R(this.L,"focus",this.ETa).R(this.O,"focus",this.ETa).R(this.V,"action",this.IPb).R(this.getElement(),"keyup",this.j$a).R(this.J,"ff",this.Oua).R(this.F,"ff",this.Oua).R(this.ma,"action",this.nzb).R(this.Wa,"gf",
this.ozb).R(this.Pc,"toggle",this.Id);hyc(this)};function hyc(a){if(a.Dc()){var b=a.oa(),c=a.C.Wk,d=a.C.bL;a.Wa.H(a.C.hn);a.jb.cb(!d);a.V.setContent(dyc(a));a.V.cb(a.C.Wk||!a.C.hn||!a.C.hn.isEmpty());a.C.QR()&&a.va.Cc(a.C.Ww);a.Oua();b=b.ij("pub-dialog-state-publishing");z(b,function(a){S(a,c)});il(a.Ag,c?"This document is published to the web.":"This document is not published to the web.");a.Id()}}q.j$a=function(a){this.sb()&&27==a.keyCode&&a.stopPropagation()};
function iyc(a,b){var c=window.location.href,d=Dj(c),c=Hj(c),e=ab(c,"/"+a.Hd+"/")?"/"+a.Hd:"";a.C.Mt&&a.C.domain&&(e="/a/"+a.C.domain+e);var c=d[1],f=d[2],h=d[3],d=d[4];a=a.C.F||a.Hb;b=qna.test(b)?b:Rj("/d/"+a,b);return Cj(c,f,h,d,Rj(e,b))}
q.Oua=function(){var a=this.J.RL();if(a=eX(this,a)){var b=this.C.Wk?fyc(this,this.J.j0()):"";this.L.value=b;this.Pb.F=[new Nxc(b,this.Jg)]}S(this.L,a);S(this.we,a&&!this.C.bL);a=this.F.RL();if(a=eX(this,a))this.O.value=this.C.Wk?gyc(this,this.F.j0()):"";S(this.O,a);a=eX(this,eyc(this));S(this.jc,a);this.ma.cb(!a);this.ma.setContent(eX(this,eyc(this))?"Published":"Publish")};
q.rBb=function(a){a=a.target;this.oa();at(this.Db);"pub-dialog-link-tab"==a.getId()?(this.qb=0,S(this.Yb,!0),S(this.Lb,!1),$s(this.Db,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.qb=1,S(this.Yb,!1),S(this.Lb,!0),$s(this.Db,this.O));hyc(this)};q.ETa=function(a){ek(function(){a.target.select()},0)};q.JUb=function(){this.C.Wk?jyc(this,2):this.C.Mt=!this.C.Mt};q.FUb=function(){this.C.Wk?jyc(this,0):this.C.Ww=!this.C.Ww};function dyc(a){return a.C.Wk?"Stop publishing":"Start publishing"}
function cyc(a,b){Si(a.Od.Zf(a.od).zg("id",a.Hb),v(function(a){this.C.Wk=!!Xj(a,"published");this.C.Mt=!!Xj(a,"requireSignin");this.C.bL=!!Xj(a,"domainClosed");this.C.domain=Pwc(a,"domain");this.C.C=Pwc(a,"domainDisplay");var c=this.C,e;e=Number(Xj(a,"revision"));c.Ww=!e;this.C.hn=this.GIa(a.qg());this.C.F=Pwc(a,"publishedDocumentId");b()},a)).rf()}q.GIa=Jf;q.oIa=Jf;function kyc(a){return{Ww:a.C.Ww,Wk:a.C.Wk,Mt:a.C.Mt,hn:a.C.hn}}
function jyc(a,b){var c=kyc(a);switch(b){case 0:c.Ww=!c.Ww;break;case 1:c.Wk=!c.Wk;break;case 2:c.Mt=!c.Mt;break;default:throw Error("Unknown toggle op: "+b);}c.Wk||(c.hn=a.oIa());lyc(a,c,!0)}
function lyc(a,b,c){myc(a,!1);Ri(Si(Pi(Ti(a.Od.Zf(a.od).zg("id",a.Hb),nyc(a,b)),2),v(function(){this.C.Ww=b.Ww;this.C.Wk=b.Wk;this.C.Mt=b.Mt;this.C.hn=b.hn;this.C.Wk&&this.C.hn&&(eX(this,this.J.RL())||this.J.Lsa(this.C.hn),eX(this,this.F.RL())||this.F.Lsa(this.C.hn));myc(this,!0);hyc(this);if(c&&this.C.Wk)switch(this.qb){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.qb);}},a)),v(function(){Rfc("An error occurred while saving publishing settings.",
void 0,this.Dc()?this:void 0);myc(this,!0);hyc(this)},a)).rf()}function nyc(a,b){var c={id:a.Hb,requireSignin:b.Mt,published:b.Wk};a.C.QR()&&!b.Ww&&(c.revision=a.C.D);b.hn&&(a=oyc(b.hn),uc(c,a));return c}function myc(a,b){for(var c=[a.va,a.V,a.ma,a.jb],d=0;d<c.length;d++){var e=c[d];!b&&e.mq()&&(a.Ab=e);e.cb(b)}b&&a.Ab&&(a.sb()&&a.Ab.sb()&&(c=a.Ab.getElement())&&c.focus(),a.Ab=null);a.Wa.J(b)}
q.IPb=function(a,b){if(b||window.confirm(this.C.Wk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.V.setContent("Saving..."),jyc(this,1)};function eyc(a){switch(a.qb){case 0:return a.J.RL();case 1:return a.F.RL();default:throw Error("Cannot handle selected link type "+a.qb);}}
q.nzb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=eyc(this),b=kyc(this);b.Wk=!0;a&&(b.hn&&this.C.Wk?b.hn=pyc(b.hn,a):b.hn=a);this.ma.setContent("Publishing...");lyc(this,b,!0)}};q.ozb=function(){var a=this.Wa.F();if(this.C.Wk)if(a&&a.isEmpty())jyc(this,1);else{var b=kyc(this);b.hn=a;lyc(this,b)}else this.C.hn=a,hyc(this)};function eX(a,b){var c;(c=a.C.Wk)&&!(c=!b||!a.C.hn)&&(a=a.C.hn,c=a.F||!b.F&&Ab(b.D.Dd(),a.Xaa,a)&&Ab(b.C,a.Kaa,a));return c}
function $xc(a){this.D=a;this.bL=this.Mt=this.Wk=!1;this.Ww=!0;this.F=this.C=this.domain=""}$xc.prototype.QR=function(){return!!this.D};function ayc(){oT.call(this)}x(ayc,oT);ayc.prototype.nk=function(a){return a.keyCode&&27==a.keyCode?!1:ayc.$.nk.call(this,a)};function qyc(a,b,c,d){this.F=a;this.Pi=b;this.C=c;this.D=d}function ryc(a,b){return new qyc(!1,null,new syc(a,b||"interactive"),null)}function syc(a,b){this.id=a;this.format=b};function fX(a,b,c){this.F=a;this.D=new fg(b);this.C=c}q=fX.prototype;q.Xaa=function(a){return this.F||this.D.contains(a)};function tyc(a,b){return yb(a.C,function(a){return a.id==b.id})}q.Kaa=function(a){return this.F||this.D.contains(a.Pi)||tyc(this,a)};function uyc(a,b){a.C=vb(a.C,function(a){return a.Pi!=b})}function vyc(a,b){tyc(a,b)&&(a.C=vb(a.C,function(a){return a.id!=b.id}))}
function pyc(a,b){var c=a.F||b.F;if(c)return new fX(c,[],[]);var d=a.clone();z(b.D.Dd(),function(a){d.D.contains(a)||(d.D.add(a),uyc(d,a))});z(b.C,function(a){d.Kaa(a)||d.C.push(a)});return d}function oyc(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Dd().join(","),charts:wb(a.C,function(a){return a.id}).join(",")}}q.isEmpty=function(){return!this.F&&this.D.isEmpty()&&Eb(this.C)};q.clone=function(){return new fX(this.F,this.D.Dd(),Ob(this.C))};
q.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&Wb(this.C,a.C,function(a,c){return a.id==c.id&&a.Pi==c.Pi})};function wyc(a,b){this.id=a;this.Pi=b};function xyc(a,b,c,d){T.call(this,void 0);this.C=c||new qyc(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new RG("",yyc(a,b));yN(this.D,!0);this.Ta(this.D,!0);a=new fs;a.Ta(new eq("Interactive","interactive"),!0);a.Ta(new eq("Image","image"),!0);this.H=new RG("",a);this.Ta(this.H,!0);a=new fs;a.Ta(new eq("Web page","html"),!0);a.Ta(new eq("Comma-separated values (.csv)","csv"),!0);a.Ta(new eq("Tab-separated values (.tsv)","tsv"),!0);a.Ta(new eq("PDF document (.pdf)","pdf"),!0);a.Ta(new eq("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ta(new eq("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new RG("",a);this.Ta(this.F,!0);zyc(this)}x(xyc,bX);var Ayc=["xlsx","ods"],Byc=["csv","tsv"];
function yyc(a,b){var c=new fs;c.Ta(new eq("Entire Document",new Cyc("entireDocument",null)),!0);c.Ta(new es,!0);var d=yZa(b);z(a.D,function(a){c.Ta(new eq(a.C,new Cyc("sheet",a.Ib())),!0);if(a=d[a.Ib()])for(var b=0;b<a.length;b++){var e=a[b];6==e.getType()&&e.isSaved()&&(e=new eq(Owc(e),new Cyc("chart",UA(e))),c.Ta(e,!0),mo(e.mc(),"pub-dialog-link-options-chart-menu-item"))}});return c}q=xyc.prototype;
q.Ja=function(){xyc.$.Ja.call(this);mo(this.getElement(),"pub-dialog-link-options-container");mo(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");mo(this.D.mc(),"pub-dialog-link-options-document-part-menu-button-content");mo(this.D.Tc().getElement(),"pub-dialog-link-options-document-part-menu");jo(this.D.Aa,"Sheet or chart selection");jo(this.H.Aa,"Chart format");jo(this.F.Aa,"Sheet format");this.getHandler().R(this.D,"change",this.Gpb).R(this.H,"change",this.Dmb).R(this.F,
"change",this.YBb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};q.Gpb=function(){var a=this.D.Tf().pb();switch(a.type){case "entireDocument":this.C=new qyc(!0,null,null,this.C.D||"html");break;case "sheet":var a=a.id,b=this.C.D;b&&!Dyc(this,a,b)&&(b=null);this.C=new qyc(!1,a,null,b||"html");break;case "chart":this.C=ryc(a.id,this.C.C?this.C.C.format:null)}zyc(this);Yxc(this)};
q.Dmb=function(){var a=this.H.Tf().pb();this.C.C&&(this.C.C.format=a,Yxc(this))};q.YBb=function(){var a=this.F.Tf().pb();this.C.D=a;Yxc(this)};
function zyc(a){var b=Ob(a.D.dk.C),b=Bb(b,function(a){a=a.pb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Pi&&a.id==this.C.Pi;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);Hs(a.D,b);b=!!a.C.C;S(a.H.getElement(),b);null!=a.C.C&&a.H.mb(a.C.C.format);S(a.F.getElement(),a.J&&oqa&&!b);b||(Eyc(a),a.F.mb(a.C.D))}
function Eyc(a){for(var b=a.F.Tc(),c=0;c<b.ql();c++){var d=b.Gf(c),e=d.Va();d.cb(null==a.C.Pi||Dyc(a,a.C.Pi,e))}}function Dyc(a,b,c){if(Db(Ayc,c))return!1;a=xu(a.O,b);return null!=a&&1==a.getSheetType()&&Db(Byc,c)?!1:!0}q.j0=g("C");q.RL=function(){if(this.C.F)return new fX(!0,[],[]);if(null!=this.C.Pi)return new fX(!1,[this.C.Pi],[]);var a=this.L.getEmbeddedObject(this.C.C.id),a=new wyc(this.C.C.id,a.Ib());return new fX(!1,[],[a])};
q.Lsa=function(a){if(!a.F){var b=a.D.Dd();0<b.length?this.C=new qyc(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=ryc(a[0].id)));zyc(this)}};function Cyc(a,b){this.type=a;this.id=b};function gX(a,b){js.call(this,void 0,void 0,new QG,void 0);this.Wa=a;this.Ua=b;this.H=new fX(!0,[],[]);this.V=!1;this.J=new tI("Entire Document");this.cf(this.J);this.cf(new es);Fyc(this);yN(this,!0);Gyc(this)}x(gX,js);function Fyc(a){var b=yZa(a.Ua);z(a.Wa.D,function(c){var d=new tI(c.C,c);a.cf(d);(c=b[c.Ib()])&&z(c,function(b){6==b.getType()&&b.isSaved()&&(b=new tI(Owc(b),b),a.cf(b),mo(b.mc(),"pub-dialog-published-content-chart-menu-item"))})})}
gX.prototype.Ja=function(){gX.$.Ja.call(this);mo(this.getElement(),"pub-dialog-published-content-menu-button");mo(this.mc(),"pub-dialog-published-content-menu-button-content");mo(this.Tc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
gX.prototype.At=function(a){if(a.target==this.J){a=this.J.isChecked();var b=this.H;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.pb(),b instanceof ku?(b=b.Ib(),a?(a=this.H,a.D.contains(b)||(a.D.add(b),uyc(a,b))):(a=this.H,a.D.contains(b)&&(a.D.remove(b),uyc(a,b)))):(b=new wyc(UA(b),b.Ib()),a?(a=this.H,a.Kaa(b)||a.C.push(b)):vyc(this.H,b));this.V=!0;Gyc(this)};gX.prototype.Le=function(a,b){gX.$.Le.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new I("gf")))};
function Gyc(a){var b=a.H.F;a.J.Cc(b);z(ofc(a.Tc()),function(c){var d=c.pb();d&&(d instanceof ku?(c.Cc(a.H.Xaa(d.Ib())),c.cb(!b)):(d=new wyc(UA(d),d.Ib()),c.Cc(a.H.Kaa(d)),c.cb(!a.H.Xaa(d.Pi))))});Hyc(a)}
function Hyc(a){var b;if(a.H.F)b="Entire Document";else{b=vb(a.Wa.D,v(function(a){return this.H.Xaa(a.Ib())},a));b=wb(b,function(a){return a.C});for(var c=[],d=a.H.C,e=0;e<d.length;e++){var f=a.Ua.getEmbeddedObject(d[e].id);f&&c.push(Owc(f))}b=Nb(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function hX(a,b){T.call(this,void 0);this.C=new gX(a,b);this.Ta(this.C,!0);this.D=!1}x(hX,cX);hX.prototype.Ja=function(){hX.$.Ja.call(this);mo(this.getElement(),"pub-dialog-published-content-container")};hX.prototype.F=function(){return this.C.H};hX.prototype.H=function(a){var b=this.C;b.H=a.clone();Gyc(b)};hX.prototype.J=function(a){!a&&this.C.mq()&&(this.D=!0);this.C.cb(a);a&&this.D&&(this.Dc()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function Iyc(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+Uwc(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return V(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function Jyc(a,b,c,d,e,f,h){var k=null!=h?ryc(h):null;h=new xyc(c,d,k,!0);k=new xyc(c,d,k,!1);dX.call(this,a,b,e,Lpa,f,h,k,new hX(c,d),"/publishingsettings",new Kyc);this.ai=c;this.Vc=d}x(Jyc,dX);
Jyc.prototype.GIa=function(a){if(a.entireDocument)return new fX(!0,[],[]);var b=a.charts||"";a=wb((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=vb(a,function(a){return null!=xu(this.ai,a)},this);b=wb(b.split(","),function(a){return parseInt(a,10)});b=vb(b,v(function(a){return!!this.Vc.getEmbeddedObject(a)},this));b=wb(b,function(a){var b=this.Vc.getEmbeddedObject(a);return new wyc(a,b.Ib())},this);return new fX(!1,a,b)};Jyc.prototype.oIa=function(){return new fX(!0,[],[])};
function fyc(a,b){if(b.F||null!=b.Pi){var c="html"==b.D;a=iyc(a,c?"/pubhtml":"/pub");null!=b.Pi&&(a=Lj(a,"gid",b.Pi,"single","true"));c||(a=Lj(a,"output",b.D))}else a=Lj(iyc(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function gyc(a,b){var c=fyc(a,b);if(b.F||null!=b.Pi)c=Lj(c,"widget","true","headers","false");a=b.C?(a=a.Vc.getEmbeddedObject(b.C.id))?a.Yc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Za(c)+'"></iframe>'}function Kyc(){}x(Kyc,T);Kyc.prototype.qa=function(){this.Aa=vq(Iyc,{locale:"en"})};function Lyc(a,b,c){return kza(a||"There was a problem",Cg(b),void 0,void 0,void 0,void 0,c)};function Myc(a){return V("<div><div>"+U(a.N6a)+"</div>"+U(Pq({id:"waffle-confirm-suppress-checkbox",Je:"waffle-confirm-suppress-checkbox"}))+'<span id="waffle-confirm-suppress-label">'+U(a.kua)+"</span></div>")};function Nyc(a,b,c,d,e,f,h){var k;Aa(c)?(k=new yp,k.set("ok",c.ok,!0),k.set("cancel",c.cancel,!1,!0)):k=yya;return Oyc(d||"Heads up!",a,b,k,e,f,h)}function Oyc(a,b,c,d,e,f,h){var k;b=Cg(b);if(f){b=rq(Myc({N6a:b,kua:f}));k=new Qq;var l=c;c=function(){l(k.isChecked())}}a=lza(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ta(k),k.tb(ql(a.oa(),"waffle-confirm-suppress-checkbox")),c=ql(a.oa(),"waffle-confirm-suppress-label"),yq(k,c),k.Cc(!1));return a};function iX(a,b){Ax.call(this,36,null);this.D=a;this.Vd=b}x(iX,Ax);iX.prototype.exec=Jf;iX.prototype.Ve=n(38);iX.prototype.Oe=function(){var a=new pw;D(a,2,this.D);D(a,1,this.Vd);return a};iX.prototype.Tg=function(){return B(this.D,1)?"Data validation applied.":"Data validation cleared."};function jX(){var a=new RG(null);yN(a,!0);return a};function Pyc(a,b,c){J.call(this);this.D=a;this.lh=b;this.Hb=c;this.V=this.J=this.Ea=this.va=this.Z=this.H=null;this.jc=new WN;this.od=new WN;this.ma=this.O=null;this.Vc=new WN;this.we=new WN;this.ea=this.L=null;this.zc=new WN;this.Hd=new WN;this.Wa=this.Pb=null;this.C=new wU("");this.jb=this.F=this.Lb=this.Db=this.qb=null;this.If=this.Yb=!1;this.Pc=this.Od=this.Ab=this.Ua=null;this.Xa=new K(this);F(this,this.Xa);this.Ke=new qh;this.bf=this.Og=this.Ag=this.Ge=this.Jg=this.Ga=null;this.Wx();a=this.Xa;
a.R(this.H,"action",this.Mtb);a.R(this.Z,"action",this.foa);a.R(this.va,"action",this.foa);a.R(this.Ea,"action",this.foa);a.R(this.F,"focus",Ga(this.gUa,!0));a.R(this.F,"blur",Ga(this.gUa,!1));a.R(this.F,"change",this.Tna);a.R(this.F,"keyup",this.Tna);b=[this.O,this.ma,this.J,this.V,this.L,this.ea];for(c=0;c<b.length;c++)this.Xa.R(b[c],"change",v(this.KWb,this,b[c])),this.Xa.R(b[c],"keyup",v(this.LWb,this,b[c]));a.R(this.Ab,"change",v(this.gNa,this));a.Ei(this.jb,gd,this.vAb)}x(Pyc,J);
var Qyc="placeholder"in document.createElement("input"),Ryc=/\s*,\s*/;function Syc(a){var b=a.bf;b||(b=[{qj:"List from a range",type:4},{qj:"List of items",type:3},{qj:"Number",type:0},{qj:"Text",type:1},{qj:"Date",type:2},{qj:"Custom formula is",type:5}],jqa&&b.push({qj:"Checkbox",type:6}),a.bf=b);return b}
function Tyc(a){var b=a.Og;b||(b=[{qj:"contains",code:9,inputs:0,example:"Approved"},{qj:"does not contain",code:10,inputs:0,example:"Approved"},{qj:"equals",code:13,inputs:0,example:"Approved"},{qj:"is valid email",code:14,inputs:-1,example:null},{qj:"is valid url",code:15,inputs:-1,example:null}],a.Og=b);return b}
function Uyc(a){var b=a.Ge;b||(b=[{qj:"is valid date",code:30,inputs:-1,example:null},{qj:"equal to",code:16,inputs:2,example:"11/15/2014"},{qj:"before",code:17,inputs:2,example:"11/15/2014"},{qj:"on or before",code:19,inputs:2,example:"11/15/2014"},{qj:"after",code:18,inputs:2,example:"11/15/2014"},{qj:"on or after",code:20,inputs:2,example:"11/15/2014"},{qj:"between",code:21,inputs:3,example:"11/15/2014",RR:"11/15/2015"},{qj:"not between",code:22,inputs:3,example:"11/15/2014",RR:"11/15/2015"}],
a.Ge=b);return b}function Vyc(a){var b=a.Ag;b||(b=[{qj:"range",code:23,inputs:6,example:null},{qj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Ag=b);return b}
function Wyc(a){var b=a.Jg;b||(b=[{qj:"between",code:7,inputs:8,example:"10",RR:"100"},{qj:"not between",code:8,inputs:8,example:"10",RR:"100"},{qj:"less than",code:3,inputs:7,example:"10"},{qj:"less than or equal to",code:4,inputs:7,example:"10"},{qj:"greater than",code:1,inputs:7,example:"10"},{qj:"greater than or equal to",code:2,inputs:7,example:"10"},{qj:"equal to",code:5,inputs:7,example:"10"},{qj:"not equal to",code:6,inputs:7,example:"10"}],a.Jg=b);return b}
function Xyc(){return{qj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function Yyc(){return{qj:"",code:31,inputs:-1,example:""}}q=Pyc.prototype;
q.Wx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,p,r,u,w,y,C,G,N,R,Z,ha,ka,ga=a.oa(),pa,ya;pa=ga.qa("TR","waffle-dv-trrules",ga.qa("TD","waffle-dv-label",ga.qa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),ga.qa("TD",{Kyc:"7"},p=ga.qa("DIV","goog-inline-block"),ya=ga.qa("DIV","goog-inline-block"),l=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),e=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),h=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=ga.qa("SPAN","waffle-dv-separator","and"),m=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),f=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),k=ga.qa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.zc.tb(l);this.Hd.tb(m);this.Vc.tb(e);this.we.tb(f);this.jc.tb(h);this.od.tb(k);c=jX();ip(c,p);C=jX();ip(C,p);y=jX();ip(y,p);w=jX();ip(w,p);r=Zyc(a,ya);(u=c.getElement())&&go(u,"labelledby","waffle-dv-criteria");var Ka;
Z=ga.qa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",ga.qa("TD"),ga.qa("TD",{colspan:"7"},Ka=ga.qa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));N=new Qq;yq(N,Ka);ip(N,Ka);d=ga.qa("TR","waffle-dv-trrules",ga.qa("TD","waffle-dv-label",ga.qa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),ga.qa("TD",{colspan:"7"},ga.qa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},ga.qa("INPUT",{type:"radio",
id:"showWarningOnInvalidData_radio",name:"onInvalidData",role:"radio"}),ga.qa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),ga.qa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),ga.qa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));u=new yU(!0);zU(u,"onInvalidData",d);var jb=ga.qa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",ga.qa("TD",null,ga.qa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),
ga.qa("TD",{colspan:"7"},R=ga.qa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));G=new Qq;yq(G,R);ip(G,R);R=G.Aa;ka=nxa(R,"labelledby");go(R,"labelledby","waffle-dv-appearance "+ka);R=ga.qa("TR","waffle-dv-trrules",ga.qa("TD"),ga.qa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},ha=ga.qa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),ka=ga.qa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},
"Reset")));kl(ka,!0);a=a.O.childNodes[0];ga.appendChild(a,pa);ga.appendChild(a,Z);ga.appendChild(a,d);ga.appendChild(a,jb);ga.appendChild(a,R);this.C.render(p);ga=this.C;ga.wqa=29;ga.resize();ga=this.C;ga.SPa=200;ga.resize();this.C.getElement().style.width="324px";Qyc?this.C.getElement().placeholder="Enter items separated by a comma...":(ga=this.C.getElement(),Mr(ga,"Enter items separated by a comma...","Enter items separated by a comma..."));if(ga=this.C.getElement())jo(ga,"Enter items separated by a comma..."),
no(ga,["waffle-dv-list-options-textarea","jfk-textinput"]);iqa&&(a=new ZF("Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday;Monday, Tuesday, Wednesday, Thursday, Friday;January, February, March, April, May, June, July, August, September, October, November, December;Alabama, Alaska, Arizona, Arkansas, California, Colorado, Connecticut, Delaware, District of Columbia, Florida, Georgia, Hawaii, Idaho, Illinois, Indiana, Iowa, Kansas, Kentucky, Louisiana, Maine, Maryland, Massachusetts, Michigan, Minnesota, Mississippi, Missouri, Montana, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, New York, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, Rhode Island, South Carolina, South Dakota, Tennessee, Texas, Utah, Vermont, Virginia, Washington, West Virginia, Wisconsin, Wyoming;AK, AL, AR, AZ, CA, CO, CT, DC, DE, FL, GA, HI, IA, ID, IL, IN, KS, KY, LA, MA, MD, ME, MI, MN, MO, MS, MT, NC, ND, NE, NH, NJ, NM, NV, NY, OH, OK, OR, PA, RI, SC, SD, TN, TX, UT, VA, VT, WA, WI, WV, WY;United States of America, USA, Afghanistan, Albania, Algeria, Andorra, Angola, Antigua & Deps, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Barbados, Belarus, Belgium, Belize, Benin, Bhutan, Bolivia, Bosnia Herzegovina, Botswana, Brazil, Brunei, Bulgaria, Burkina, Burma, Burundi, Cambodia, Cameroon, Canada, Cape Verde, Central African Republic, Chad, Chile, China, People's Republic of China, Republic of China, Colombia, Comoros, Democratic Republic of the Congo, Republic of the Congo, Costa Rica, Croatia, Cuba, Cyprus, Czech Republic, Danzig, Denmark, Djibouti, Dominica, Dominican Republic, East Timor, Ecuador, Egypt, El Salvador, Equatorial Guinea, Eritrea, Estonia, Ethiopia, Fiji, Finland, France, Gabon, The Gambia, Georgia, Germany, Ghana, Greece, Grenada, Guatemala, Guinea, Guinea-Bissau, Guyana, Haiti, Holy Roman Empire, Honduras, Hungary, Iceland, India, Indonesia, Iran, Iraq, Republic of Ireland, Israel, Italy, Ivory Coast, Jamaica, Japan, Jonathanland, Jordan, Kazakhstan, Kenya, Kiribati, North Korea, South Korea, Kosovo, Kuwait, Kyrgyzstan, Laos, Latvia, Lebanon, Lesotho, Liberia, Libya, Liechtenstein, Lithuania, Luxembourg, Macedonia, Madagascar, Malawi, Malaysia, Maldives, Mali, Malta, Marshall Islands, Mauritania, Mauritius, Mexico, Micronesia, Moldova, Monaco, Mongolia, Montenegro, Morocco, Mount Athos, Mozambique, Namibia, Nauru, Nepal, Newfoundland, Netherlands, New Zealand, Nicaragua, Niger, Nigeria, Norway, Oman, Ottoman Empire, Pakistan, Palau, Palestine, Panama, Papua New Guinea, Paraguay, Peru, Philippines, Poland, Portugal, Prussia, Qatar, Romania, Rome, Russian Federation, Rwanda, St Kitts & Nevis, St Lucia, Saint Vincent, Grenadines, Samoa, San Marino, Sao Tome & Principe, Saudi Arabia, Senegal, Serbia, Seychelles, Sierra Leone, Singapore, Slovakia, Slovenia, Solomon Islands, Somalia, South Africa, Spain, Sri Lanka, Sudan, Suriname, Swaziland, Sweden, Switzerland, Syria, Tajikistan, Tanzania, Thailand, Togo, Tonga, Trinidad & Tobago, Tunisia, Turkey, Turkmenistan, Tuvalu, Uganda, Ukraine, United Arab Emirates, United Kingdom, Uruguay, Uzbekistan, Vanuatu, Vatican City, Venezuela, Vietnam, Yemen, Zambia, Zimbabwe;Pass, Fail;Yes, No;Approved, Rejected;Approved, Rejected, Pending;Complete, In Progress, Not Started;On Track, At Risk, Delayed;True, False;Q1, Q2, Q3, Q4;Small, Medium, Large;XS, S, M, L, XL;A+, A, A-, B+, B, B-, C+, C, C-, D, F".split(";"),
!0),d=new aG,pa=new cG(null,null,!1),a=new XF(a,d,pa),pa.C=a,pa.y0(ga),a.He().Kta=!0);this.F=ha;c.setVisible(!0);ha=Syc(this);$yc(this,ha,c);ha=Wyc(this);$yc(this,ha,w);ha=Tyc(this);$yc(this,ha,C);ha=Uyc(this);$yc(this,ha,y);azc(this,c,w,C,y,l,m,e,f,h,k,b,p,r,Z,R,N,Ka,ka,G,ya,u)};
function azc(a,b,c,d,e,f,h,k,l,m,p,r,u,w,y,C,G,N,R,Z,ha,ka){a.H=b;a.H.setVisible(!0);a.va=c;a.Z=e;a.Ea=d;a.Pb=r;a.L=f;a.ea=h;a.O=k;a.ma=l;a.J=m;a.V=p;a.Wa=u;a.Ga=w;a.qb=ha;Z.Cc(!1);a.Ab=Z;a.Pc=ka;bzc(a,!1);a.Db=y;G.Cc(!0);a.Ua=G;a.Od=N;a.Lb=C;S(a.Lb,!0);czc(a);dzc(a);a.jb=R;S(a.jb,!1)}function ezc(a,b){S(a.Db,23==b||24==b||31==b);a.Od.innerText=31==b?"Display in-cell checkbox":"Show dropdown list in cell"}
function $yc(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa(),e=new eq(b[d].qj,null,e);c.cf(e);fo(e.getElement(),"menuitem")}c.Qf(0)}q.foa=function(){dzc(this);this.F.value=kX(this);this.dispatchEvent("change")};q.Mtb=function(){czc(this);dzc(this);this.F.value=kX(this);this.dispatchEvent("change")};q.gUa=ca("If");q.Tna=function(a){this.Yb||a&&!Mva(a)||this.F.value===fzc(this)||(this.Yb=!0,S(this.jb,!0))};q.vAb=function(){this.Yb=!1;this.F.value=kX(this);S(this.jb,!1)};
q.gNa=function(){S(this.Lb,this.Ab.L)};q.KWb=function(a){this.F.value=kX(this);gzc(this,a)?(this.D.Pn=0,lX(a),this.dispatchEvent("change")):(this.D.Pn=1,mX(a),this.dispatchEvent("error"))};q.LWb=function(){this.dispatchEvent("keyup")};function gzc(a,b){if(0!=nX(a))return!0;var c=b.value;if(null!=c&&To(b)){if(!hzc(a.D))return!0;a=oX(a,c,izc(a).code);return null!=a&&(yc(a,3)||yc(a,5)&&B(a,5).xd()&&3==B(B(a,5).Va(),1))}return!0}function mX(a){a.select();mo(a,"waffle-input-error")}
function lX(a){a&&oo(a,"waffle-input-error")}function nX(a){return Syc(a)[a.H.Ci()].type}function czc(a){var b=nX(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.Z.setVisible(c);a.va.setVisible(d);a.Ea.setVisible(e);S(a.Wa,f);S(a.qb,h);S(a.L,!1);S(a.ea,!1);S(a.O,!1);S(a.ma,!1);S(a.J,!1);S(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function izc(a){var b;null!=jzc(a)?b=jzc(a):a.Z.sb()?b=Uyc(a)[a.Z.Ci()]:a.va.sb()?b=Wyc(a)[a.va.Ci()]:5==nX(a)?b=Xyc():6==nX(a)?b=Yyc():b=Tyc(a)[a.Ea.Ci()];return b}function jzc(a){var b=Vyc(a);return 4==nX(a)?b[0]:3==nX(a)?b[1]:null}
function dzc(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,p=izc(a);-1!=p.inputs&&(0==p.inputs?d=!0:1==p.inputs?k=e=d=!0:2==p.inputs?f=!0:3==p.inputs?k=h=f=!0:7==p.inputs?b=!0:8==p.inputs?k=c=b=!0:5==p.inputs?l=!0:6==p.inputs&&(m=!0));var r=izc(a);if(3==nX(a))Qyc?a.C.getElement().placeholder="Enter items separated by a comma...":(r=a.C.getElement(),Mr(r,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(r.example)if(0==r.inputs||1==r.inputs)YR(a.Vc,"e.g., "+
r.example),YR(a.we,"e.g., "+r.RR||"");else if(2==r.inputs||3==r.inputs)YR(a.jc,"e.g., "+r.example),YR(a.od,"e.g., "+r.RR||"");else if(7==r.inputs||8==r.inputs)YR(a.zc,"e.g., "+r.example),YR(a.Hd,"e.g., "+r.RR||"");lX(a.C.getElement());lX(a.J);lX(a.V);lX(a.L);lX(a.ea);lX(a.O);lX(a.ma);lX(a.Ga.As());a.D.Pn=0;a.dispatchEvent("change");S(a.L,b);S(a.ea,c);S(a.O,d);S(a.ma,e);S(a.J,f);S(a.V,h);S(a.Wa,l);l&&a.C.resize();S(a.qb,m);ezc(a,p.code);S(a.Pb,k)}
function oX(a,b,c){var d=hzc(a.D);if(""==b||null==d.hd)return null;var e=d.rect,f=e.Bc(),e=e.yc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.hd+"",f,e,b,c,!0))?a.Ke.qd(Yd.Fa(),b):null}function kzc(a){var b=Wa(a.Ga.Va());!a.Hb.C.D[Wa(ib(b).toLowerCase())]&&FC(a.Hb,b)&&(b=h_a(a.Hb,b,!0));return b}function kX(a){return a.Yb||a.If?a.F.value:fzc(a)}
function fzc(a){var b="",c,d;d=nX(a);c=4==d;d=3==d||4==d;a.Z.sb()?(d=Uyc(a)[a.Z.Ci()],b=-1==d.inputs?b+"Enter a valid date":b+"Enter a date "):a.Ea.sb()?(d=Tyc(a)[a.Ea.Ci()],b=14==d.code?b+"Enter a valid email":15==d.code?b+"Enter a valid url":b+"Enter text that "):d?(d=jzc(a),b+="Click and enter a value from "):5==nX(a)?(d=Xyc(),b="Enter a value that satisfies the formula:"):6==nX(a)?(d=Yyc(),b="Enter TRUE or FALSE"):(d=Wyc(a)[a.va.Ci()],b+="Enter a number ");-1!=d.inputs&&(b+=d.qj);var e=kzc(a);
23==d.code&&""!=e&&c&&(c=h_a(a.Hb,e,!0))&&(b+=" "+c);Ua(ib(a.O.value))||0!=d.inputs&&1!=d.inputs?Ua(ib(a.J.value))||2!=d.inputs&&3!=d.inputs?Ua(ib(a.L.value))||7!=d.inputs&&8!=d.inputs||(b+=" "+a.L.value):b+=" "+a.J.value:b+=" "+a.O.value;Ua(ib(a.ma.value))||1!=d.inputs?Ua(ib(a.V.value))||3!=d.inputs?Ua(ib(a.ea.value))||8!=d.inputs||(b+=" and "+a.ea.value):b+=" and "+a.V.value:b+=" and "+a.ma.value;return b}function bzc(a,b){AU(a.Pc,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}
function pX(a,b){switch(b){case 0:a.H.Qf(2);break;case 1:a.H.Qf(3);break;case 2:a.H.Qf(4);break;case 3:a.H.Qf(1);break;case 4:a.H.Qf(0);break;case 5:a.H.Qf(5);break;case 6:a.H.Qf(6)}}q.xa=function(){this.ea=this.L=this.ma=this.O=this.V=this.J=null;H(this.C);this.Db=this.Ua=this.jb=this.F=this.Pb=this.C=null;H(this.Ga);this.Ga=null;H(this.Ua);this.Ua=null;H(this.Ea);this.Ea=null;H(this.va);this.va=null;H(this.Z);this.Z=null;H(this.H);this.H=null;Pyc.$.xa.call(this)};function lzc(a,b,c,d,e){qp.call(this);this.va=a;this.qb=b;this.Wa=c;this.jb=d;this.V=e;this.F=this.O=null;this.Xa=new K(this);F(this,this.Xa);this.ma=this.J=this.C=null;this.L=new yp;this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);Fp(this,this.L);xp(this,!1);this.render();a=this.mc();b=Gk(a);rp(this,"Data validation");this.J||(c=b.qa("DIV",{"class":mzc.JYa}),d=b.qa("DIV",{"class":mzc.IYa},c),b.appendChild(a,d),this.J=new Xq(d),this.J.setType("warning"),
this.J.setContent(""),this.J.render(c),IAa(this.J,!0),this.J.setVisible(!1));this.O=b.qa("TABLE",{cellSpacing:"0","class":mzc.PJ},b.qa("TBODY"));b.appendChild(a,this.O);a=this.mc();a=Gk(a);b=a.qa("TR",mzc.k3a);b.appendChild(a.qa("TD","waffle-dv-label",a.qa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.qa("TD",{colspan:"7"});this.C=Zyc(this,c);nzc(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.As())&&go(a,"labelledby","waffle-dv-cell-range");this.F=new Pyc(this,
this.va,this.V);mq(this,"save");this.Xa.R(this,"dialogselect",this.JWb).R(this.F,"error",this.Gtb).R(this.F,"change",this.IWb)}x(lzc,qp);var mzc={PJ:"waffle-dv-table",k3a:"waffle-dv-trrules",IYa:"waffle-input-error-butter-container",JYa:"waffle-input-error-butter-wrap",s0a:"waffle-input-error"};q=lzc.prototype;q.Pn=0;function nzc(a){if(a.C){var b=a.va.getActiveGrid();b&&(b=Xu(KA(a.Wa).cd(),b.C),a.C.mb(b))}}q.Gtb=function(){ozc(this)};q.IWb=function(){ozc(this);Jp(this.L,"save",!0)};
q.JWb=function(a){if("save"==a.key){var b;b=this.F;var c=nX(b);if(0==c){var c=b.L,d=b.ea,e=gzc(b,c),f=gzc(b,d);e&&f?b.D.Pn=0:(e||mX(c),f||mX(d),b.D.Pn=1)}else 1==c?(c=b.O,d=b.ma,e=!To(c)||!Ua(ib(c.value)),f=!To(d)||!Ua(ib(d.value)),e&&f?b.D.Pn=0:(e||mX(c),f||mX(d),b.D.Pn=6)):2==c?(c=b.J,d=b.V,e=!To(c)||!Ua(ib(c.value)),f=!To(d)||!Ua(ib(d.value)),e&&f?b.D.Pn=0:(e||mX(c),f||mX(d),b.D.Pn=7)):3==c||4==c?(c=0,4==nX(b)?(d=kzc(b),FC(b.Hb,d)?(d=kzc(b),d=GC(b.Hb,d),e=hzc(b.D),null!=d&&null!=e&&d.hd==e.hd&&
d.rect.intersects(e.rect)&&(c=4)):c=3):3==nX(b)&&b.C.getElement()&&Ua(ib(b.C.Va()))&&(c=5),d=c,c=0==d,b.D.Pn=d,d=b.qb&&To(b.qb),b.Wa&&To(b.Wa)?(to(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().px(b.Ga.getElement()),to(d,"waffle-input-error",!c),b.Ga.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error")):b.D.Pn=0;b=this.C.Va();b=FC(this.V,b);2==this.Pn&&b?this.Pn=0:0!=this.Pn||b||(this.Pn=2);ozc(this);if(0!=this.Pn)b=!1;else{b=this.F;c=b.Pc.isChecked("rejectInvalidData_radio");
d=kX(b);b.Ab.isChecked()||(d="");b:{var e=new ae,h=izc(b),f=h.code,k=[];switch(h.inputs){case 0:k.push(oX(b,b.O.value,f));break;case 1:k.push(oX(b,b.O.value,f));k.push(oX(b,b.ma.value,f));break;case 2:k.push(oX(b,b.J.value,f));break;case 3:k.push(oX(b,b.J.value,f));k.push(oX(b,b.V.value,f));break;case 7:k.push(oX(b,b.L.value,f));break;case 8:k.push(oX(b,b.L.value,f));k.push(oX(b,b.ea.value,f));break;case 5:for(var h=b.C.Va().split(","),l=0;l<h.length;l++)k.push(Twc(h[l]));break;case 6:h=$Ha("="+b.Ga.Va()),
k.push(oX(b,h,f))}for(h=0;h<k.length;h++)if(!k[h]){e=null;break b}f=mS(f,k);D(e,1,f)}(f=e)?(e=new be,D(e,1,f),D(e,2,d),D(e,3,c),b=To(b.Db)&&b.Ua.isChecked(),D(e,4,b),b=(b=pzc(this))?this.jb.C(new iX(e,b)):!1):b=!1}if(!b){a.preventDefault();return}}else{if(b="clear"==a.key)b=pzc(this),b=!(b&&this.jb.C(new iX(new be,b)));if(b){a.preventDefault();return}}this.C&&this.C.cb(!1)};
function ozc(a){var b=qzc(a.Pn);b&&a.J.setContent(b);a.J.setVisible(0!=a.Pn);var b=2==a.Pn||4==a.Pn,c=a.oa().px(a.C.getElement());to(c,mzc.s0a,b);b&&a.C.As().select()}
function qzc(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date"}return null}function pzc(a){var b=a.C.Va(),b=(b=GC(a.V,b))?b.rect:null,c=a.C.Va();a=(a=GC(a.V,c))?a.hd:null;return b&&null!=a?rh(b,a):null}
function hzc(a){var b=a.C.Va();return GC(a.V,b)}function Zyc(a,b){var c=a.va.C.C,c=new VS(a.Wa,v(a.HWb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.oa());a.getHandler().R(c,"change",function(){var a=this.F;a&&(a.F.value=kX(a))});c.render(b);return c}q.setVisible=function(a){lzc.$.setVisible.call(this,a);a&&this.ma&&(this.ma.focus(),this.ma=null)};q.HWb=function(a,b,c,d){this.ma=a.As();this.qb.oea(this,a,b,c,!1,!0,d)};
q.show=function(){var a="",b=!1,c=Bu(this.va),d=gv(c),c=Pz(hv(c,d)),e=null,d=!1;c&&(c=c.C,e=B(c,1),a=B(c,2),b=B(c,3),d=B(c,4));var c=this.F,f=e,h=d;c.H.Qf(0);c.Z.Qf(0);c.va.Qf(0);c.Ea.Qf(0);c.F.value="";c.L.value="";c.ea.value="";c.J.value="";c.V.value="";c.O.value="";c.ma.value="";c.C.mb("");c.Ga.mb("");bzc(c,!1);var k=c.Yb=!1,l=!1,m=!1,p=!1,r=!1,u=!1,w=!1,y=e=d=!1,C=!1,G=!1,N=!1,R=!1,Z=!1,ha=!1,ka=!1,ga=f&&B(f,1),f=ga&&B(ga,1);if((ga=ga&&Dc(ga,2))&&f){for(var pa=Vyc(c),ya=Uyc(c),Ka=Wyc(c),jb=Tyc(c),
Qa=Xyc(),lb=Yyc(),Oa=0,fb=0;fb<pa.length;fb++)if(f==pa[fb].code){Oa=pa[fb].inputs;23==pa[fb].code?(Z=!0,pX(c,4)):(C=!0,pX(c,3));c.Ua.Cc(!!h);break}for(pa=0;pa<ya.length;pa++)if(f==ya[pa].code){Oa=ya[pa].inputs;c.Z.Qf(pa);pX(c,2);G=d=!0;break}for(ya=0;ya<Ka.length;ya++)if(f==Ka[ya].code){Oa=Ka[ya].inputs;c.va.Qf(ya);pX(c,0);N=e=!0;break}for(Ka=0;Ka<jb.length;Ka++)if(f==jb[Ka].code){Oa=jb[Ka].inputs;c.Ea.Qf(Ka);pX(c,1);R=y=!0;break}f==Qa.code&&(Oa=Qa.inputs,pX(c,5),ha=!0);f==lb.code&&(Oa=lb.inputs,
pX(c,6),c.Ua.Cc(!!h),ka=!0);if(G||R||N||C||Z||ha||ka){if(N=hzc(c.D),h=N.rect.Bc(),G=N.rect.yc(),N=N.hd+"",-1!=Oa)if(0==Oa)r=Oy(ga[0],N,h,G),c.Vc.mb(r),r=!0;else if(1==Oa)u=Oy(ga[0],N,h,G),r=Oy(ga[1],N,h,G),c.Vc.mb(u),c.we.mb(r),u=r=w=!0;else if(2==Oa)k=Oy(ga[0],N,h,G),c.jc.mb(k),k=!0;else if(3==Oa)l=Oy(ga[0],N,h,G),k=Oy(ga[1],N,h,G),c.jc.mb(l),c.od.mb(k),l=k=w=!0;else if(7==Oa)m=Oy(ga[0],N,h,G),c.zc.mb(m),m=!0;else if(8==Oa)p=Oy(ga[0],N,h,G),m=Oy(ga[1],N,h,G),c.zc.mb(p),c.Hd.mb(m),p=m=w=!0;else if(5==
Oa){C=!0;Oa=[];for(R=0;R<ga.length;R++)Oa.push(Oy(ga[R],N,h,G));c.C.mb(Oa.join(","));c.C.resize()}else 6==Oa&&(Z=!0,Oa=Oy(ga[0],N,h,G),null!=Oa&&(Oa=Oa.substring(1),ga=!!Tu(Oa),Oa=(h=Vu(Oa,c.lh,!1,!0))?Xu(h.rect,h.Xi):Oa,ga||(Oa=Uu(Oa)),c.Ga.mb(Oa)))}else c.H.Qf(0),Z=!0;S(c.Pb,w);c.Z.setVisible(d);c.va.setVisible(e);c.Ea.setVisible(y);S(c.J,k);S(c.V,l);S(c.O,r);S(c.ma,u);S(c.L,m);S(c.ea,p);S(c.Db,!0);S(c.Wa,C);c.C.resize();S(c.qb,Z);null!=f&&ezc(c,f)}else{if(fqa){d=Bu(c.lh);e=d.cd();y=new fg;for(C=
e.Bc();C<e.Xc();C++)for(Z=e.yc();Z<e.dd();Z++)f=d.Pf(C,Z),""!=Nz(f)&&gg(y,Nz(f).split(Ryc));y.isEmpty()?d=!1:(c.C.mb(y.Dd().join(",")),pX(c,3),czc(c),d=!0)}else d=!1;d||azc(c,c.H,c.va,c.Ea,c.Z,c.L,c.ea,c.O,c.ma,c.J,c.V,c.Pb,c.Wa,c.Ga,c.Db,c.Lb,c.Ua,c.Od,c.jb,c.Ab,c.qb,c.Pc)}c.gNa();a=a||"";d=a.lastIndexOf("</strong>");-1!=d&&(a=$a(Wa(a.substring(d+9))));c.Ab.Cc(!!a);a&&(kX(c)!=a&&c.Tna(),c.F.value=a,S(c.Lb,!0));bzc(c,b);this.setVisible(!0);this.C&&this.C.cb(!0);nzc(this);c=this.F;c.F.value=kX(c);
c.C.resize()};q.xa=function(){H(this.F);this.F=null;H(this.C);this.L=this.O=this.C=null;lzc.$.xa.call(this)};function rzc(a,b,c,d,e){qp.call(this);this.Vc=d.O;this.qb=c;this.Db=d.C;this.Wa=d;this.Fb=e;this.Ab=null;this.Yb=d.V;rp(this,"Find and replace");xp(this,!1);c=this.mc();d=Gk(c);this.F=d.qa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F.value=a;this.va=d.qa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C=new RG(null);this.od=b;this.O=new VS(this.qb,v(this.eXb,this),!1,"",!0);this.V=null;this.ma=new Qq;this.jb=new Qq;this.L=new Qq;this.J=new Qq;this.zc=this.Lb=this.Pb=
this.jc=!1;this.Hb=d.qa("SPAN");cgc(this.Hb);this.Pc=new nq(this.F);F(this,this.Pc);a=szc;d.qa("LABEL",{"for":a.uxa},"Search");b=d.qa("LABEL",{"for":a.rya},"Match case");e=d.qa("LABEL",{"for":a.sya},"Match entire cell contents");var f=d.qa("LABEL",{},"Also search within formulas"),h=d.qa("LABEL",{"for":a.cAa},"Search using regular expressions "),k=(new yl(Mpa)).toString(),l=d.qa("SPAN",null,d.qa("A",{target:"_blank",href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});var k=jp(this,"findLabel"),m=jp(this,"replaceLabel"),p=jp(this,"findScopeLabel"),r=d.qa("DIV","goog-inline-block"),u=d.qa("DIV",a.m2a),l=d.qa("TABLE",null,d.qa("TBODY",null,d.qa("TR",null,d.qa("TD",a.LABEL,d.qa("LABEL",{id:k},"Find")),d.qa("TD",null,this.F)),d.qa("TR",null,d.qa("TD",a.LABEL,d.qa("LABEL",{id:m},"Replace with")),d.qa("TD",null,this.va)),d.qa("TR",null,d.qa("TD",null,d.qa("LABEL",{id:p},"Search")),d.qa("TD",null,r,u)),d.qa("TR",null,d.qa("TD",null,""),d.qa("TD",
null,b,d.qa("BR"),e,d.qa("BR"),h,l,d.qa("BR"),f)),d.qa("TR",null,d.qa("TD",{colspan:"2"},this.Hb))));this.C.render(r);mo(this.C.getElement(),a.uxa);this.O.render(u);ip(this.ma,b);yq(this.ma,b);this.ma.getElement().id=a.rya;ip(this.jb,e);yq(this.jb,e);this.jb.getElement().id=a.sya;ip(this.L,h);yq(this.L,h);this.L.getElement().id=a.cAa;yq(this.J,f);ip(this.J,f);go(this.F,"labelledby",k);go(this.va,"labelledby",m);go(this.C.Aa,"labelledby",p);d.appendChild(c,l);c=new yp;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Fp(this,c);mq(this,"");this.getHandler().R(this,"dialogselect",this.fXb).R(this.Pc,"input",this.DOa).R(this.L,"change",this.lBb).R(this.C,"change",this.Krb).R(this.O,"change",this.gXb).R(this.J,"change",this.mBb);c=new oq;c.tb(this.F);F(this,c);c=new oq;c.tb(this.va);F(this,c);tzc(this);c=new hp(this.getElement());F(this,c);this.getHandler().R(c,"focusin",this.$Wa).R(this.getElement(),"mousedown",this.$Wa)}x(rzc,qp);
var szc={iwa:"waffle-find-replace-dialog-border",uxa:"waffle-find-replace-find-scope-select",LABEL:"waffle-find-replace-dialog-label",rya:"find-replace-case",sya:"find-replace-cell",cAa:"find-replace-regex",m2a:"waffle-find-replace-selection-input goog-inline-block"};
function tzc(a){var b=KA(a.qb),c=null,d=null;b&&(c=pcb(b),d=xu(a.Db,c.hd).C);a.J.Cc(a.Yb);var e=new eq("All sheets",KKa.lYa),f=new eq("This sheet",KKa.u2a),h=new eq("Specific range",KKa.tJ);a.C.cf(e);a.C.cf(f);a.C.cf(h);f=c?OA(a.Db,c.hd):null;f=(f=c&&f?Tv(f,c.rect.Bc(),c.rect.yc()):null)?f.Th():1;c&&c.rect.Th()>f?Hs(a.C,h):Hs(a.C,e);b&&a.O.mb(Xu(c.rect,d))}function uzc(a){var b=a.C.Tf().pb(),c=vu(a.qb.D);return 0==b?Vu(a.O.Va(),a.Db,!1,!0):1!=b||null===c?null:new nh(c,"",new $g(0,0,1,1))}q=rzc.prototype;
q.$Wa=function(a){a.target==this.getElement()?this.focus():this.Fb.Nb(2)};q.gXb=function(){vzc(this)};q.mBb=function(){var a=this.J.isChecked();ZQb(this.Wa,a)};q.Krb=function(){vzc(this)};q.lBb=function(){this.L.isChecked()&&this.ma.Cc(!0)};
q.fXb=function(a){var b=wzc;if("findNext"==a.key)a.preventDefault(),this.jc&&(qX(this,null),xzc(this,b.txa));else if("replace"==a.key)a.preventDefault(),this.Pb&&(qX(this,null),xzc(this,b.rza));else if("replaceAll"==a.key&&(a.preventDefault(),this.zc)){a=v(function(){qX(this,null);xzc(this,b.qza)},this);var c=this.C.Tf().pb();1<this.Db.D.length&&2==c&&!this.Lb?(pgc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Lb=!0):a()}};
q.DOa=function(){var a=0==this.F.value.length;Gp(this.D,"findNext").disabled=a;this.jc=!a;yzc(this,!a);this.Pb&&a&&zzc(this,!1)};q.eXb=function(a,b,c){this.Ab=a.As();this.od.oea(this,a,b,c,!1,!0)};function vzc(a){var b=0==a.C.Tf().pb();a.O.setVisible(b);H(a.V);a.V=null;var c=uzc(a),d=KA(a.qb);b&&d&&c&&(a.V=hH(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.V.setVisible(!0),F(a,a.V))}
function xzc(a,b){if(0==a.C.Tf().pb()&&null==uzc(a))to(a.O.D,"waffle-range-selection-error",!0),qX(a,"Invalid range");else{var c=a.C.Tf().pb();a.dispatchEvent(new Azc(b,a.F.value,a.va.value,c,a.ma.isChecked(),a.jb.isChecked(),a.L.isChecked(),a.J.isChecked(),uzc(a)))}}q.setVisible=function(a){var b=this.Wa.Pd();yzc(this,!b);zzc(this,!b);this.va.disabled=b;rzc.$.setVisible.call(this,a);a&&this.Ab&&(this.Ab.focus(),this.Ab=null)};q.cSb=function(a){this.F.value=a};q.BTa=function(){this.F.select()};
q.focus=function(){this.Dc()&&this.sb()&&(this.F.focus(),this.Fb.Nb(2),St(this.F,this.F.value.length),this.DOa())};function zzc(a,b,c){b=b&&!a.Wa.Pd()&&0==!a.F.value.length;a.Pb=b;a=Gp(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}function yzc(a,b){var c=!!Bb(jfc(a.Vc),function(a){return!a.Yj()});b=b&&!a.Wa.Pd()&&!c&&0==!a.F.value.length;a.zc=b;a=Gp(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}
function qX(a,b){var c=Gk(a.mc());a=a.Hb;b?(0<bl(a).length&&c.appendChild(a,c.qa("BR")),c.appendChild(a,c.qa("B",null,ul(c,b)))):c.Rd(a)}q.xa=function(){rzc.$.xa.call(this);this.Lb=!1;ZQb(this.Wa,this.Yb)};function Azc(a,b,c,d,e,f,h,k,l){I.call(this,a);this.F=b;this.V=c;this.C=d;this.ma=e;this.Ea=f;this.Ga=h;this.Wa=k;this.Db=l||null}x(Azc,I);var wzc={txa:"findnext",f$b:"findall",rza:"replace",qza:"replaceall",DONE:"done",K3b:"canceled"};function Bzc(a,b,c,d,e){E.call(this);var f=wzc;this.H=null;this.C=a;this.D=b;this.F=c;this.L=d;this.J=e;this.Xa=new K(this);F(this,this.Xa);this.Xa.R(a,f.qza,this.oAb).R(a,f.rza,this.pAb).R(a,f.txa,this.ZWa).R(a,f.DONE,this.Mpb)}x(Bzc,E);var rX={fP:"cg",gP:"cr",eP:"cc",sxa:"loop"};q=Bzc.prototype;q.VTb=function(){this.C.setVisible(!0);Czc(this,null)};q.ZWa=function(a){if(Au(this.D.D)){var b=KA(this.D).pb(),c=this.H;c||(c=gv(b),c=vc(rX.fP,b.Fc(),rX.gP,FA(b,c.y),rX.eP,GA(b,c.x)));Dzc(this,a,b,c)}};
function Dzc(a,b,c,d){var e=new qh,f=Ezc(b);Fzc(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.qd((new ew).Fa(),a);a=B(f,1);var d=b.type;Au(this.D.D)&&(c?yc(c,1)?(d=B(c,1),c=vc(rX.fP,parseInt(d.Ib(),10),rX.gP,d.Cz(),rX.eP,d.Li(),rX.sxa,B(c,2)),Gzc(this,a,c)):(Gzc(this,a,{}),"replace"==d&&this.C.focus()):Hzc(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function Fzc(a,b,c){if(c){var d=""+c[rX.fP],e=new de;D(e,1,d);D(e,2,CA(b,c[rX.gP],"r"));D(e,3,CA(b,c[rX.eP],"c"));D(a,10,e)}}
function Ezc(a){var b=new cw;D(b,1,a.F);D(b,3,a.V);D(b,5,a.C);if(0==a.C||1==a.C){var c=a.Db,d=new Nd;D(d,1,""+c.hd);var e=c.rect.Bc();D(d,2,e);Od(d,c.rect.Xc());Pd(d,c.rect.yc());Qd(d,c.rect.dd());b.setSelection(d)}D(b,6,a.ma||!1);D(b,7,a.Ea||!1);D(b,8,a.Ga||!1);b.setType(a.Wa?1:0);D(b,11,0);return b}function Gzc(a,b,c){c?c&&null!=c.cg?(b=c[rX.fP],c[rX.sxa]&&qX(a.C,"No more results found, looping around"),a.F.IA(b,v(a.dXb,a,c))):(Czc(a,null),qX(a.C,"There are no entries matching "+b)):Hzc(a)}
q.dXb=function(a){var b=KA(this.D).pb(),c=a[rX.gP],d=a[rX.eP];a[rX.gP]=FA(b,c);a[rX.eP]=GA(b,d);Czc(this,a);a=new L(d,c);b=new nh(b.Fc(),"",bh(a));$R(this.F,b,v(this.i4a,this,a))};q.i4a=function(a){if(!this.isDisposed()){this.C.focus();var b=KA(this.D).pb();jv(b.Pf(a.y,a.x))&&!this.C.J.isChecked()&&zzc(this.C,!1,"Can't replace formula");var c=Zz(b,a.y),d=$z(b,a.x);!c||!d||c.sb()&&d.sb()||(c=this.C,d=Wu(a),a=Nz(hv(b,a)),qX(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};
function Hzc(a){qX(a.C,null);qX(a.C,"Error while searching spreadsheet. Please try again.")}q.pAb=function(a){if(!this.J.Pd()){var b=this.H;if(b){var c=zy(this.F,b[rX.fP]);if(c){var c=c.ad(),d=CA(c,b[rX.gP],"r"),e=CA(c,b[rX.eP],"c"),f=c.Pf(d,e);if(!jv(f)||this.C.J.isChecked()){var f=Nz(f),h=new qh,k=Ezc(a);D(k,5,0);Fzc(k,c,b);var l=new Nd;D(l,1,""+b[rX.fP]);D(l,2,d);Od(l,d+1);Pd(l,e);Qd(l,e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);Izc(this,c,k,f,b,!1);this.ZWa(a)}}}}};
q.oAb=function(a){if(!this.J.Pd()&&Au(this.D.D)){var b=this.F.getActiveGrid().ad(),c=Ezc(a);Izc(this,b,c,a.F,a.V,!0)}};
function Izc(a,b,c,d,e,f){b=new xU(b,c);Bx(b,v(function(a,b){a?(a=B(b,5),b=B(b,4),b=0==a?"No matches found":f?(new Nm(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),qX(this.C,null),qX(this.C,b)):Hzc(this)},a));qX(a.C,null);qX(a.C,"Working...");a.L.C(b)||Hzc(a)}q.Mpb=function(){Czc(this,null)};function Czc(a,b){a.H=b;(a=a.C)&&zzc(a,null!=b)};function Jzc(){var a='<div id="print-warning">'+U("Sheets with full-page charts and gadgets won't be printed. You can print all other sheets in your spreadsheet.")+'</div><hr class="print-divider"/><table width="100%" role="presentation"><tr><div class="waffle-dialog-header">'+U("Options")+'</div><td width="50%" valign="center" class="print-options-container">',b;b=""+('<div role="radiogroup" aria-label="'+W(Fq("Print options: What to print"))+'"><input type="radio" name="whatPartsGroup" id="print-active-sheet"/><label for="print-active-sheet">'+
U("Current sheet")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-all-sheets"/><label for="print-all-sheets">'+U("All sheets")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-selection"/><label for="print-selection">'+U("Selection")+"</label></div>");b=V(b);a=a+b+'</td><td width="50%" valign="center" class="print-options-container">';b=""+('<div role="group" aria-label="'+W(Fq("Additional print options"))+'"><span id="print-repeat-row-headers" class="jfk-checkbox"></span><label for="print-repeat-row-headers">'+
U("Repeat row headers on each page")+'</label><br/><span id="print-omit-gridlines" class="jfk-checkbox"></span><label for="print-omit-gridlines">'+U("No gridlines")+'</label><br/><span id="print-include-title" class="jfk-checkbox"></span><label for="print-include-title">'+U("Include document title")+'</label><br/><span id="print-include-sheet-names" class="jfk-checkbox"></span><label for="print-include-sheet-names">'+U("Include sheet names")+'</label><br/><span id="print-include-page-numbers" class="jfk-checkbox"></span><label for="print-include-page-numbers">'+
U("Include page numbers")+"</label></div>");b=V(b);a=a+b+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header" id="dialog-paper-size-header">Paper size</div><table width="100%" role="presentation"><tr><td width="50%" valign="center" class="print-options-container">'+V('<div id="print-paper-size" class="jfk-select goog-flat-menu-button" aria-labelledby="dialog-paper-size-header"></div>')+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header">Layout</div>';
b='<table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr>'+('<td role="radiogroup" aria-label="'+W(Fq("Layout"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-fit" /><br/><label for="print-fit">'+U("Fit to width")+'<br/><div class="print-fit-icon">&nbsp;</div><div class="print-layout-caption" id="print-fit-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size"id="print-actual-size" /><br/><label for="print-actual-size">'+
U("Actual size")+'<br/><div class="print-actual-size-icon">&nbsp;</div><div class="print-layout-caption" id="print-actual-size-caption"></div></label></td><td class="print-layout-divider-2"></td></tr></table></td>');b+='<td role="radiogroup" aria-label="'+W(Fq("Orientation"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td class="print-layout-divider-3"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-portrait" /><br/><label for="print-portrait">'+
U("Portrait")+'<br/><div class="print-portrait-icon">&nbsp;</div><div class="print-layout-caption" id="print-portrait-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-landscape" /><br/><label for="print-landscape">'+U("Landscape")+'<br/><div class="print-landscape-icon">&nbsp;</div><div class="print-layout-caption" id="print-landscape-caption"></div></label></td></tr></table></td></tr></table>';
b=V(b);return V(""+(a+b))};function Kzc(a,b,c,d,e,f){qp.call(this,void 0,void 0,f);this.V=a;this.ma=b;this.Ab=d;this.qb=new WP;this.Wa=e;this.jb=c;this.va=!1;this.C={};this.F=new yU(!0,this.oa());this.J=new yU(!0,this.oa());this.L=new yU(!0,this.oa());this.O=null;a=new yp;Hp(a,{key:"ok",caption:"Print"},!0);Hp(a,Lp,!1,!0);Fp(this,a)}x(Kzc,qp);var Lzc={h2a:"print-repeat-row-headers",Fnc:"print-omit-gridlines",eec:"print-include-title",dec:"print-include-sheet-names",cec:"print-include-page-numbers"};q=Kzc.prototype;
q.QV=function(){if(!this.isDisposed()){var a=this.V,b=this.F;b.isChecked("print-active-sheet")?a.C=0:b.isChecked("print-all-sheets")?a.C=1:a.C=2;this.L.isChecked("print-fit")?a.F=0:a.F=1;b=!!this.J.isChecked("print-landscape");a.O=b;b=this.C["print-repeat-row-headers"].isChecked();a.ea=b;b=this.C["print-omit-gridlines"].isChecked();a.V=b;b=this.C["print-include-title"].isChecked();a.L=b;b=this.C["print-include-sheet-names"].isChecked();a.J=b;b=this.C["print-include-page-numbers"].isChecked()?"CENTER":
"UNDEFINED";a.Z=b;b=this.O.Tf().pb();a.D=b;Mzc(this);this.SGa()}};
function Nzc(a){var b=a.V,c=a.F;0==b.C?AU(c,"print-active-sheet"):1==b.C?AU(c,"print-all-sheets"):AU(c,"print-selection");AU(a.L,0==b.F?"print-fit":"print-actual-size");AU(a.J,b.O?"print-landscape":"print-portrait");a.C["print-repeat-row-headers"].Cc(!!b.ea);a.C["print-omit-gridlines"].Cc(!!b.V);a.C["print-include-title"].Cc(!!b.L);a.C["print-include-sheet-names"].Cc(!!b.J);a.C["print-include-page-numbers"].Cc("UNDEFINED"!=b.Z);var d=a.O;d.Tc().og(function(a){a.pb()==b.D&&Hs(d,a)});Mzc(a);Mc&&(a.mc().style.display=
"",oba(a.getElement().offsetHeight),a.mc().style.display="block",oba(a.getElement().offsetHeight))}
q.Vqb=function(a){if("ok"==a.key){this.QV();var b=this.V;a=this.va&&ffc();var c=b.ea,d=!b.O,e=0==b.F,f=0==b.C,h=2==b.C,k=b.V,l=b.L,m=b.J,p=b.Z,r=new Gl;r.set("size",b.D);r.set("fzr",c);r.set("portrait",d);r.set("scale",e?"2":"1");(f||h)&&r.set("gid",vu(this.ma));h&&(b=Bu(this.ma).cd(),c=b.Bc(),d=b.yc(),e=b.Xc(),f=b.dd(),r.set("r1",c),r.set("c1",d),r.set("r2",e),r.set("c2",f),r.set("ir",b.ue()),r.set("ic",b.xe));r.set("gridlines",!k);r.set("printtitle",l);r.set("sheetnames",m);r.set("pagenum",p);k=
new Ce;l=YHa(this.ma);for(m=0;m<l.length;m++)b=l[m],c=b.ad().H,Fu(c)&&(Iu(c),p=new Be,d=""+b.Ib(),D(p,1,d),d=dfc(c),D(p,3,d),b=rh(Gu(c),b.Ib()),D(p,4,b),Ac(k,1,p));Dc(k,1).length&&(l=new qh,l.Kw=!0,r.set("gridFiltersProto",yi(l.serialize(k))));null!=a&&r.set("attachment",!a);k=r.Me();l=[];for(m=0;m<k.length;m++)l.push(k[m]+"="+r.get(k[m]));k=l.join(",");l={format:"pdf"};m=r.Me();for(p=0;p<m.length;p++)l[m[p]]=r.get(m[p]);r=this.Ab.Zf("/export");a=v(this.qb.J,this.qb,lj(bk(r)),l,a);this.va&&this.jb?
(this.Wa(!1),r=this.jb,nfc(r.D,r.H,mfc(r),k?"id="+r.C+","+k:r.C,a)):(this.Wa(!0),a())}};function Mzc(a){Ozc(a,a.L,"print-fit");Ozc(a,a.L,"print-actual-size");Ozc(a,a.J,"print-landscape");Ozc(a,a.J,"print-portrait")}function Ozc(a,b,c){to(a.oa().gt(b.getElement(c)),"print-radio-checked",b.isChecked(c))}q.SGa=sa;
q.Ja=function(){Kzc.$.Ja.call(this);mq(this,"ok");var a=this.mc();sq(a,Jzc);mo(this.getElement(),"print-dialog");var b=this.oa();H(this.F);this.F=new yU(!0,this.oa());zU(this.F,"whatPartsGroup",a);H(this.J);this.J=new yU(!0,this.oa());zU(this.J,"print-layout-orientation",a);H(this.L);this.L=new yU(!0,this.oa());zU(this.L,"print-layout-size",a);for(var c in Lzc){var d=Lzc[c];H(this.C[d]);a=this.C[d]=new Qq;d=b.getElement(d);a.tb(d);yq(a,d.nextSibling)}H(this.O);c=this.O=jX();c.tb(b.getElement("print-paper-size"));
sX(this,"0",'Letter (8.5" x 11")',"Letter (8.5 inches x 11 inches)");sX(this,"33",'Tabloid (11" x 17")',"Tabloid (11 inches x 17 inches)");sX(this,"2",'Legal (8.5" x 14")',"Legal (8.5 inches x 14 inches)");sX(this,"32",'Statement (5.5" x 8.5")',"Statement (5.5 inches x 8.5 inches)");sX(this,"30",'Executive (7.25" x 10.5")',"Executive (7.25 inches x 10.5 inches)");sX(this,"31",'Folio (8.5" x 13")',"Folio (8.5 inches x 13 inches)");sX(this,"6","A3 (297 mm x 420 mm)");sX(this,"7","A4 (210 mm x 297 mm)");
sX(this,"8","A5 (148 mm x 210 mm)");sX(this,"18","B4 (250 mm x 353 mm)");sX(this,"19","B5 (176 mm x 250 mm)");this.getHandler().R(c,"action",this.QV).R(this.F,"action",this.xFb).R(this.J,"action",this.Wxb).R(this.L,"action",this.QV).R(this,"afterhide",this.QV).R(this,"dialogselect",this.Vqb)};function sX(a,b,c,d){a.O&&(b=new eq(c,b),a.O.cf(b),a=b.mc(),d&&a&&jo(a,d))}q.Wxb=function(){this.QV()};
q.xFb=function(){var a=this.C["print-repeat-row-headers"],b=this.V;this.F.isChecked("print-selection")&&a.isChecked()?(a.Cc(!1),b.H=!0):this.V.H&&(a.Cc(!0),b.H=!1);this.QV()};q.show=function(a){this.va=a;rp(this,a?"Print settings":"Export to PDF");this.D.set("ok",a?"Print":"Export",!0);this.setVisible(!0);a=this.oa();var b=this.ma;S(a.getElement("print-warning"),!1);QVa(b)?(Mwc(this.F),this.F.cb("print-selection",!1),2==this.V.C&&(this.V.C=0)):Mwc(this.F);Nzc(this);this.SGa()};
q.xa=function(){for(var a in this.C)H(this.C[a]);H(this.O);H(this.L);H(this.J);H(this.F);Kzc.$.xa.call(this)};function Pzc(a){a=""+(Qzc({id:"waffle-resize-selection-custom",hPa:a.XDa,Kk:Gq("<br />"+U($wc({id:"waffle-resize-input",Je:"waffle-resize-inset-input"})))})+Qzc({id:"waffle-resize-selection-auto",hPa:Fq("Fit to data"),Kk:Gq("")}));return V(a)}function Qzc(a){return V('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+W(a.id)+'"><label for="'+W(a.id)+'" class="waffle-resize-label">'+U(a.hPa)+"</label>"+U(a.Kk)+"</div>")}
function Rzc(a){return V('<label for="waffle-resize-input" >'+U(a.XDa)+'</label><br /><br /><input id="waffle-resize-input" />')};function Szc(a,b,c,d,e){qp.call(this);this.Re=a;this.V=b;var f=this.Re.cd().Nd();this.C=f;this.F=vb(this.Re.lk(),function(a){return a.Nd()==f});this.J=new WN;this.L=new yU(!0);this.ma=c;this.va=d;this.O=e}x(Szc,qp);var Tzc={Jea:"waffle-resize-selection-auto",CUSTOM:"waffle-resize-selection-custom",q0a:"waffle-resize-input",r1a:"waffle-resize-selection"};q=Szc.prototype;
q.qa=function(){Szc.$.qa.call(this);var a;var b=this.F[0];if("r"==this.C){a=b.Bc();var b=b.Xc()-1,c=String(Nu(a+1)),d=String(Nu(b+1));a=1<this.F.length?"Resize selected rows":a==b?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else a=b.yc(),b=b.dd()-1,c=Pu(a),a=1<this.F.length?"Resize selected columns":a==b?"Resize column "+c:"Resize columns "+(c+(" - "+Pu(b)));rp(this,a);a="r"==this.C?Rzc:Pzc;this.mc().appendChild(vq(a,{XDa:"r"==this.C?"Enter new row height in pixels. (Default: "+(pu+")"):"Enter new column width in pixels. (Default: "+
(MUa+")")}));mq(this,"ok")};q.Ja=function(){Szc.$.Ja.call(this);var a=this.oa();this.J.tb(a.getElement(Tzc.q0a));var a=this.Re.cd(),b=a.Nd(),a=LUa(mA(this.Re,b,a.$g(b)));this.J.mb(String(a));"c"==this.C&&(zU(this.L,Tzc.r1a),AU(this.L,Tzc.CUSTOM));this.getHandler().R(this,"dialogselect",this.qBb).R(this.J.getElement(),"focus",this.SEb)};q.SEb=function(){"c"==this.C&&AU(this.L,Tzc.CUSTOM)};q.focus=function(){this.Dc()&&this.J.zm()};
q.qBb=function(a){if("ok"==a.key)if("r"==this.C||Ikc(this.L)==Tzc.CUSTOM)a=parseInt(this.J.Va(),10),isNaN(a)?Dm("Entered value is not a number."):2>a||2E3<a?Dm("Size must be between 2 and 2000 pixels."):(this.O.C("r"==this.C?35310:35308),this.V.C(new aJ(this.Re,this.F[0],a,this.F.slice(1))));else{var b=KA(this.ma).ea;a=b.C;b=vh(M(),"fecllr")?b.H:null;this.O.C(35307);Tob(this.F,a,b,this.va,this.V)}};function Uzc(a){Ci(this,a,0,-1,null)}x(Uzc,Bi);Uzc.prototype.getType=function(){return O(this,3)};Uzc.prototype.setType=function(a){P(this,3,a)};function Vzc(a){T.call(this,a);this.Z=hm("email");this.C=this.D=null}x(Vzc,T);q=Vzc.prototype;
q.qa=function(){var a=this.oa(),b=this.oa();this.C=new sT;F(this,this.C);this.D=new sT;F(this,this.D);var c=b.qa("DIV","waffle-dialog-notifications-input");fo(c,"presentation");this.F=new qT;rT(this.F,b.qa("LABEL",null,"Any changes are made"));this.F.render(c);this.C.iH(this.F);var d=b.qa("DIV","waffle-dialog-notifications-input");fo(d,"presentation");this.J=new qT;rT(this.J,b.qa("LABEL",null,"A user submits a form"));this.J.render(d);this.C.iH(this.J);var e=b.qa("DIV","waffle-dialog-notifications-input");
fo(e,"presentation");this.H=new qT;rT(this.H,b.qa("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.iH(this.H);var f=b.qa("DIV","waffle-dialog-notifications-input");fo(f,"presentation");this.L=new qT;rT(this.L,b.qa("LABEL",null,"Email - right away"));this.L.render(f);this.D.iH(this.L);b=b.qa("DIV",null,b.qa("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.Z+" when...")),b.qa("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.Z+" when...")},c,d),b.qa("DIV",{style:"padding: 5px"}),
b.qa("DIV","waffle-dialog-notifications-label","Notify me with..."),b.qa("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.oa();d=c.qa("DIV");this.O=CN("Save",c);this.Ta(this.O,!1);this.O.render(d);this.V=new Or("Cancel",c);this.Ta(this.V,!1);this.V.render(d);this.Aa=a.qa("DIV","waffle-dialog-notifications",a.qa("DIV",null,b),a.qa("DIV",null,d))};
q.Ja=function(){Vzc.$.Ja.call(this);this.getHandler().R(this.O,"action",this.jRb,!0).R(this.V,"action",v(this.dispatchEvent,this,new I("cancelRuleEdit"))).R(this.C,"change",this.lva).R(this.D,"change",this.lva)};q.Hf=function(a){Vzc.$.Hf.call(this,a);a?1==a.getType()?tT(this.C,this.F):2==a.getType()&&tT(this.C,this.J):tT(this.C,null);a?2==O(a,2)?tT(this.D,this.H):1==O(a,2)&&tT(this.D,this.L):tT(this.D,null);this.lva()};q.focus=function(){var a=uT(this.C),b=this.C.D.Gf(0);(a||b).getElement().focus()};
q.setVisible=function(a){this.getElement()&&S(this.getElement(),a)};q.jRb=function(){this.dispatchEvent(new I("saveRule",Wzc(this)))};function Wzc(a){var b=new Uzc,c=a.pb();c&&(c=O(c,1),P(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?P(b,2,1):a.H.isChecked()&&P(b,2,2);return b}q.lva=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.cb(a)};function tX(a,b){T.call(this,b);this.Hf(a)}x(tX,T);
tX.prototype.qa=function(){var a=this.pb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==O(a,2)?c+="send digest email":1==O(a,2)&&(c+="send email");var c="If "+(b+(" then "+c)),d=this.oa(),a=d.qa("TD",null),b=d.qa("TD",{width:"50px"}),c=d.qa("TR",{valign:"center"},d.qa("TD",null,d.qa("SPAN","waffle-notification-rule",c)),d.qa("TD",{align:"right"},d.qa("TABLE",null,d.qa("TBODY",null,d.qa("TR",null,a,b))))),d=Qp(Er,"waffle-notifications-add");this.D=new Gr("Edit",
d,this.oa());this.D.Sg("goog-link-button");this.D.Sg("menuMainLink");this.Ta(this.D,!1);this.D.render(a);this.C=new Gr("Delete",d,this.oa());this.C.Sg("goog-link-button");this.C.Sg("menuMainLink");this.Ta(this.C,!1);this.C.render(b);this.Aa=c};tX.prototype.Ja=function(){tX.$.Ja.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};tX.prototype.H=function(){this.dispatchEvent(new I("edit",this.pb()))};
tX.prototype.F=function(){var a=v(function(){this.dispatchEvent(new I("del",this.pb()))},this),b=v(function(){this.C.getElement().focus()},this);Nyc("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function Xzc(a){T.call(this,a);this.C=null}x(Xzc,T);Xzc.prototype.qa=function(){var a=this.oa();this.C=a.qa("TBODY");this.Aa=a.qa("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};Xzc.prototype.mc=g("C");Xzc.prototype.setVisible=function(a){this.getElement()&&S(this.getElement(),a)};function Yzc(a,b,c){qp.call(this);this.ma=a;this.L=b;rp(this,"Set notification rules");xp(this,!1);a=new yp;a.set("cancel","Done",!1,!0);Fp(this,a);this.C=new Vzc(c);this.Ta(this.C,!1);this.F=new Xzc;this.Ta(this.F,!1);this.J=new Gr("Add another notification rule",uI.getInstance(),this.oa());this.Ta(this.J,!1)}x(Yzc,qp);q=Yzc.prototype;
q.qa=function(){Yzc.$.qa.call(this);var a=this.oa(),b=M_a(this.ma,new yl(Hpa+"91588")).toString(),b=a.qa("A",{target:"_blank",href:b},"Help"),c=a.qa("DIV");this.J.render(c);this.V=a.qa("DIV");this.O=a.qa("DIV");var d=a.qa("DIV","waffle-dialog-notifications-bounds",this.V,this.O),b=a.qa("DIV",null,a.qa("DIV",{align:"right"},b),d,c);a.appendChild(this.mc(),b);mq(this,"")};
q.Ja=function(){Yzc.$.Ja.call(this);this.F.render(this.V);this.C.render(this.O);this.getHandler().R(this,"edit",this.DYb).R(this,"del",this.CYb).R(this.J,"action",this.BYb).R(this,"saveRule",this.iRb).R(this,"cancelRuleEdit",this.P5a)};q.W1=function(a){this.isDisposed()||(this.C.setVisible(!1),Zzc(this,!1),Qi(this.L,"/notifications/list",v(this.eVb,this,a)).rf())};
q.eVb=function(a,b,c){if(!this.isDisposed()){b=c.qg();c=[];for(var d=0;d<b.length;d++)c[d]=new Uzc(b[d]);this.Hf(c);if(a&&0==c.length)$zc(this,null,!1);else{if(a=this.pb())if(b=this.F,b.Rd(!0),b.oa().Rd(b.mc()),b.Hf(a),c=b.oa(),0==a.length)c.appendChild(b.mc(),c.qa("TR",null,c.qa("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ta(new tX(a[d],c),!0);Zzc(this,!0);this.focus()}}};
q.iRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();O(a,1)?Ti(Qi(this.L,"/notifications/set",v(this.W1,this,!1)),{rule:b}).rf():Ti(Qi(this.L,"/notifications/create",v(this.W1,this,!1)),{rule:b}).rf()};q.P5a=function(){this.C.setVisible(!1);this.W1(!1)};q.DYb=function(a){$zc(this,a?a.target:null,!0)};q.BYb=function(){$zc(this,null,!0)};function $zc(a,b,c){Zzc(a,!1);var d=a.C;d.Hf(b);d.setVisible(!0);c&&a.C.focus()}
q.CYb=function(a){this.F.setVisible(!1);a=a.target;Ti(Qi(this.L,"/notifications/delete",v(this.W1,this,!1)),{rule_id:O(a,1)}).rf()};function Zzc(a,b){a.F.setVisible(b);var c=vp(a);S(c,b);a.J.setVisible(b)}q.show=function(){this.setVisible(!0);this.W1(!0)};function aAc(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(U(a.e8a)+"</a>"),b=b+('<tr class="dialog-settings-general-settings-div"><div><span>'+c+"</span></div>");a.$Sb&&(b+='<div class="dialog-settings-english-name-div">'+U(Pq({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');return V(b+"</tr>")}
function bAc(){return V('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function uX(a,b,c,d){qp.call(this);this.jc=a;this.Hd=b;this.L=c;this.Vc=d;this.C={};this.Pb=this.Db=!1;this.Pc=this.Yb=this.Lb="";this.od=new qh;this.J=[];this.F=this.od.qd((new Bf).Fa(),ritz_api.RitzModelApi.getWorkbookProperties());rp(this,"Settings for this spreadsheet");this.Ab=!1;this.jb=new Qq;this.Ta(this.jb);this.V=new iS;this.Ta(this.V);this.O=new iS;this.Ta(this.O);this.Hb=new oT;this.Ta(this.Hb);this.Wa=this.qb=null;this.zc=new Lm(1);this.ma=this.va="";this.C[0]=jX();this.C[1]=jX();this.C[2]=
jX();this.C[3]=jX();this.C[4]=new WN;this.C[5]=new WN}x(uX,qp);var cAc=null,vX={w5:0,b3a:1,vYa:2,A0a:3,Q0a:4,sZa:5},dAc={y3a:"waffle-settings-dialog-english-name-checkbox",z3a:"waffle-settings-dialog-english-name-checkbox-label"},eAc=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],fAc=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];q=uX.prototype;
q.qa=function(){uX.$.qa.call(this);var a=this.mc(),b=this.oa(),c=[wX(b,"Locale","waffle-settings-label-locale"),xX(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),gAc(this),wX(b,"Time zone","waffle-settings-label-timezone"),xX(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
gAc(this)],d=[];d.push(wX(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(xX(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(gAc(this));d.push(wX(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=M_a(this.L,new yl(Hpa+"58515")).toString(),e=b.qa("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(xX(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=wX(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=xX(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");hAc(e);d.push(e);this.J.push(e);e=wX(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=xX(this,b,
"The threshold value such that calculation rounds stop when succesive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");hAc(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Tf().Va()&&iAc(this);d.push(gAc(this));c=Nb(c,d);c.push(vq(aAc,{e8a:this.Yb,$Sb:this.Ab}));this.qb=b.qa("TABLE","dialog-settings",b.qa("TBODY",null,c));this.Wa=b.qa("table","dialog-settings",b.qa("tbody",null,d));c=vq(bAc);b.appendChild(a,c);this.Hb.tb(c);b.appendChild(a,
this.qb);b.appendChild(a,this.Wa);S(this.Wa,!1);cAc||(a=new yp(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),cAc=a);Fp(this,cAc);yX(this,4,yc(this.F,3)&&B(this.F,3).oaa()?B(this.F,3).t9().toString():"50");yX(this,5,yc(this.F,3)&&B(this.F,3).laa()?B(this.F,3).d9().toString():"0.05");mq(this,"save")};function hAc(a){a=a.firstChild.firstChild;mo(a,"jfk-textinput");wo(a,"width","7em")}function iAc(a){for(var b=0;b<a.J.length;b++)S(a.J[b],!1)}
function wX(a,b,c){return a.qa("TR",null,a.qa("TD",{id:c,"class":"dialog-settings-label"},b))}function xX(a,b,c,d,e,f,h){b=b.qa("TR",null,b.qa("TD","dialog-settings-input"),b.qa("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Aa;go(a,"labelledby",e);go(a,"describedby",f);return b}function gAc(a){a=a.oa();return a.qa("TR",null,a.qa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.qa("HR",{"class":"dialog-settings-sep"})))}
q.Ja=function(){uX.$.Ja.call(this);cd(this,"dialogselect",v(this.TYb,this));this.getHandler().R(this.C[3],"action",this.nTb);this.getHandler().R(this.Hb,"select",this.CDb);var a=this.C[4].getElement();this.V.hk(a);lS(this.V,a,a);this.V.render();kS(this.V);this.getHandler().R(a,"change",v(this.EVb,this));a=this.C[5].getElement();this.O.hk(a);lS(this.O,a);this.O.render();kS(this.O);this.getHandler().R(a,"change",v(this.DVb,this));if(this.Ab){var a=this.oa().getElement(dAc.y3a),b=this.oa().getElement(dAc.z3a);
this.jb.tb(a);yq(this.jb,b);this.jb.Cc(!rqa||I_a(this.L.H))}};q.setVisible=function(a){if(a){if(!this.Db){jAc(this);return}var b=this.L.L;yX(this,0,b.C);b=b.D||Nrb().name();yX(this,1,b);yX(this,2,yc(this.F,3)&&B(this.F,3).woa()?B(this.F,3).ela().toString():"");yX(this,3,yc(this.F,3)&&yc(B(this.F,3),1)?B(B(this.F,3),1)?"ON":"OFF":"OFF")}uX.$.setVisible.call(this,a);if(this.Db&&!this.Pb){if(a=Jk("ds-settings-link"))a.href=this.Lb;this.Pb=!0}};
function jAc(a){Si(a.Hd.Zf("/info/settings").zg(kAc()),v(function(a){a=a.qg();(a={locale:a.l?this.pL(a.l):null,OVa:a.tz?this.pL(a.tz):null,m8a:a.dls,vIb:a.dln,BVb:a.hl},a.locale)&&a.OVa&&(lAc(this,0,a.locale),lAc(this,1,a.OVa),lAc(this,2,eAc),lAc(this,3,fAc),this.Lb=a.m8a,this.Yb=a.vIb,this.Pc=a.BVb,this.Ab=rqa&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Pc),this.Db=!0);this.setVisible(!0)},a)).rf()}
function kAc(){var a=Kl(hm("win").location.href),b=Il(a,"hl"),a=Il(a,"forcehl");return["hl",b,"forcehl",a]}function lAc(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d],e=new eq(e.caption,e.value);a.cf(e);fo(e.getElement(),"menuitem")}a.Tc().getElement().style.overflow="auto";yN(a,!0)}q.pL=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function yX(a,b,c){(a=a.C[b])&&a.mb(c)}
q.TYb=function(a){if("save"==a.key)if("ON"!=this.C[3].Tf().Va()||""==this.va&&""==this.ma){mAc(this);a=this.L.L.C;this.jc.C(nAc(this));this.jc.C(oAc(this));var b;if(this.Ab){var c=!rqa||I_a(this.L.H);b=this.jb.isChecked();c!=b?(Q_a(this.L,b),c=Rn(new Qn,1).build(),this.Vc.vc(b?2433:2434,c),b=!0):b=!1}else b=!1;b||(b=this.C[0].Tf(),b=null!=b&&b.Va()!=a);b&&WCa(this.L.D.C,this.SYb)}else a.preventDefault(),mAc(this),""!=this.va&&jS(this.V,this.va,!0),""!=this.ma&&jS(this.O,this.ma,!0)};
q.nTb=function(a){if("ON"==a.target.Va())for(a=0;a<this.J.length;a++)S(this.J[a],!0);else iAc(this);mAc(this)};function mAc(a){kS(a.V);kS(a.O)}q.EVb=function(){this.va="";var a=this.C[4].Va()||"",a=this.zc.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.va="Please enter an integer value.";else if(0>=a||1E4<a)this.va="Please enter a value between 1 and 10000."};q.DVb=function(){this.ma="";var a=this.C[5].Va()||"",a=this.zc.parse(a);isNaN(a)?this.ma="Please enter a numeric value.":0>a&&(this.ma="Please enter a non-negative value.")};
q.CDb=function(a){switch(a.target.getId()){case "general-settings-tab":S(this.qb,!0);S(this.Wa,!1);break;case "calculation-settings-tab":S(this.qb,!1),S(this.Wa,!0)}};function nAc(a){var b=a.C,c=b[vX.vYa].Tf().Va(),d=b[vX.A0a].Tf().Va();a=b[vX.Q0a].Va()||"";var b=b[vX.sZa].Va()||"",e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new EJ(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function oAc(a){var b=a.C;a=a.L.L;var c=b[vX.w5].Tf(),c=null==c?a.C:c.Va(),b=b[vX.b3a].Tf(),b=null==b?a.D||Nrb().name():b.Va();return new hrb(c,b)}q.SYb=function(){(new usb).exec()};q.xa=function(){ac(this.C,H);delete this.C;uX.$.xa.call(this)};function zX(a,b,c,d,e,f,h){qp.call(this,void 0,!1,h);this.J=this.F=this.O=this.L=null;this.ma=a;this.Re=b;this.C=[];this.V=new J3b(a,d,e,f)}x(zX,qp);var pAc=null;q=zX.prototype;
q.qa=function(){zX.$.qa.call(this);var a=this.oa(),b=this.Re.cd(),c=Wu(b.$e()),d=Wu(new L(b.left+b.width-1,b.top+b.height-1));rp(this,"Sort range from "+(c+(" to "+d)));pAc||(c=new yp,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),pAc=c);Fp(this,pAc);mq(this,"save");var e,c=a.qa("DIV",{style:"overflow: hidden"},d=a.qa("SPAN","jfk-checkbox"),e=a.qa("SPAN",{style:"cursor: default"},"Data has header row")),f=this.J=new Qq(void 0,a);f.tb(d);yq(f,e);1==b.height&&f.cb(!1);Ku(this.ma,this.Re.Fc(),b)||
(f.Cc(!0),f.cb(!1));b=this.mc();a.appendChild(b,c);this.L=a.qa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.qa("TABLE",{cellSpacing:"0"},this.O=a.qa("TBODY")));a.appendChild(b,this.L);c=qAc(this);this.C.push(c);c=a.qa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(b,c);kl(c,!0);fo(c,"button");this.F=c};q.Ja=function(){zX.$.Ja.call(this);this.getHandler().R(this,"dialogselect",this.tZb).Ei(this.F,gd,this.skb).R(this.J,"change",this.Ksb)};
function qAc(a){var b=a.oa(),c=0==a.C.length,d=new AX(a,c,a.Re,0,b),e=b.qa("TR",null,b.qa("TD",{colspan:"4"},b.qa("DIV","waffle-sd-row-separator")));d.render(a.O);b.appendChild(a.O,e);c||a.getHandler().Ei(d.D,gd,v(a.G7a,a,d));a=rAc(a);sAc(d,a);return d}q.G7a=function(a){var b=this.C;if(1<b.length){var c=tb(b,a);-1!=c&&(Mb(b,c),b=a.getElement(),b=dl(b),a.dispose(),$k(b),S(this.F,!0),this.F.focus(),Em("Sort criteria removed."))}};
function rAc(a){var b=a.Re.cd(),c=b.yc(),b=b.dd(),d=wb(a.C,function(a){return a.Mq()},a);if(d)for(var e=EA(a.Re,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=GA(a.Re,f);if(!Db(d,h))return h}return null}q.Ksb=function(){for(var a=this.C,b=0;b<a.length;b++)sAc(a[b])};q.skb=function(){var a=jh(this.Re.cd(),"c"),a=Math.max(10,a);this.C.length<a&&(this.C.push(qAc(this)),Em("Sort criteria added."));Ko(sb(this.C).getElement(),this.L,!0);this.L.scrollLeft=0;this.C.length>=a&&S(this.F,!1)};
q.tZb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.C,d=0;d<c.length;d++){var e=c[d];a.push(e.Mq());e=e.F.isChecked();b.push(e?1:0)}c=this.Re.cd();d=jh(c,"r");if(this.J.isChecked()&&1<d){var d=c.Bc()+1,e=c.yc(),f=c.Xc(),h=c.dd();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new P3b(a,b,this.Re,c,this.J.isChecked());K3b(this.V,this.Re,a)}};q.xa=function(){zX.$.xa.call(this);Hc(this.C)};
function AX(a,b,c,d,e){T.call(this,e);this.H=this.J=this.F=this.C=this.D=null;this.O=-1;this.V=a;this.L=b;this.Re=c}x(AX,T);AX.prototype.Mq=function(){var a=this.C.Tf();return a?a.Va():-1};
AX.prototype.qa=function(){var a=this.oa(),b=this.L?"sort by":"then by",c,d,e,f=a.qa("TR","waffle-sd-tr-rules",a.qa("TD","waffle-sd-delete",this.L?"":this.D=a.qa("SPAN",{title:"Remove sort criteria."},"x")),a.qa("TD","waffle-sd-td-rules",a.qa("LABEL",{id:jp(this,"csl")},b)),b=a.qa("TD","waffle-sd-column-selector"),a.qa("TD","waffle-sd-td-ascending",e=a.qa("DIV",null,c=a.qa("DIV",{title:"Ascending"}),d=a.qa("DIV",{title:"Descending"}))));fo(e,"radiogroup");e=this.F=new qT(a,vl(a,pm(ju(!0,this.Vf()))),
"ascending");e.render(c);a=this.J=new qT(a,vl(a,pm(ju(!1,this.Vf()))),"descending");a.render(d);this.H=new sT([e,a]);tT(this.H,e);a=this.C=jX();a.render(b);go(a.getElement(),"label",this.L?"Select first column to sort by:":"Select next column to sort by:");this.D&&(kl(this.D,!0),fo(this.D,"button"),jo(this.D,"Remove sort criteria."));this.Aa=f};
function sAc(a,b){var c=a.oa(),d=a.V.J.isChecked(),e=a.Re.cd(),f=e.Bc(),h=e.yc(),e=e.dd();a.O=b||a.Mq();for(b=a.C.ql();0<b;b--)a.C.nG(0);for(;h<e;h++)b=cb(Nz(a.Re.Pf(f,h)),15),b=new eq(Ua(b)||!d?"Column "+Pu(h):b,GA(a.Re,h),c),a.C.cf(b);a.C.Qf(0);0<=a.O&&a.C.mb(a.O)}AX.prototype.xa=function(){AX.$.xa.call(this);this.C=this.D=this.Re=this.V=null;H(this.F);H(this.J);H(this.H);this.H=this.J=this.F=null};function tAc(){E.call(this)}x(tAc,sm);q=tAc.prototype;q.Ffb=function(){return Lyc};q.Vfb=function(){return Nyc};q.JJb=function(a,b,c,d){var e=new oq;a=new lq(a,b,c,d,void 0,!0,void 0);mq(a,"ok");b=v(e.tb,e);a.epa=b;F(a,e);a.Kj=!0;a.eea=Efa(Ua);return a};q.Ahb=function(){return Szc};q.p7a=function(a,b,c,d,e){return new zX(a,b,0,c,d,e,void 0)};q.cgb=function(){return lzc};q.cIa=function(){return rzc};q.ugb=function(){return Bzc};q.m7a=function(a,b,c,d){return new Kzc(a,b,c,d,sa,void 0)};q.Ihb=function(){return uX};
q.Hhb=function(){return Jyc};q.Ghb=function(){return Yzc};q.Yfb=function(){return YW};q.Ehb=function(){return kxc};q.Fhb=function(){return Jxc};zm("dialogs",tAc);
