fT.prototype.Usa=ea(206,function(a){this.L=Qb(arguments,0)});fmb.prototype.Jca=ea(186,function(a,b,c){var d=this.Zd();a=d.yg(new Pg(0,b.Bc()),"r",!1,!1,!0,!0);var e=d.yg(new Pg(b.Bc(),b.Xc()),"r",!1,!1,!0,!0),f=d.yg(new Pg(0,b.yc()),"c",!1,!1,!0,!0);b=d.yg(new Pg(b.yc(),b.dd()),"c",!1,!1,!0,!0);c||(--e,--b);c=aD;ritz_api.GridViewApi.renderGridView(this.C,f/c,a/c,b/c,e/c,0,0,new OJ(this.H),null)});cK.prototype.Jca=ea(185,ba());cf.prototype.Dx=ea(26,function(){return yc(this,3)});
function LU(a,b){return B(a,2,b)}function slc(a,b){D(a,3,b)}function tlc(a,b,c,d,e){return Mvb(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function MU(a){Ci(this,a,0,-1,null)}x(MU,Bi);function NU(a){Ci(this,a,0,-1,null)}x(NU,Bi);
function ulc(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),f=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;f.push(new $g(m,k,m+b,k+c))}return f}var vlc=[1],wlc=[1],xlc=[1],ylc=[1,2],zlc=[2];function Alc(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function Blc(a){return lc(Rjc,function(b){return b.match(a)}).getName()}function Clc(a){Ci(this,a,0,-1,null)}x(Clc,Bi);
Clc.prototype.hg=function(){return O(this,2)};function Dlc(a){Ci(this,a,0,-1,null)}x(Dlc,Bi);function Elc(a){Ci(this,a,0,-1,null)}x(Elc,Bi);function Flc(a){Ci(this,a,0,-1,null)}x(Flc,Bi);Flc.prototype.getChartType=function(){return O(this,1)};function Glc(a){Ci(this,a,0,-1,vlc)}x(Glc,Bi);function Hlc(a){Ci(this,a,0,-1,wlc)}x(Hlc,Bi);function Ilc(a){Ci(this,a,0,-1,xlc)}x(Ilc,Bi);function Jlc(a){Ci(this,a,0,-1,ylc)}x(Jlc,Bi);var Klc={gvc:0,wAa:1,VAa:2};function Llc(a){Ci(this,a,0,-1,zlc)}x(Llc,Bi);
var Mlc={UNKNOWN_ERROR:0,Dvc:1,Tmc:2,n$b:3},Nlc={svc:0,C$b:1,Qea:2,vk:3,lvc:4,o2b:5,Vac:6},Olc={qvc:0,bE:1,Zmc:2,Gmc:3,hpc:4},Plc={mvc:0,Vmc:1,NJ:2,lkc:3},Qlc={evc:0,Quc:1,xdc:2,Utc:3,Ttc:4,f5b:5,Xkc:6},Rlc={Zsc:0,PJ:1,hZa:2,Muc:3,Mrc:4,B1a:5,Cvc:6,aya:7,Vva:8,Cwa:9,HISTOGRAM:10},Slc={UNKNOWN:0,f2b:1,e2b:2,d2b:3,k3b:4,P4b:5,$4b:6,v8b:7,cac:8,Dlc:9,tpc:10,Apc:11,ktc:12,ltc:13,wuc:14};function OU(){A.call(this)}x(OU,A);var Tlc=null;OU.prototype.Bm=function(){return B(this,1)};function PU(){A.call(this)}x(PU,A);var Ulc=null;PU.prototype.getText=function(){return B(this,1)};PU.prototype.Ur=function(){return yc(this,1)};function QU(){A.call(this)}x(QU,A);var Vlc=null;QU.prototype.getStatus=function(){return B(this,1)};QU.prototype.getError=function(){return B(this,9)};function RU(){A.call(this)}x(RU,A);var Wlc=null;function SU(){A.call(this)}x(SU,A);var Xlc=null;
function TU(){A.call(this)}x(TU,A);var Ylc=null;TU.prototype.qaa=function(){return yc(this,1)};TU.prototype.getType=function(){return B(this,3)};TU.prototype.setType=function(a){D(this,3,a)};OU.prototype.Fa=function(){var a=Tlc;a||(Tlc=a=Fc(OU,{0:{name:"Error",Mb:"ritz.assistant.Error"},1:{name:"message",Ca:9,type:String},2:{name:"code",Ca:14,defaultValue:0,type:Mlc},3:{name:"unsupported_op_reason",Ca:14,defaultValue:0,type:Nlc}}));return a};OU.Fa=OU.prototype.Fa;
PU.prototype.Fa=function(){var a=Ulc;a||(Ulc=a=Fc(PU,{0:{name:"AnswerQueryPhrase",Mb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ca:9,type:String},2:{name:"start_byte",Ca:5,type:Number},3:{name:"num_bytes",Ca:5,type:Number}}));return a};PU.Fa=PU.prototype.Fa;
QU.prototype.Fa=function(){var a=Vlc;a||(Vlc=a=Fc(QU,{0:{name:"AnswerResponse",Mb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ca:5,type:Number},10:{name:"parse_status",Ca:14,defaultValue:0,type:Olc},11:{name:"answer_status",Ca:14,defaultValue:0,type:Plc},2:{name:"formula",Ca:9,type:String},3:{name:"debug_parse_response",Ca:9,type:String},4:{name:"interpretation",Ca:9,type:String},5:{name:"debug_interpretation_response",Ca:9,type:String},6:{name:"unused_phrase",fd:!0,Ca:11,type:PU},7:{name:"used_entity_phrase",
fd:!0,Ca:11,type:PU},8:{name:"unused_entity_phrase",fd:!0,Ca:11,type:PU},9:{name:"error",Ca:11,type:OU},12:{name:"alternate_suggestion",fd:!0,Ca:11,type:TU},14:{name:"deprecated_formula_builder_used",Ca:9,type:String},15:{name:"answer_visualization_type",fd:!0,Ca:14,defaultValue:0,type:Rlc},16:{name:"formula_builder_used",Ca:14,defaultValue:0,type:Slc},17:{name:"charting_info",Ca:11,type:SU},18:{name:"answer_field_info",fd:!0,Ca:11,type:RU},19:{name:"charting_formula",Ca:9,type:String}}));return a};
QU.Fa=QU.prototype.Fa;RU.prototype.Fa=function(){var a=Wlc;a||(Wlc=a=Fc(RU,{0:{name:"AnswerFieldInfo",Mb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ca:14,defaultValue:0,type:Aea}}));return a};RU.Fa=RU.prototype.Fa;
SU.prototype.Fa=function(){var a=Xlc;a||(Xlc=a=Fc(SU,{0:{name:"ChartingInfo",Mb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",fd:!0,Ca:14,defaultValue:0,type:Rlc},2:{name:"recommended",Ca:8,type:Boolean},3:{name:"user_requested_type",fd:!0,Ca:14,defaultValue:0,type:Rlc},4:{name:"show_only_chart",Ca:8,type:Boolean}}));return a};SU.Fa=SU.prototype.Fa;
TU.prototype.Fa=function(){var a=Ylc;a||(Ylc=a=Fc(TU,{0:{name:"QuerySuggestion",Mb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ca:9,type:String},2:{name:"formula",Ca:9,type:String},3:{name:"type",Ca:14,defaultValue:0,type:Qlc},4:{name:"deprecated_formula_builder_used",Ca:9,type:String},5:{name:"formula_builder_used",Ca:14,defaultValue:0,type:Slc}}));return a};TU.Fa=TU.prototype.Fa;function UU(a,b,c,d,e,f){I.call(this,a,b);this.C=b;this.Ga=c;this.Ea=d||null;this.Wa=e||null;this.F=f||null}x(UU,I);UU.prototype.Bk=g("Ga");UU.prototype.$e=g("Ea");function Zlc(a,b,c,d,e,f){UU.call(this,"Re",null,d,e,f);this.V=a;this.ma=b;this.Hc=c}x(Zlc,UU);Zlc.prototype.De=g("Hc");function $lc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(Nr({Je:"waffle-assistant-section-more-button",content:Gq("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function VU(a,b,c){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Wa(b),Mr(a,b,void 0),ngc(a),a.setAttribute("data-tooltip-delay",500),STb(a,t(c)?c:1))};function amc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function bmc(){var a=V,b;b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(amc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function cmc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(Nr({Je:"waffle-assistant-panel-back-button",content:Gq(""+U(it({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function WU(a){T.call(this,a);this.Vc=new tU(!1,"#4285f4");this.Ta(this.Vc);this.O=new T(this.oa());this.Ta(this.O);this.C=[];this.Ge=this.jf=!1;this.Hd=this.od=this.Ab=this.ea=null;this.Yb=new Or("",a,4);aq(this.Yb,2);this.Ta(this.Yb)}x(WU,T);var dmc={defaultHelpArticleId:"6280499"};q=WU.prototype;q.qa=function(){WU.$.qa.call(this);this.Aa=vq(bmc);this.od=this.kb("waffle-assistant-panel-content-container");this.Hd=this.kb("waffle-assistant-empty-list")};
q.Ja=function(){WU.$.Ja.call(this);var a=this.kb("waffle-assistant-spinner-container");this.Vc.render(a);this.O.tb(this.kb("waffle-assistant-panel-card-holder"));this.Yb.tb(this.kb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Yb,"action",this.n_b).R(this.Aa,"scroll",wgc(this.uXa,10,this))};q.setVisible=function(a){var b=this;S(this.Aa,a);z(this.C,function(a){if(!a.Dc()){var c=b.O.Cd();a.V=c;b.O.Ta(a,!0);a.hF()}});this.jf=a};
q.hsa=function(a,b){var c=this.oa();this.ea&&this.M7();this.ea=new T;this.Ta(this.ea);a=sq(a,cmc,{title:b});this.Ab=new Or("",this.oa());this.ea.Ta(this.Ab);this.Ab.tb(c.kb("waffle-assistant-panel-back-button",a));VU(this.Ab.Aa,"Back");this.ea.getHandler().R(this.Ab,"action",this.Blb)};q.M7=function(){this.ea.dispose();this.ea=null};function emc(a,b){a.Vc.setActive(b);S(a.kb("waffle-assistant-panel-pane"),!b)}q.dI=function(a){S(this.Hd,a);S(this.od,!a)};
function fmc(a,b){Lb(a.C,b);a.O.removeChild(b);a.O.Hi(b,0);a.C.push(b)}q.LH=function(a){Lb(this.C,a);-1!=mp(this.O,a)&&this.O.removeChild(a,!0)};q.h7=function(){this.O.Rd(!0);Hc(this.C);this.C=[]};q.uXa=function(){for(var a=this.Aa,a=a.scrollTop+Qo(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(XU(d,!0),b+=Qo(d.Aa).height):XU(d,!1)}};q.qf=function(a){this.Ge=a;z(this.C,function(b){b.qf(a)})};q.Pd=g("Ge");q.n_b=function(){Q.Rn.Qc(dmc)};q.Blb=function(){this.dispatchEvent("Oe")};function YU(a,b,c,d){T.call(this,d);this.Z=a;this.jb=b;this.ea=new Or("",this.oa());this.Ta(this.ea);this.H=new T(this.oa());this.Ta(this.H);this.C=null;this.Wa=[];this.Ua=this.Ga=!1;this.V=c}x(YU,T);q=YU.prototype;q.CNa=Hf;q.rta=If;q.qa=function(){YU.$.qa.call(this);this.Aa=vq($lc,{title:this.cW()})};
q.Ja=function(){YU.$.Ja.call(this);this.H.tb(this.kb("waffle-assistant-section-card-holder"));this.ea.tb(this.kb("waffle-assistant-section-more-button"));this.getHandler().R(this.ea,"action",this.lwb);this.C=this.xDa();F(this,this.C);S(gmc(this),this.CNa());this.setVisible(!1)};q.setVisible=function(a){if(this.Dc()&&this.sb()!=a&&(S(this.Aa,a),a)){S(this.ea.Aa,this.KUa());a=new Dlc;P(a,4,this.sea());var b=new dn;Ii(b,58,a);a=Sn(Rn(new Qn,10),b).build();this.V.vc(2774,a)}};
q.sb=function(){return this.Dc()&&To(this.Aa)};q.KUa=function(){return this.Wa.length>this.Z};q.xDa=function(){return new WU(this.oa())};q.qf=function(a){this.Ua=a;z(hmc(this),function(b){b.qf(a)});this.C.qf(a)};q.Pd=g("Ua");q.Ah=sa;
q.rva=function(a){this.Wa=a;for(var b=0;b<a.length;b++){Ec(a[b],1);if(this.H.Cd()<this.Z){var c=this.HZ(a[b]);c.qf(this.Ua);var d=this.H.Cd();c.V=d;this.H.Ta(c,!0)}if(this.rta()&&(this.C.dI(!1),c=this.C,d=this.HZ(a[b]),c.C.push(d),c.jf)){emc(c,!1);var e=c.O.Cd();d.V=e;c.O.Ta(d,!0);d.hF()}}};function hmc(a){var b=[];a.H.og(function(a){b.push(a)});return b}function gmc(a){return a.kb("waffle-assistant-section-content")}q.zoa=function(){return this.H.jaa()};
q.bW=function(){this.Wa=[];Hc(this.H.Rd(!0));this.setVisible(!1);this.rta()&&(this.C.h7(),this.C.dI(!0))};function imc(a){a.H.og(function(a,c){c<this.Z&&a.hF()},a)}q.n4=function(a){var b=0;if(this.Ga)this.C.uXa();else if(this.zoa()){this.setVisible(!0);for(var b=Qo(this.kb("waffle-assistant-section-header")).height+Qo(gmc(this)).height,c=hmc(this),d=0;d<c.length;d++)b<a&&d<this.Z?(this.NKa(c[d]),XU(c[d],!0),b+=Qo(c[d].Aa).height):XU(c[d],!1)}else this.setVisible(!1);return a-b};q.NKa=sa;
q.setActive=function(a){(this.Ga=a)||this.C.M7()};q.tc=g("Ga");function jmc(a,b){a.C.hsa(b,a.cW())}q.lwb=function(){this.setActive(!0);this.dispatchEvent("Te")};function kmc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Xl?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Xl?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function ZU(){}x(ZU,uI);ta(ZU);ZU.prototype.Nc=n("waffle-assistant-link-button");function lmc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function mmc(a,b){T.call(this,b);this.D=a;this.C=new Gr("",new ZU,this.oa());this.Ta(this.C)}x(mmc,T);q=mmc.prototype;q.qa=function(){this.Aa=vq(lmc)};q.Ja=function(){mmc.$.Ja.call(this);var a=this.kb("waffle-assistant-feedback-card-link");this.C.tb(a);this.getHandler().R(this.Aa,"mousedown",this.Lg).R(this.C,"action",this.erb);this.show(!1)};q.Lg=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Aa,c=this.kb("waffle-assistant-feedback-card-link");to(b,"waffle-assistant-feedback-card-hidden",!a);kl(c,a)};q.erb=function(){Q.Cy.Qc({source:this.D});this.show(!1);this.dispatchEvent(new I("feedback-dialog-opened"))};function $U(){}x($U,Er);ta($U);$U.prototype.Nc=n("waffle-assistant-button");function nmc(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(it({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(it({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function aV(a){T.call(this,a);this.C=new Gr("",new $U,this.oa());this.Ta(this.C);this.D=new Gr("",new $U,this.oa());this.Ta(this.D)}x(aV,T);aV.prototype.qa=function(){this.Aa=vq(nmc)};aV.prototype.Ja=function(){aV.$.Ja.call(this);var a=this.kb("waffle-assistant-thumbs-down-button");this.C.tb(a);VU(a,"Not useful");a=this.kb("waffle-assistant-thumbs-up-button");this.D.tb(a);VU(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function omc(a,b){a.oa().Uf(a.kb("waffle-assistant-thumbs-text"),b)}aV.prototype.F=function(){this.dispatchEvent(new I("thumbs-down"));S(this.Aa,!1)};aV.prototype.H=function(){this.dispatchEvent(new I("thumbs-up"));S(this.Aa,!1)};function bV(a,b){T.call(this,b);this.D=a;this.O=this.L=this.V=null;this.qb=new tU(!0,"#4285f4");this.Ta(this.qb);this.Ab=this.Pb=this.Pc=!1;this.ea=null;this.Hd=this.Lb=!1}x(bV,T);q=bV.prototype;q.QOa=Hf;q.LD=Hf;q.saa=If;q.dG=Jf;q.cG=Jf;q.O9=Jf;q.Vla=Jf;q.Ula=Jf;q.qf=ca("Hd");q.Pd=g("Hd");q.R$=sa;q.qa=function(){this.Aa=vq(kmc)};
q.Ja=function(){bV.$.Ja.call(this);var a=this.kb("waffle-assistant-card-spinner-container");this.qb.render(a);wo(this.kb("waffle-assistant-card-inner"),"visibility","hidden");if(this.LD()){var a=this.Aa,b=new hp(a);F(this,b);this.getHandler().R(b,"focusin",this.emb).R(b,"focusout",this.dmb).R(a,"mouseenter",this.coa).R(a,"mouseleave",this.Y$)}pmc(this,!1);Xl&&(this.O=new mmc(this.zz(),this.oa()),this.O.render(this.kb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.O,"feedback-dialog-opened",
this.frb).R(this,"trigger_feedback",this.UUb),this.saa()?(this.L=new aV(this.oa()),this.L.render(this.kb("waffle-assistant-thumbs-container")),qmc(this,!0),a=ib(this.O9()),Ua(a)||omc(this.L,a),a=ib(this.Vla()),Ua(a)||VU(this.L.kb("waffle-assistant-thumbs-up-button"),a),a=ib(this.Ula()),Ua(a)||VU(this.L.kb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.L,"thumbs-down",this.l_b).R(this.L,"thumbs-up",this.m_b)):qmc(this,!1));this.zA()};
function cV(a){return a.kb("waffle-assistant-card-content-container")}function rmc(a){a.LD();return a.kb("waffle-assistant-card-options")}function qmc(a,b){Xl&&S(a.kb("waffle-assistant-thumbs-container"),a.saa()&&b)}q.hF=function(){this.isDisposed()||(this.Pc=!0,smc(this))};function XU(a,b){!a.Pb&&b&&(a.Pb=!0,smc(a))}function smc(a){if(a.Pc&&a.Pb){var b=v(a.k_b,a);a.JA(b)}}q.coa=function(){this.Ab||(pmc(this,!0),this.Ab=!0,fk(this.ea),this.ea=ek(this.ICa,100,this))};
q.ICa=function(){this.isDisposed()||(fk(this.ea),this.ea=null,this.Aa.parentNode.querySelector(":hover")==this.Aa?this.ea=ek(this.ICa,100,this):this.Y$())};q.Y$=function(){pmc(this,!1);this.Ab=!1};q.emb=function(){pmc(this,!0)};q.dmb=function(){ek(function(){this.isDisposed()||gl(this.Aa,document.activeElement)||this.Aa.parentNode.querySelector(":hover")==this.Aa||pmc(this,!1)},0,this)};q.l_b=function(){tmc(this,!0);qmc(this,!1);var a=this.cG();this.dispatchEvent(new UU("Ve",this,a))};
q.m_b=function(){qmc(this,!1);var a=this.dG();this.dispatchEvent(new UU("Ve",this,a))};q.frb=function(){tmc(this,!1)};q.UUb=function(){tmc(this,!0)};function pmc(a,b){var c=a.kb("waffle-assistant-card-options");a=a.LD();S(c,a&&b)}q.k_b=function(){this.qb.setActive(!1);S(this.qb.Aa,!1);wo(this.kb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new I("content-rendered"))};
function tmc(a,b){to(a.kb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.O.show(b)};var umc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function vmc(a){var b=new cC(sc(umc));return Ygc(a,b)}
function wmc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.qc("useFirstColumnAsDomain")&&a.De()&&"number"===a.De().vd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.qc("useFirstColumnAsDomain")&&a.De()&&"string"===a.De().vd(0)){var c=0,d=Sk("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.De().getNumberOfRows();b++)il(d,a.De().Yf(b,0)),c=Math.max(c,Xo(d).width);$k(d);c=Math.min(27,Math.max(15,10+100*c/271))}a.setOption("chartArea.top","15%");b=a.qc("hAxis.title");a.setOption("chartArea.height",Ua(ib(b))?"80%":"65%");a.setOption("chartArea.left",c+"%");a.setOption("chartArea.width",95-c+"%");
"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ua(ib(a.qc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10));return a};function xmc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function ymc(){return V(U(Nr({Je:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Gq(""+U(it({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(Nr({Je:"waffle-assistant-zoom-button",content:Gq(""+U(it({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function zmc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.A6a)+"</span>"),d=0==a.MGa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.MGa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Xl?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Amc(a,b,c,d,e,f,h){T.call(this,h);this.H=a;this.D=b;this.L=e;this.F=f;this.C=this.Hc=null;this.J=Rn(new Qn,10).build()}x(Amc,T);q=Amc.prototype;q.Ja=function(){Amc.$.Ja.call(this);(new WS(rC,this.D.Nf)).send(v(this.Aob,this,this.D))};q.R$=function(a,b){a=new Zlc(this.H.clone(),this.L,this.Hc,2746,a,b);this.dispatchEvent(a)};q.Aob=function(a,b){b&&(b.Di()?RB.sB(this.Aa,b):(b=b.De(),a.ye(b),cU(a,b),SB(a,"ready",v(this.b_b,this,a)),nU(a,this.Aa,this.F,em),this.Hc=b))};
q.b_b=function(a){a.Dm()&&(SB(a.Dm(),"onmouseover",v(this.$Zb,this)),SB(a.Dm(),"onmouseout",v(this.a_b,this)))};q.$Zb=function(){this.C=Ia()};q.a_b=function(){Da(this.C)&&500<Ia()-this.C&&this.F.vc(2750,this.J);this.C=null};function Bmc(a,b,c,d,e){T.call(this,e);this.J=a;this.Ga=b;this.va=c;this.O=d;this.L=Dc(this.J,23);this.Ea=B(this.J,22);this.D=B(this.J,26);this.ma=[];this.Ke=new qh;this.V=this.F=this.C=null;this.Z=!1;this.ea=new Or("",this.oa());this.Ta(this.ea);this.H=null}x(Bmc,T);q=Bmc.prototype;q.qa=function(){Bmc.$.qa.call(this);this.Aa=vq(zmc,{A6a:this.D,MGa:this.L});this.Aa.style.visibility="hidden"};
q.Ja=function(){Bmc.$.Ja.call(this);var a=this.kb("waffle-assistant-facet-toggle");this.ea.tb(a);this.getHandler().R(this.Aa,"mousedown",this.Lg).R(this.ea,"action",this.YDb);Xl&&(this.V=new mmc("assistantAutovisFacetFeedback",this.oa()),this.V.render(this.kb("waffle-assistant-facet-feedback-container")),this.C=new aV(this.oa()),this.Ta(this.C),this.C.render(this.kb("waffle-assistant-facet-thumbs-container")),omc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.ZZb).R(this.C,"thumbs-down",this.YZb));Cmc(this,Iqa)};q.Pd=g("Z");q.qf=function(a){this.Z=a;Dmc(this)};q.Lg=function(a){a.stopPropagation()};q.YDb=function(){var a=lo(this.kb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Cmc(this,a);Emc(this,a?2647:2646)};
function Cmc(a,b){var c=a.kb("waffle-assistant-facet-toggle");il(c,b?"HIDE":"SHOW");to(a.kb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.ij("waffle-assistant-faceted-chart"),function(a){kl(a,b)});a.C&&S(a.C.Aa,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');VU(c,b?a:d)}
function Fmc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Gmc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Dmc(a){a.O&&!a.Z&&z(a.ma,v(function(a){var b=a.Aa;if(!this.O.contains(b)){var d=this.O;a=new Hmc(b,a);glb(d,a)}},a))}q.ZZb=function(){Emc(this,2649)};q.YZb=function(){Emc(this,2648);this.V.show(!0)};function Emc(a,b){var c=a.va,d=new kU,e=a.H.getChartType();d.D=e;e=a.H.De();d.F=e?e.clone():null;$jc(c,b,d,10,a.H,a.H.Nf)};function dV(a,b,c,d,e,f){bV.call(this,a,f);this.C=B(a,8);this.od=b;this.Vc=c;this.H=d;this.jb=e;this.Z=new Or("",this.oa());this.Ta(this.Z);this.va=new Or("",this.oa());this.Ta(this.va);this.Ke=new qh;this.zc=null;this.Ua=!1;this.jc=[];this.Yb=[];this.Hb=[];this.Wa=this.Ga=this.F=this.J=this.Ea=null;this.ma=Rn(new Qn,10).build()}x(dV,bV);
var eV={hYa:"waffle-assistant-after-chart-preview",CYa:"waffle-assistant-before-chart-preview",PYa:"waffle-assistant-card-draggable",k5:"waffle-assistant-chart-highlights",t0a:"waffle-assistant-insert-chart-button",Xfa:"waffle-assistant-chart-preview",o2a:"waffle-assistant-button-separator",M2a:"waffle-assistant-styled-border",N2a:"waffle-assistant-styled-rect",M3a:"waffle-assistant-zoom-button"};q=dV.prototype;q.JA=function(a){this.zc=a;Imc(this)};
q.zA=function(){Jmc(this,v(function(a){a=ekc(this.od,a);jo(this.Aa,a)},this),!1)};q.QOa=If;q.LD=If;q.zz=n("autovisFeedback");q.dG=n(2208);q.cG=n(2207);q.O9=n("Was this chart useful?");q.qa=function(){dV.$.qa.call(this);cV(this).appendChild(vq(xmc));rmc(this).appendChild(vq(ymc));yc(this.C,22)&&(this.F=new Bmc(this.C,this.V,this.H,this.jb,this.oa()),this.Ta(this.F,!0),this.F.qf(this.Pd()))};
q.Ja=function(){dV.$.Ja.call(this);mo(this.Aa,eV.PYa);var a=this.kb(eV.t0a);this.Z.tb(a);VU(a,"Insert chart");a=this.kb(eV.M3a);this.va.tb(a);VU(a,"View full size");var a=this.kb(eV.CYa),b=this.kb(eV.Xfa),c=this.kb(eV.hYa);this.getHandler().R(this.Aa,"keydown",this.VZb).R(b,"click",this.Mmb).R(a,"focus",this.Jlb).R(c,"focus",this.Dkb).R(this.Z,"action",this.Otb).R(this.Z.Aa,"mousedown",this.Lg).R(this.va,"action",this.JFb).R(this.va.Aa,"mousedown",this.Lg).R(this.kb(eV.k5),"mousedown",this.Lg).R(zu(this.od),
"eb",this.WZb);Kmc(this);this.H.vc(2790,this.ma);this.F&&this.H.vc(2791,this.ma)};q.qf=function(a){dV.$.qf.call(this,a);Kmc(this);this.Dc()&&Lmc(this)};function Kmc(a){if(a.Dc()){var b=a.Pd();a.Z.setVisible(!b);a=a.oa().kb(eV.o2a,rmc(a));S(a,!b)}}q.VZb=function(a){13==a.keyCode&&a.target==this.Aa&&(a.preventDefault(),a.stopPropagation(),Mmc(this,2255))};
function Nmc(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,b="PieChart"==b,h=CS(Dc(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var p=Omc(h[m].rect,c!=b);Pb(l,p)}var c=KA(a.Vc).Fd(),r=[],u;for(u in Ig)r.push(c.m4(Ig[u]));u=wb(l,function(a){return wb(r,Ga(dh,a))});f&&e&&(u=Qb(u,1));a.Hb=Pmc(u.length,b&&0<d||!f&&!b&&e,b&&k);d=KA(a.Vc);for(e=0;e<u.length;e++)for(f=a.Hb[e],b=0;b<u[e].length;b++)u[e][b]&&mh(u[e][b])&&(k=ZR(d,u[e][b],eV.N2a),F(a,k),mG(BH(d),k,!0),
wo(k.Aa,"background-color",f),k.setVisible(!0),a.jc.push(k),k=hH(d,u[e][b],eV.M2a,1,0),F(a,k),Qeb(k,f),k.setVisible(!0),a.Yb.push(k))}function Qmc(a){Hc(a.jc);Hc(a.Yb);a.jc=[];a.Yb=[];a.Hb=[]}q.WZb=function(){this.Ua&&(Qmc(this),Nmc(this))};q.coa=function(){dV.$.coa.call(this);this.Ga=Ia();this.Ua||(Nmc(this),this.Ua=!0)};q.Y$=function(){dV.$.Y$.call(this);Da(this.Ga)&&500<Ia()-this.Ga&&this.H.vc(2789,this.ma);this.Ga=null;Qmc(this);this.Ua=!1};q.Mmb=function(){this.Aa.focus()};
q.Jlb=function(){var a=this.kb(eV.k5);To(a)?a.focus():this.Aa.nextSibling&&this.Aa.nextSibling.focus()};q.Dkb=function(){var a;if(a=this.O)a=this.O,a.Gb("waffle-assistant-feedback-card-hidden")?a=!1:(a.kb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.va.Aa.focus()};q.Otb=function(){this.H.vc(2255,this.ma);Mmc(this,2255)};q.Lg=function(a){a.stopPropagation()};q.JFb=function(){X.D4.Qc(this)};q.R$=function(a,b){Mmc(this,2257,a,b)};
function Mmc(a,b,c,d){Jmc(a,v(function(a){a=new Zlc(a,this.V,this.J&&this.J.De(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.XZb=function(a,b){if(b){var c=this.kb(eV.Xfa);if(b.Di())RB.sB(c,b);else{a.ye(b.De());cU(a,a.De());tS(a,"ready",v(this.UZb,this,a));b=[];try{var d=new ef;d.setContext(a.toJSON());var e=!!B(this.C,14);D(d,3,e);var f=B(this.C,16);D(d,4,f);D(d,5,"ROWS"==(e?"ROWS":"COLS"));D(d,8,0);if(B(this.C,24)){var h=B(this.C,25);D(d,9,h)}for(var k=CS(Dc(this.D,4)),e=0;e<k.length;e++)d.addRange(rh(k[e].rect,k[e].hd));var l=this.Ke.serialize(d);b=wb(jkc(Ga(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
gkc)}catch(m){b=[]}d=this.kb(eV.k5);S(d,0<b.length);0<b.length&&(d.appendChild(b[0]),kl(d,!0));this.J=a;nU(a,c,this.H,em)}}};q.UZb=function(a){null!==this.Ea&&(GH(EH.getInstance(),this.Ea),this.Ea=null);this.isDisposed()||(a.Dm()&&(SB(a.Dm(),"onmouseover",v(this.SZb,this)),SB(a.Dm(),"onmouseout",v(this.TZb,this))),this.zc(),Lmc(this))};q.SZb=function(){this.Wa=Ia()};q.TZb=function(){Da(this.Wa)&&500<Ia()-this.Wa&&this.H.vc(2795,this.ma);this.Wa=null};
function Lmc(a){if(a.jb&&!a.Pd()){var b=a.kb(eV.Xfa);if(!a.jb.contains(b)){var c=a.jb;a=new Hmc(b,a);glb(c,a)}}}function Rmc(a){a.Lb&&(a.Ea=FH(EH.getInstance(),Ni.Zva),a.Lb=!1);B(a.C,16);var b=vmc(a.C);b.bda(rC);var c=$gc(a.D);b.Zh(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function Imc(a){var b=Rmc(a),b=wmc(b,a.kb("waffle-assistant-card-inner"));(new WS(rC,b.Nf)).send(v(a.XZb,a,b));a.F&&Jmc(a,v(function(a){var c=this.F,e=b;a=new cC(a.toJSON());var e=new cC(e.toJSON()),f=c.ij("waffle-assistant-faceted-chart");if(1<f.length){Gmc(a);var h=e;Fmc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Gmc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Fmc(e);h=CS(Dc(c.J,27));pZa(c.F,h);for(var h=B(c.J,25),k=0;k<f.length;k++){var l=Ba(c.L[k])?c.L[k]:null,m=h.clone(),p=c.Ea,r=new kf;D(r,1,p);Ba(l)&&r.mb(l);D(m,7,r);c.F.Ob("dt",encodeURIComponent(JSON.stringify(c.Ke.serialize(m))));
p=new cC(a.toJSON());p.Zh(c.F.toString());m=e.clone();m.Zh(c.F.toString());var u=c,w=p.qc("title");w||(w=Blc(p));r=w+(' when "'+(u.D+('" is "'+(l+'"'))));u=w+(' by "'+(u.D+'"'));r=l?r:u;p.setOption("title",r);m.setOption("title",r);u=new Amc(p,m,0,0,c.Ga,c.va,c.oa());c.Ta(u);r=f[k];u.tb(r);c.ma.push(u);u=c;w=Blc(p);p=w+(' broken down by "'+(u.D+('" for "'+(l+'"'))));u=w+(' broken down by "'+(u.D+'"'));jo(r,l?p:u);c.H=m}Dmc(c);c.Aa.style.visibility="visible"},a),!1)}
function Jmc(a,b,c){var d=Rmc(a);(new WS(rC,d.Nf)).send(function(a){a?(a=a.De(),c&&d.ye(a),cU(d,a),b(d)):b(null)})}q.getChartType=function(){return this.C.getChartType()};function Pmc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=hic("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Pb(d,d);return d}function Omc(a,b){return b?ulc(a,new Tg(a.width,1)):ulc(a,new Tg(1,a.height))};function Smc(){VH.call(this);this.Ga.push(this);this.ma=this.va=!0;this.qb="waffle-assistant-dragged-card"}x(Smc,flb);Smc.prototype.contains=function(a){return!!z(this.L,function(b){if(b.element==a)return!0})};Smc.prototype.gma=function(a){var b=Smc.$.gma.call(this,a);if(dm&&cm||em){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=wb(b.querySelectorAll("clippath"),function(a){return a.id}),Tmc(b,a);return b};
function Tmc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];Ba(c)&&ab(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=bl(a);for(c=0;c<a.length;c++)Tmc(a[c],b)}function Hmc(a,b){XH.call(this,a,b)}x(Hmc,XH);Hmc.prototype.ima=g("element");function Umc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function fV(a,b){bV.call(this,a,b);this.C=B(a,8)}x(fV,bV);q=fV.prototype;q.zA=sa;q.zz=n("assistantWordCloudFeedback");q.dG=n(2634);q.cG=n(2633);q.qa=function(){fV.$.qa.call(this);cV(this).appendChild(vq(Umc));mo(cV(this),"waffle-assistant-word-cloud-content-container")};
q.JA=function(a){for(var b=Dc(this.C,19),c=Dc(this.C,20),d=this.kb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Ql(b,c,e),120<d.clientHeight){this.Ql(b,c,e-1);break}b=this.oa();c=B(this.C,2);c=ul(b,c);d=this.kb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Ql=function(a,b,c){for(var d=this.kb("waffle-assistant-word-cloud-words-container"),e=this.oa();d.firstChild;)d.removeChild(d.firstChild);for(var f=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(ul(e," "));var l=e.createElement("SPAN");e.appendChild(l,ul(e,a[k]));e.appendChild(d,l);mo(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function gV(a,b,c,d,e){YU.call(this,20,d,c,e);this.ma=a;this.L=b;this.D=new Smc;F(this,this.D);this.F=null;this.J=0}x(gV,YU);q=gV.prototype;q.Ja=function(){gV.$.Ja.call(this);this.D.gf();this.getHandler().R(this.D,"drag",this.RZb).R(this.D,"dragend",this.Xm)};q.cW=n("Analysis");q.Z6=function(a){return 0==a};q.HZ=function(a){return"WordCloud"==B(a,8).getChartType()?new fV(a,this.oa()):new dV(a,this.ma,this.L,this.V,this.D,this.oa())};q.qf=function(a){gV.$.qf.call(this,a);a&&Okb(this.D)};
q.NKa=function(a){this.getHandler().Kc(a,"content-rendered",this.QZb);this.J++};q.QZb=function(){0==--this.J&&this.dispatchEvent("Qe")};q.RZb=function(){this.F=Mo(this.D.ld.target)};q.Xm=function(a){var b=this.F,c=KA(this.L).Zd();if(Xg(lF(c,"page",!1,!1)).contains(b)){var d=jF(c,b.x,b.y,"page"),c=nF(c,bh(d),"page"),b=new L(b.x-c.left,b.y-c.top);a.C.getData().R$(d,b)}this.F=null};q.sea=n(2);function Vmc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function Wmc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(Ba(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":Ba(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var Xmc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Ymc=[{gk:["Thank you","Thankyou","Thanks"],Xg:"No problem"},{gk:["you are amazing","This is great","omg"],Xg:"Happy to help"},{gk:["I love you"],Xg:"Must be in the air"},{gk:["How do you know","How are you so smart"],Xg:"It's all in the data"},{gk:["Are you sure"],Xg:"Send feedback if this doesn't seem correct to help improve accuracy"},{gk:["How are you"],Xg:"Pretty good, thanks"},
{gk:["Hi","Hello","Hey"],Xg:"Hi, there. Try asking a question about your data."},{gk:["You are stupid","This is dumb","You are wrong"],Xg:"Help improve this experience by sending feedback"},{gk:["How smart are you"],Xg:"Pretty smart"}];function Zmc(a){for(var b=0;b<Ymc.length;++b)if(-1!=Cb(Ymc[b].gk,function(b){return Pa(a,b)}))return b;return-1};function $mc(a,b,c,d,e,f){this.C=a;this.HE=b;this.D=(void 0===f?null:f)||b;this.F=d;this.Kq=c;this.ea=d?Dc(d,6):[];this.ma=d?Dc(d,7):[];this.Z=d?Dc(d,8):[];this.error=e||1;this.interpretation=d&&yc(d,4)?B(d,4):null;this.O=d?Dc(d,12):[];this.V=!1;this.L=[];this.J=!1;this.H=null;if(this.F&&yc(this.F,17))if(c=B(this.F,17),this.V=B(c,4)||!1,a=Dc(c,3),b=Dc(c,1),0<a.length)if(0==b.length||1>=this.D.length||1>this.D[0].length)this.L.push("Charts for this question are not supported.");else{for(c=0;c<b.length;c++)if(Db(a,
b[c])){this.J=!0;this.H=b[c];break}null==this.H&&(this.J=!0,this.H=anc(this,b),1==a.length&&6==a[0]||this.L.push("Requested chart type is not supported for this question."))}else 0<b.length&&1<this.D.length&&1<this.D[0].length&&(this.H=anc(this,b),this.J=B(c,2)||!1,20<=this.D.length||3<=this.D[0].length)&&(this.J=!0)}function bnc(a){return 1==a.error&&null!=a.Kq}
function cnc(a){return{ON:dnc(a),interpretation:a.interpretation,HE:a.HE,Kq:a.Kq,D1:1<a.HE.length&&1<a.HE[0].length,Dx:a.Dx(),lTb:a.V,NGb:a.L}}$mc.prototype.Dx=function(){var a;if(a=Aqa&&null!=this.H)a:switch(this.H){case 2:case 3:case 4:case 5:case 10:case 7:a=!0;break a;default:a=!1}return a&&2<this.D.length};
$mc.prototype.getChartType=function(){if(!this.Dx())return null;switch(this.H){case 2:return"ColumnChart";case 3:return"Timeline";case 4:return"ScatterChart";case 5:return"PieChart";case 10:return"Histogram";case 7:return"LineChart";default:throw Error("Unknown chart type.");}};function enc(a){a.Dx();return a.D[0][0]}function fnc(a){a.Dx();return a.D[0][1]||""}function gnc(a){return{ON:dnc(a),error:hnc(a)}}
function anc(a,b){if(!Dc(a.F,18).length)return b[0];var c=new JB,d=Qb(a.HE,1),e=Dc(a.F,18),f=inc(B(e[0],1)),e=inc(B(e[1],1));c.Ln({type:f,label:a.HE[0][0]||"",id:"horizontalAxis",pattern:"general"});c.Ln({type:e,label:a.HE[0][1]||"",id:"verticalAxis",pattern:"general"});for(a=0;a<d.length;++a)c.Ks([jnc(d[a][0],f),jnc(d[a][1],e)]);c=ritz_api.AssistantApi.getAnswersChartsRecommedation(c.toJSON());for(d=0;d<c.length;d++)if(Db(b,c[d]))return c[d];return b[0]}
function jnc(a,b){switch(b){case "boolean":return"true"==a.toLowerCase()||"1"==a;case "number":return qb(a||"0");case "date":case "datetime":return new Date(a);case "timeofday":if(a){b=a.replace(/[^a-zA-Z0-9]/g," ").split(" ");var c=[0,0,0,0];if(!(2>b.length)&&Va(b[0])&&Va(b[1])&&(Va(b[b.length-1])||"am"==b[b.length-1].toLowerCase()||"pm"==b[b.length-1].toLowerCase())){for(var d=0;d<a.length&&4>d;d++)Va(b[d])&&(c[d]=qb(b[d]));"am"==b[b.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==b[b.length-
1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}a=c}else a=[0,0,0,0];return a;default:return a||""}}function inc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function knc(a){if(!yc(a.F,9))return"";if(yc(a.F.getError(),3))switch(B(a.F.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.F.getError().Bm()||""}
function hnc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return knc(a)||"Sorry, couldn't understand your question.";case 7:return a=Zmc(a.C),-1!=a?Ymc[a].Xg:""}return""}
function dnc(a){var b=[];if(bnc(a)){var c=[];z(Nb(a.ea,a.Z),function(a){c.push(lnc(a,"waffle-assistant-answercard-question-unused-phrase"))});z(a.ma,function(a){c.push(lnc(a,"waffle-assistant-answercard-question-used-entity"))});Ub(c,function(a,b){return a.IV>b.IV?1:-1});var d=0;z(c,function(c){var e=c.length,h=c.IV;h>d?b.push({text:a.C.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.C.substring(h,d),className:c.Ak}))});d<a.C.length&&b.push({text:a.C.substring(d),className:null})}else b.push({text:a.C,
className:null});return b}function lnc(a,b){return{IV:B(a,2),length:B(a,3),Ak:b}}function mnc(a,b,c){return new $mc(a,null,null,c||null,b)};function hV(a,b,c,d){J.call(this);this.O=a;this.V=b;this.ea=c;this.Ga=d;this.Da=new K(this);F(this,this.Da);this.C=new fT;F(this,this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.Z=!1;mhc(this.C,this.O);this.C.V=10;this.C.va=!0;this.C.J=!1;this.C.Usa("waffle-assistant-visible");this.C.O=Wa("waffle-assistant-dragged-formula").split(" ");this.C.gf();this.Da.R(this.C,"beforedragstart",this.va).R(this.C,"dragmove",this.Ea).R(this.C,"beforedragend",this.ma)}x(hV,J);hV.prototype.qf=ca("Z");
hV.prototype.va=function(a){a=tb(this.O.childNodes,a.C);this.L=this.J[a]};
hV.prototype.Ea=function(a){var b=a.event instanceof gp?a.event.F:a.event;this.Z?(a.V.Ax(b,!0),a.preventDefault()):(Eo(a.F,a.event.clientX,a.event.clientY),a=Fo(a.F),b=KA(this.V).Zd(),Xg(lF(b,"page",!1,!1)).contains(a)?(a=jF(b,a.x,a.y,"page"),(b=Tv(Bu(this.ea),a.y,a.x))?a=new L(b.yc(),b.Bc()):b=bh(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=KA(this.V),H(this.D),this.D=ZR(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),mG(BH(a),this.D),H(this.F),this.F=hH(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),Qeb(this.F,"#000"),this.F.setVisible(!0))):nnc(this))};hV.prototype.ma=function(a){if(this.H){var b=this.H,c=Bu(this.ea),b=new CF(c,b,this.L);this.Ga.C(b);this.dispatchEvent(new I("formula_inserted"))}a.V.Ax(null,!0);a.preventDefault();this.L="";nnc(this)};function nnc(a){a.H=null;H(a.D);a.D=null;H(a.F);a.F=null};function onc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(it({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function pnc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+qnc({ON:a.LE.ON}),d,e=a.LE.HE;d=a.LE.Kq;var f=a.LE.interpretation,h=a.LE.D1,k=a.LE.Dx,l=a.LE.lTb;a=a.LE.NGb;null==e||wa(e);wa(a);var m;m=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Jq("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(e){if(!l){k&&(m+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');m+='<div class="waffle-assistant-answercard-answer">';if(h){m+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=e[0],f=l.length,p=0;p<f;p++)m+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[p])+"</span>";m+="</div>"}m+='<div class="waffle-assistant-answercard-answer-rows">';l=Fq("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=e.length;for(p=0;p<f;p++){var r=e[p];if(h&&0==p)r="";else{var u=l;wa(r);for(var u='<div class="'+W(u)+'">',w=r.length,y=0;y<w;y++)var C=r[y],u=C?u+('<span class="waffle-assistant-answercard-answer-col">'+U(C)+"</span>"):u+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');r=V(u+"</div>")}m+=r}m+="</div></div>"}m+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':""}if(0<a.length){m+='<div class="waffle-assistant-answercard-info-msgs">';e=a.length;for(h=0;h<e;h++)m+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+"</div>";m+="</div>"}m+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+
U(it({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(d)+"</div></div></div></div></div></div>";d=V(m);return b(c+d+"</div></div>")}
function qnc(a){wa(a.ON);a=a.ON;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Jq("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+
"</div></div></div>")}function rnc(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(it({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};function snc(a){this.C=a}function tnc(a,b){var c=new NU;P(c,3,b);P(c,8,Wqa);b=new eS;Ii(b,4,c);c=new dn;Ii(c,46,b);c=Sn(Rn(new Qn,10),c).build();a.C.vc(2753,c)};function unc(a,b,c,d,e,f){I.call(this,"sqc");this.Ea=a;this.V=f||"";this.ma=b;this.F=d;this.Ga=e;this.C=c}x(unc,I);function iV(a,b,c,d,e,f,h,k,l){bV.call(this,new cT,l);this.C=a;this.Ga=a.Dx();this.Hb=a.Dx()&&a.J;this.Vc=a.V;this.va=!1;this.Ua=b;this.zc=c;this.jc=d;this.od=h;this.ma=e;this.jb=f;this.Wa=k;this.Yb=Rn(new Qn,10).build();this.Ea=new Gr("",new $U,this.oa());this.Ta(this.Ea);this.J=null;this.H=new Gr("",new ZU,this.oa());this.Ta(this.H);this.Z=new Gr("",new ZU,this.oa());this.Ta(this.Z);this.F=new oT;this.Ta(this.F)}x(iV,bV);q=iV.prototype;q.hla=g("Wa");q.qa=function(){iV.$.qa.call(this);rmc(this).appendChild(vq(rnc))};
q.Ja=function(){iV.$.Ja.call(this);var a=this.kb("waffle-assistant-answers-card-remove");this.Ea.tb(a);VU(a,"Remove card",0);this.getHandler().Kc(this.Ea,"action",this.c_b).R(this.H,"action",this.oBb).R(this.Z,"action",this.Qsb).Kc(this.H,"action",v(this.CPa,this,!0)).Kc(this.Z,"action",v(this.CPa,this,!1))};
q.JA=function(a){cV(this).appendChild(vq(pnc,{LE:cnc(this.C)}));this.H.tb(this.kb("waffle-assistant-answercard-see-formula-link"));this.Z.tb(this.kb("waffle-assistant-answercard-hide-formula-link"));this.J=new hV(this.kb("waffle-assistant-answercard-formula-text-container"),this.Ua,this.zc,this.jc);this.J.qf(this.Pd());this.J.J=[this.C.Kq];F(this,this.J);var b=this.kb("waffle-assistant-answercard-formula-text");jo(b,"Formula: "+(this.C.Kq+". Click/Press ENTER to copy or drag to insert on to sheet."));
this.getHandler().Kc(this.J,"formula_inserted",this.yIb).Ei(this.kb("waffle-assistant-answercard-formula-text"),gd,this.esb);vnc(this,!1);if(this.Ga)if(this.Vc)wnc(this),this.va=!0;else{this.F.tb(this.kb("waffle-assistant-answercard-tabs"));b=new mT("");b.tb(this.kb("waffle-assistant-answercard-formula-tab"));this.F.Ta(b);var c=new mT("");c.tb(this.kb("waffle-assistant-answercard-chart-tab"));this.F.Ta(c);this.getHandler().R(this.F,"select",this.BDb).Kc(b,"action",v(this.APa,this,0)).Kc(c,"action",
v(this.APa,this,1));this.F.tA(this.Hb?c:b)}a()};function xnc(a,b){var c={};null!=a?(c.v=b?qb(a):a,c.f=a):c.v=null;return c}
function ync(a){var b=new JB,c=a.C.D[0],d=Qb(a.C.D,1),e=a.C.getChartType();if("ScatterChart"==e&&6==B(a.C.F,16))for(b.Ln({type:"number",label:enc(a.C),id:"horizontalAxis",pattern:"general"}),b.Ln({type:"number",label:fnc(a.C),id:"verticalAxis",pattern:"general"}),c=0;c<d.length;++c)b.Ks([xnc(d[c][0],!0),xnc(d[c][1],!0)]);else if("Histogram"!=e&&"LineChart"!=e)for(b.Ln("string",enc(a.C),"horizontalAxis"),b.Ln({type:"number",label:fnc(a.C),id:"verticalAxis",pattern:"general"}),c=0;c<d.length;++c)b.Ks([xnc(d[c][0],
!1),xnc(d[c][1],!0)]);else for(a=0;a<d.length;++a){for(var e=[],f=0;null!=c[f];f++)0==a&&b.Ln({type:"number",label:c[f]||"",id:"verticalAxis"+f,pattern:"general"}),e.push(xnc(d[a][f],!0));b.Ks(e)}return b}function znc(a,b){slc(b,enc(a.C));a=fnc(a.C);D(b,6,a)}
function wnc(a){var b=new XS,c=a.C.getChartType();D(b,1,c);var d=Qb(a.C.D,1);if("ScatterChart"===c)znc(a,b);else if("Histogram"===c)slc(b,enc(a.C)),D(b,6,"Count");else if("LineChart"===c)D(b,6,"Values");else{var e=wb(d,function(a){return qb(a[1])});znc(a,b);d=Math.min.apply(Math,[].concat(e instanceof Array?e:Alc(la(e))));e=Math.max.apply(Math,[].concat(e instanceof Array?e:Alc(la(e))));e=Math.floor(1.1*e);d=Math.min(d,0);D(b,7,d);D(b,8,e)}b=vmc(b);d=ync(a);b.ye(d);d=a.kb("waffle-assistant-answercard-chart");
b=wmc(b,d);"LineChart"==c&&b.setOption("legend.position","in");cU(b,b.De());nU(b,d,a.ma,em);a.va=!0}q.zA=function(){jo(this.Aa,"Answer Card for question: "+this.C.C)};q.LD=If;q.zz=n("assistantAnswersFeedback");q.dG=n(2628);q.cG=n(2627);q.O9=n("Was this answer correct?");q.Vla=n("Correct");q.Ula=n("Incorrect");q.aW=g("C");q.qf=function(a){iV.$.qf.call(this,a);this.J&&this.J.qf(a)};q.BDb=function(){switch(Chc(this.F)){case 0:Anc(this,!1);break;case 1:Anc(this,!0);break;default:Chc(this.F)}};
function Anc(a,b){S(a.kb("waffle-assistant-answercard-chart-container"),b);S(a.kb("waffle-assistant-answercard-answer"),!b);S(a.kb("waffle-assistant-answercard-formula-holder"),!b);!a.va&&b&&wnc(a)}function vnc(a,b){a.H.setVisible(!b);a.Z.setVisible(b);S(a.kb("waffle-assistant-answercard-formula"),b);b?a.kb("waffle-assistant-answercard-formula-text").focus():(a.H.Aa.focus(),a.H.us(!0))}q.c_b=function(){tnc(this.jb,!0);this.dispatchEvent(new I("rc"))};q.oBb=function(){vnc(this,!0)};
q.Qsb=function(){vnc(this,!1)};q.CPa=function(a){var b=new NU;P(b,9,a);a=new eS;Ii(a,4,b);b=new dn;Ii(b,46,a);b=Sn(Rn(new Qn,10),b).build();this.ma.vc(2849,b)};q.APa=function(a){var b=this.C.H,c=new Flc;P(c,1,b);b=new Elc;Ii(b,1,c);switch(a){case 0:P(b,2,2);break;case 1:P(b,2,1);break;default:P(b,2,0)}a=new NU;Ii(a,10,b);c=new eS;Ii(c,4,a);a=new dn;Ii(a,46,c);a=Sn(Rn(new Qn,10),a).build();this.ma.vc(2850,a)};q.yIb=function(){this.ma.vc(2709,this.Yb)};
q.esb=function(){var a=this.oa().Qb(),b=a.createElement("textarea");b.textContent=this.C.Kq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&jV(this.od,"Formula copied to clipboard",this.oa())};function Bnc(){var a;a=Fq("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(it({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Cnc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(qnc({ON:a.zGa.ON}))+U(onc({error:a.zGa.error,showHelp:a.showHelp}))+"</div></div>")}function Dnc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function kV(a,b,c,d,e){bV.call(this,new cT,e);this.H=a;this.ma=b;this.Z=d;this.va=c;this.J=new Gr("",new $U,this.oa());this.Ta(this.J);this.C=new Gr("",new ZU,this.oa());this.Ta(this.C);this.F=new Gr("",new ZU,this.oa());this.Ta(this.F)}x(kV,bV);q=kV.prototype;q.zA=function(){jo(this.Aa,"Error Card for question: "+this.H.C)};q.zz=n("assistantAnswersFeedback");q.LD=If;q.saa=Hf;q.qa=function(){kV.$.qa.call(this);rmc(this).appendChild(vq(rnc))};
q.Ja=function(){kV.$.Ja.call(this);var a=this.kb("waffle-assistant-answers-card-remove");this.J.tb(a);this.F.setVisible(this.Z);VU(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.h_b).Kc(this.C,"action",this.BBb).R(this.F,"action",this.g_b)};
q.JA=function(a){cV(this).appendChild(vq(Cnc,{zGa:gnc(this.H),showHelp:this.Z}));if(Xl){var b=vq(Dnc);this.oa().appendChild(this.Aa,b);this.C.tb(this.kb("waffle-assistant-answercard-feedback-link"))}this.Z&&this.F.tb(this.kb("waffle-assistant-answers-helpcenter-link"));a()};q.hla=g("ma");q.aW=g("H");q.BBb=function(){this.C.setVisible(!1);S(this.kb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new I("trigger_feedback"))};q.h_b=function(){tnc(this.va,!1);this.dispatchEvent(new I("rc"))};
q.g_b=function(){Q.Rn.Qc()};function Enc(a,b,c,d){var e=new Glc;P(e,2,c);z(b,function(a){O(e,1).push(a)});P(e,3,d);d=new MU;P(d,1,a);P(d,3,b[c]);Ii(d,11,e);return d}function Fnc(a,b,c,d){var e=new Ilc;P(e,2,c);z(b,function(a){O(e,1).push(a)});P(e,3,d);d=new MU;P(d,1,a);P(d,2,b[c]);Ii(d,10,e);return d}function Gnc(a){var b=new Jlc;z(a,function(a){var c=a.type;O(b,1).push(c);a.mHa&&(a=a.mHa,O(b,2).push(a))});return b}function Hnc(a){var b=new Hlc;z(a,function(a){a=a.type;O(b,1).push(a)});return b};function Inc(a){bV.call(this,new cT,a);this.C=this.oa().createElement("div");il(this.C,"Previous")}x(Inc,bV);q=Inc.prototype;q.zA=function(){jo(this.Aa,"Previous questions below")};q.qa=function(){Inc.$.qa.call(this);oo(this.Aa,"waffle-assistant-card");mo(this.Aa,"waffle-assistant-answers-previousheadercard")};q.JA=function(a){0<this.oa().ri(cV(this)).length||cV(this).appendChild(this.C);a()};q.saa=Hf;q.zz=n("assistantAnswersFeedback");function Jnc(a){var b;b=""+((a.H8?U(onc({error:a.H8,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c;c=Fq("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.cUb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(it({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function lV(a,b,c,d,e,f){bV.call(this,a,f);this.C=e||null;this.ma=b;this.F=d;this.va=c;this.Z=this.C?5==this.C.error:!1;this.H=new Gr("",new ZU,this.oa());this.Ta(this.H);this.J=new Gr("",new $U,this.oa());this.Ta(this.J)}x(lV,bV);q=lV.prototype;q.qa=function(){lV.$.qa.call(this);this.LD()&&rmc(this).appendChild(vq(rnc))};
q.Ja=function(){lV.$.Ja.call(this);mo(this.Aa,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.Z);this.getHandler().R(this.H,"action",this.i_b);if(this.LD()){var a=this.kb("waffle-assistant-answers-card-remove");this.J.tb(a);VU(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.j_b)}};q.dG=function(){return Db([Knc,mV],this.F)?2799:Db([Lnc,Mnc],this.F)?2801:null};q.cG=function(){return Db([Knc,mV],this.F)?2798:Db([Lnc,Mnc],this.F)?2800:null};q.O9=n("Were these interesting?");
q.Vla=n("Interesting");q.Ula=n("Not interesting");q.zz=n("assistantAnswersFeedback");q.LD=function(){return this.C?!bnc(this.C):!1};q.zA=function(){var a=this.F.title;a&&this.C?jo(this.Aa,a+(" for question : "+this.C.C)):jo(this.Aa,"Suggested questions")};
q.JA=function(a){var b=this;this.va.then(function(c){if(0==c.length)S(b.Aa,!1);else{var d=b.oa(),e=cV(b);if(0==d.ri(e).length){var f=vq(Jnc,{title:b.F.title,cUb:wb(c,function(a){return a.query}),H8:b.C?hnc(b.C):"",showHelp:b.Z});e.appendChild(f);var h=wb(c,function(a){return a.type}),e=b.ij("waffle-assistant-answercard-question-container");z(e,function(a,e){var f=new Gr("",new $U,d);b.Ta(f);f.tb(a);b.getHandler().R(f,"action",v(b.mDb,b,c[e],h,e))});b.Z&&b.H.tb(b.kb("waffle-assistant-answers-helpcenter-link"))}}a()})};
q.j_b=function(){tnc(this.ma,!1);this.dispatchEvent(new I("rc"))};q.mDb=function(a,b,c){this.dispatchEvent(new unc(this.F.z3,a.Kq||null,b,c,this.F.oZ,a.query))};q.i_b=function(){Q.Rn.Qc()};var Nnc={title:"",oZ:0,z3:null},Knc={title:"",oZ:5,z3:1},mV={title:"Suggested questions",oZ:5,z3:1},Mnc={title:"Did you mean?",oZ:2,z3:4},Lnc={title:"Related questions",oZ:4,z3:4};function Onc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var f;do f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function nV(a){return Onc(a,1)[0]}function Pnc(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return wb(a[b],function(b,d){return wb(a,function(a){return a[d]})})};function Qnc(a){this.F=[];this.D={};this.J=a;this.C=new ZM}function Rnc(a,b,c,d){function e(a){return a.toLowerCase()}Rb(b,void 0,e);Rb(c,void 0,e);Rb(d,void 0,e);z(b,a.H,a);z(c,a.H,a);z(d,a.H,a)}Qnc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Snc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Qnc.prototype.OH=function(a,b,c){var d;if(Wa(a||"")){d=this.J.Tm();d=Tnc(this,a.substring(0,d));var e=Unc(this,b-d.length,a);d=Nb(d,e)}else d=Unc(this,b);d.length>b&&(d=Qb(d,0,b));c(a,d)};
function Unc(a,b,c){var d=c||"";c=bc(a.D,function(a){return Pa(a,d)});var e=Vnc(gc(c),d?1:2,1);a=vb(a.F,function(a){return Pa(a.query,d)&&!e[a.query.toLowerCase()]});b=Vnc(a,b-fc(e),2);b=gc(b);var f=wb(b,function(a,b){a.hua=b;return a.DVa});z(b,function(a){a.fua=f});return Nb(b,gc(e))}
function Tnc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Mda:h.Mda,d2:h.d2,sU:h.sU},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.sU={};h.d2=0;h.Mda=f.substr(k);var l=a.C.Me(h.Mda);z(l,function(b){return function(c){var d=c.length-b.Mda.length;b.d2=Math.max(d,b.d2);c=a.C.get(c);b.sU[d]||(b.sU[d]=[]);Pb(b.sU[d],c)}}(h));for(l=0;l<=h.d2&&0<d;++l){var m=h.sU[l];if(m)for(var p=0;p<m.length&&0<d;++p){var r=m[p];ab(b.toLowerCase(),r.toLowerCase())||e[r]||(--d,c.push({text:r,Kq:"",
vA:0,ECa:f.length-k,DVa:void 0,fua:[],hua:-1}),e[r]=!0)}}}return c}function Vnc(a,b,c){b=Onc(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=Ba(b)?b:b.query;d[e.toLowerCase()]={text:e,Kq:Ba(b)?"":b.Kq,vA:c,ECa:0,DVa:Ba(b)?void 0:b.type,fua:[],hua:-1}});return d};function oV(){cG.call(this,"",null,!1)}x(oV,cG);oV.prototype.mD=function(a,b){if(2==a.vA||1==a.vA)return oV.$.mD.call(this,a.text,b);var c=this.Va(),d=this.Tm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.ECa)+a.text;e||(f+=" ");a=oV.$.mD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.wk;b.blur();b.focus();this.e3(f.length);return a};
oV.prototype.Qg=function(a){var b=oV.$.Qg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,wdb(b)&&b.oG()&&a.preventDefault(),b=!0);return b};function Wnc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(it({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(it({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(it({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Xnc(a){this.yb=a||Gk()}
Xnc.prototype.WN=function(a,b,c){b=vq(Wnc);var d=this.yb.kb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.yb.Uf(d,a.text);var d=this.yb.kb("waffle-assistant-answers-ac-entity-icon",b),e=this.yb.kb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.yb.kb("waffle-assistant-answers-ac-session-query-icon",b);S(d,0==a.vA);S(e,2==a.vA);S(f,1==a.vA);d="";switch(a.vA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&mo(c,d);this.yb.appendChild(c,b)};function pV(a,b,c,d,e,f,h,k,l,m,p){WU.call(this,p);this.bf=c;this.Ag=d;this.If=e;this.we=a;this.qb=h;this.Jg=m;this.Ea=this.V=this.H=this.Pb=null;this.va=new oV;this.va.pHa=!0;this.va.va=!0;this.Ga=new Qnc(this.va);a=new aG(null,new Xnc(p));this.F=new XF(this.Ga,a,this.va);F(this,this.F);this.J=f;this.Ua=this.zc=this.L=null;this.jb=k;this.Db=!1;this.Wa=Rn(new Qn,10).build();this.Ke=new qh;this.Lb=l;this.ma={};this.Z=this.Pc=this.D=this.jc=null;this.Od=EH.getInstance();this.Hb=""}x(pV,WU);q=pV.prototype;
q.qa=function(){pV.$.qa.call(this);var a=this.F.He();a.className="waffle-assistant-answers-ac-renderer";a.$N="waffle-assistant-answers-ac-row";a.x6="waffle-assistant-answers-ac-active";a.Joa="waffle-assistant-answers-ac-highlighted"};q.Ja=function(){pV.$.Ja.call(this);this.va.C=this.F;this.F.XY=!1;this.F.vba=6;this.getHandler().R(this.F,"update",this.nlb);this.dI(null==this.L)};
q.hsa=function(a,b){pV.$.hsa.call(this,a,b);b=this.oa();var c=this.ea;b.appendChild(a,vq(Bnc));this.Pc=b.kb("waffle-assistant-answers-input",a);this.Z=b.kb("waffle-assistant-answers-query-box",a);this.H=new Gr("",new $U,this.oa());c.Ta(this.H);this.H.tb(b.kb("waffle-assistant-answers-clear-query-button",this.Z));this.Ea=new tU(!1,"#4285f4");c.Ta(this.Ea);this.jc=b.kb("waffle-assistant-answers-spinner-container",this.Z);this.Ea.render(this.jc);this.D=b.kb("waffle-assistant-answers-input-box",this.Z);
Ldb(this.va,this.D);VU(this.H.getElement(),"Clear query");c.getHandler().R(this.Z,"submit",v(this.TEb,this)).R(this.Z,"focus",v(this.tGa,this,!0),!0).R(this.Z,"blur",v(this.tGa,this,!1),!0).R(this.H,"action",v(this.r6a,this)).R(this.D,"input",v(this.oVb,this)).R(this.D,"focus",v(this.CQb,this));this.H.setVisible(!1)};q.M7=function(){Ndb(this.va,this.D);this.H.setVisible(!1);this.Ea.dispose();this.Ea=null;pV.$.M7.call(this)};
q.dI=function(a){if(this.Pc){S(this.Pc,!a);var b=fu;b&&b.dispatchEvent("resize")}a?ek(function(){pV.$.dI.call(this,a)},300,this):pV.$.dI.call(this,a)};q.Ah=ca("Pb");function Ync(a,b,c,d){var e=wb(Dc(c,1),function(a){return a.getName()}),f=[],h=[];z(Dc(c,2),function(a){f.push(a.getName());h=h.concat(Dc(a,2))});Rnc(a.Ga,e,f,h);Znc(a.we).then(function(a){this.Ga.F=a},null,a);a.L=b;a.zc=d;a.Ua=c;a.dI(null==b)}q.reset=function(){ES(this.ma);ES(this.Ga.D);var a=this.Ga;a.F=[];a.C.clear();this.V=null};
q.nlb=function(a){if(a.row)if(a=a.row,2==a.vA){var b=Enc(1,a.fua,a.hua,2);$nc(this,b,a.Kq);this.J.vc(2652,this.Wa)}else 0==a.vA?(this.Db=!0,this.J.vc(2651,this.Wa)):1==a.vA&&(a=new MU,P(a,1,3),$nc(this,a))};q.tGa=function(a){to(this.Z,"waffle-assistant-answers-query-box-focused",a);this.F.jg()&&!a&&this.F.Zj()};q.oVb=function(){this.H.setVisible(!!Vmc(this.D))};q.CQb=function(){this.F.xw(this.D);var a=ib(Vmc(this.D));this.va.e3(a.length);tdb(this.F,a||"  ");this.F.update(!0)};
function $nc(a,b,c){var d=a.Jg.L.Mr();P(b,13,d);d=new NU;Ii(d,5,b);var e=Wa(Vmc(a.D));if(!a.Pb||3<=a.Pb.getStatus().getState().C)if(a.ma[e])aoc(a,e,!1);else{c=mnc(e,2);boc(a,c,!0,d);return}else{var f=a.ma[e];f&&f instanceof kV&&2==f.aW().error&&delete a.ma[e]}if(e&&a.L&&a.zc)if(a.ma[e])a.J.vc(2681,a.Wa),aoc(a,e,!0);else{var f=coc(),h=Fi(Fi(f,eS,46),NU,4);P(h,2,a.Db);f=Sn(Rn(new Qn,10),f).build();a.J.vc(2635,f);a.Db=!1;f=Xu(a.L.rect);h=Xu(a.zc.rect);b=Zj(Pi(ak(Ri(Si(a.Pb.Zf("/answers/parse").zg("q",
e,"qt",O(b,1),"gid",a.L.hd,"range",f,"headerRange",h),v(a.Rk,a,e,d)),v(a.d_b,a,e,d)),"POST"),2));c&&b.zg("sgfml",c);b.rf();a.Hb=FH(a.Od,Ni.Uva);doc(a,!0)}else Wmc(a.D,"");a.D.blur();a.H.setVisible(!!e);a.F.jg()&&a.F.Zj()}function aoc(a,b,c){var d=a.ma[b];d!=sb(a.C)&&(1<a.C.length&&eoc(a),c&&foc(a,d.aW()).then(function(a){goc(this,d,a)},null,a),fmc(a,d))}q.TEb=function(a){a.stopPropagation();a.preventDefault();a=new MU;P(a,1,2);$nc(this,a)};q.r6a=function(){Wmc(this.D,"");this.H.setVisible(!1)};
q.d_b=function(a,b){if(this.L){var c=O(Fi(b,MU,5),1),c=1==c||4==c?Klc.wAa:Klc.VAa,d=coc(),e=Fi(Fi(d,eS,46),NU,4);P(e,1,c);P(b,1,c);c=Sn(Rn(new Qn,10),d).build();this.J.vc(2640,c);hoc(this,a,b)}};function hoc(a,b,c){doc(a,!1);b=mnc(b,3);boc(a,b,!1,c);ioc(a)}
q.Rk=function(a,b,c){this.L&&this.jb.C.D.Be.then(function(){var d=null,e=null,f=!1,h=Fi(b,MU,5),k=O(h,1),l=coc(),k=1==k||4==k?Klc.wAa:Klc.VAa,m=Fi(Fi(l,eS,46),NU,4);P(m,1,k);P(b,1,k);l=Sn(Rn(new Qn,10),l).build();if(c.Ol()){e=this.Ke.qd(QU.Fa(),c.qg());if(f=e.getStatus()){var p;switch(f){case 1:p=2639;break;case 2:p=2643;break;case 3:p=2644;break;case 4:p=2638;break;case 5:p=2707;break;case 6:p=2706}p&&this.J.vc(p,l)}p=B(e,10);P(h,4,p);p=B(e,11);P(h,5,p);yc(e,16)&&(p=B(e,16),P(h,16,p));if(1==f){hoc(this,
a,b);return}if(2==f){e=-1!=joc(a);h=-1!=Zmc(a);f=4;d=Fi(b,MU,5);e?(f=5,P(d,8,2)):h&&(f=7,P(d,8,1));h=mnc(a,f);e?(e=new kV(h,!0,this.Lb,!0,this.oa()),koc(this,h,e,b)):boc(this,h,!0,b);doc(this,!1);ioc(this);return}p=yc(e,2)?B(e,2):null;f=!0;if(p){k="";d=loc(this.jb,p,this.L,!!this.Ua&&!!B(this.Ua,4));P(h,14,!!d);if(!d){if(m=p.match(/([A-Z]*)\(/)){var r=Fi(Fi(l.C?Fi(l.C,dn,4):null,eS,46),NU,4);P(r,7,m[1]);P(b,7,m[1])}this.J.vc(2645,l)}d&&moc(d)||(l=this.jb,r=this.L,k="="!=p[0]?"="+p:p,m=noc(l),r=ooc(m,
r),k=Nvb(l.C,k,m,r.row,r.Hj));l=yc(e,19)?loc(this.jb,B(e,19)||"",this.L,!!this.Ua&&!!B(this.Ua,4)):d;d=new $mc(a,d,"="!=p[0]?"="+p:p,e,null,l);k&&d.L.push(k);d.Dx()&&(p=new Flc,P(p,1,d.H),Ii(h,15,p))}else yc(e,9)&&(p=e.getError(),d=mnc(a,6,e),l=B(p,2),P(h,6,l),yc(p,3)&&(p=B(p,3),P(h,12,p)))}else this.J.vc(2640,l);d||(d=mnc(a,4,e));doc(this,!1);bnc(d)?poc(this,d,f,b):boc(this,d,f,b);ioc(this)},function(){hoc(this,a,b)},this)};function ioc(a){""!=a.Hb&&(GH(a.Od,a.Hb),a.Hb="")}
function qoc(a){if(null!=a.Kq)return Lnc;switch(a.error){case 4:case 6:return 0<a.O.length?Mnc:mV;case 5:return mV}return Nnc}function coc(){var a=new NU;P(a,8,Wqa);var b=new eS;Ii(b,4,a);a=new dn;Ii(a,46,b);return a}function joc(a){return Cb(Xmc,function(b){return Pa(a,b)})}
function roc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.Ua&&!!B(a.Ua,4),e=loc(a.jb,e,a.L,f);moc(e)&&(e={query:B(b[d],1),Kq:B(b[d],2),type:b[d].getType()},yc(b[d],5)&&(e.mHa=B(b[d],5)),c.push(e))}return Yi(c)}function poc(a,b,c,d){c=new iV(b,a.bf,a.Ag,a.If,a.J,a.Lb,a.qb,c,a.oa());koc(a,b,c,d)}function boc(a,b,c,d){c=new kV(b,c,a.Lb,!1,a.oa());koc(a,b,c,d)}
function koc(a,b,c,d){eoc(a);var e=foc(a,b,d);soc(a,c);toc(a);bnc(b)&&Snc(a.Ga,b.C);e.then(function(a){if(d){var b=coc(),e=Fi(b,eS,46);Ii(e,4,d);b=Sn(Rn(new Qn,10),b).build();this.J.vc(2781,b)}goc(this,c,a)},null,a);c.hla()&&(a.ma[b.C]=c);a.getHandler().R(c,"rc",a.MMa)}function goc(a,b,c){b instanceof kV&&null!=c&&To(c.getElement())&&(b=b.getElement(),S(b,!1),a.getHandler().R(c,"rc",a.MMa))}function eoc(a){uoc(a);z(a.C,function(a){a instanceof kV&&(a=a.getElement(),S(a,!0))});voc(a)}
function voc(a){0!=a.C.length&&(a.V?fmc(a,a.V):(a.V=new Inc(a.oa()),soc(a,a.V)))}function uoc(a){z(a.C,function(b){b instanceof iV||b instanceof kV||b==a.V||a.LH(b)})}
function foc(a,b,c){var d=qoc(b),e=null;d==Lnc||d==Mnc?0<b.O.length&&(e=roc(a,b)):d==mV&&(e=woc(a.we));var f=null;return e?(f=new lV(new cT,a.Lb,e,d,b,a.oa()),soc(a,f),a.J.vc(2769,a.Wa),a.getHandler().R(f,"sqc",v(a.lDb,a)),e.then(function(a){if(c){var b=Fi(c,MU,5);Db([Lnc,Mnc],f.F)?(a=Gnc(a),Ii(b,7,a)):Db([Knc,mV],f.F)&&(a=Hnc(a),Ii(b,9,a))}return f},null,a)):Yi(f)}
q.lDb=function(a){Wmc(this.D,a.V);this.D.focus();var b=a.Ea,b=1==b?Enc(b,a.C,a.F,3):Fnc(b,a.C,a.F,a.Ga);$nc(this,b,a.ma);this.J.vc(2762,this.Wa)};function doc(a,b){S(a.jc,b);S(a.oa().kb("waffle-assistant-answers-button-container",a.Z),!b);a.Ea&&a.Ea.setActive(b)}function soc(a,b){b.qf(a.Pd());a.C.push(b);a.jf&&(a.O.Hi(b,0,!0),b.hF());XU(b,!0)}function toc(a){for(var b=a.C;5<b.length;)a.LH(b[0])}q.h7=function(){pV.$.h7.call(this);this.reset()};
q.MMa=function(a){var b=this,c=this.oa();a=a.target;if(a instanceof iV)this.LH(a),jV(this.qb,"Answer removed",c,v(this.cAb,this,a));else if(a instanceof kV)this.LH(a),jV(this.qb,"Card removed",c);else if(a instanceof lV&&a.C&&!bnc(a.C)){var d=a.C.C;z(this.C,function(a){a instanceof kV&&a.aW().C==d&&(b.LH(a),jV(b.qb,"Card removed",c))})}a=this.C;!this.V||a[0]!=this.V&&a[a.length-1]!=this.V||(this.LH(this.V),this.V=null)};
q.cAb=function(a){poc(this,a.aW(),a.hla());jV(this.qb,"Remove answer undone",this.oa())};q.LH=function(a){if(a.Dc()){if(a instanceof iV||a instanceof kV)delete this.ma[a.aW().C],a==sb(this.C)&&uoc(this);pV.$.LH.call(this,a)}H(a)};function xoc(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(it({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Jq("Ask a question about your data")+'" /></div></form></div>');return V(a)};function yoc(a,b){this.C=a;this.D=b}function loc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=noc(a);c=ooc(e,c);(a=tlc(a.C,b,e,c.row,c.Hj))&&d&&(a=Pnc(a));return a}function moc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function noc(a){a=vu(a.D);return null!=a?a.toString():"0"}
function ooc(a,b){var c={row:0,Hj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Xc()+1?c.row=b.Xc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.dd()+1&&(c.Hj=b.dd()+1));return c};function zoc(a){var b=[];if(yc(a,25)&&(a=B(a,25)))for(var c=0;c<zc(a,1);c++){var d=B(a,1,c);if(yc(d,2)){var e=B(d,2);e&&b.push(Aoc(e,Boc(d)))}}return b}function Coc(a){var b=zoc(a);yc(a,6)&&(a=B(a,6))&&b.push(Aoc(a,0));return b}function Boc(a){return(a=yc(a,4)?B(a,4):0)?a:0}function Aoc(a,b){return{name:a,l4a:b}};function Doc(a,b,c){this.ma=a;this.va=b;this.D=[];this.F=[];this.L=[];this.O=[];this.V=[];this.Z=[];this.C=new ag;this.J=new ag;this.ea=new ag;this.H=new ag;Eoc(this,c)}function Foc(a,b){return bg(a,b)?a.get(b).values.Dd():[]}
function Eoc(a,b){for(var c=new fg,d=new fg,e=0;e<b.length;e++){for(var f=Coc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(bg(a.ma,m)){var p=a.ma.get(m);c.add(p);h.push(p)}bg(a.va,m)&&(m=a.va.get(m),d.add(m),k.push(m))}Goc(a,h,k)}a.D=c.Dd();a.F=d.Dd();Ub(a.D);Ub(a.F);a.L=wb(a.C.Dd(),function(a){return a.key});Ub(a.L);a.O=wb(a.J.Dd(),function(a){return a.key});Ub(a.O);a.V=wb(a.ea.Dd(),function(a){return a.key});Ub(a.V);a.Z=wb(a.H.Dd(),function(a){return a.key});Ub(a.Z)}
function Goc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)qV(a.C,b[d],b[e]),qV(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)qV(a.J,b[d],c[e]),qV(a.ea,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)qV(a.H,c[b],c[d]),qV(a.H,c[d],c[b])}function qV(a,b,c){var d;bg(a,b)?d=a.get(b).values:d=new fg;d.add(c);a.set(b,{key:b,values:d})};function Hoc(a,b){this.C=a;for(var c=new ag,d=0;d<zc(a,2);d++)c.set(a.Nd(d).getName().toLowerCase(),d);this.O=c;c=new ag;for(d=0;d<zc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.ma=c;c=[];for(d=0;d<zc(a,2);d++)rV(a.Nd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<zc(a,1);d++)rV(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<zc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Ioc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Ioc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.va=
c;this.ea=Joc(a,0);this.V=Joc(a,1);c=[];for(d=0;d<zc(a,2);d++).8<=B(a.Nd(d),6)&&c.push(d);this.Z=c;c=[];for(d=0;d<zc(a,2);d++)e=a.Nd(d),.95<=Dc(e,2).length/B(e,8)&&c.push(d);this.Ga=c;c=[];for(d=0;d<zc(a,3);d++)f=a.Nd(B(a,3,d)),e=Dc(f,2).length/B(f,8),f=zc(f,3)/zc(f,2),.5<e||.3>f||c.push(B(a,3,d));this.Ea=c;this.F=Koc(zc(a,2));this.H=Koc(zc(a,1));this.D=new Doc(this.O,this.ma,b)}function Koc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Joc(a,b){for(var c=[],d=0;d<zc(a,2);d++)a.Nd(d).getType()==b&&c.push(d);return c}function Loc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Moc(c,a[d]);for(a=0;a<b.length;a++)d=Moc(c,b[a]),c=0<d.length?d:c;return 0<c.length?c[nV(c.length)]:-1}function sV(a,b,c,d,e,f){var h=[a.J,a.D.D],k=[a.F];b&&(k.push(a.ea),k.push(a.Z));c&&k.push(a.Ea);d&&k.push(a.Ga);null!=f&&-1!=f?h.push(Foc(a.D.J,f)):e&&h.push(a.D.O);return Loc(k,h)}
function tV(a,b,c){var d=[a.L,a.D.F],e=[a.H];b&&e.push(a.va);c&&d.push(a.D.V);return Loc(e,d)}function Noc(a,b){for(var c=5;;){var d=a.C.Nd(b),e=nV(zc(d,2));c--;if(rV(LU(d,e))||0==c)return e}}function Ooc(a,b){for(var c=5;;){var d=a.C.Nd(b),e=nV(zc(d,3)),e=B(d,3,e);c--;if(rV(LU(d,e))||0==c)return e}}function uV(a,b){b=a.C.Nd(b);a=b.getName();rV(a)||(b=Poc(Dc(b,7)),a=null==b?a:b);return a}function vV(a,b){b=B(a.C,1,b);a=b.getName();rV(a)||(b=Poc(Dc(b,2)),a=null==b?a:b);return a}
function Poc(a){for(var b=0;b<a.length;b++)if(rV(a[b]))return a[b];return null}function rV(a){return null==a?!1:50>=a.length}function Qoc(a){for(var b=Onc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Moc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Ioc=["average","total","sum","mean","median"];function Roc(a,b){this.C=[];this.F=[];this.H=this.V=this.J=this.D=null;this.O=new fg;this.L=new fg;this.Z=a;this.ma=b;this.ea=Rn(new Qn,10).build()}Roc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.L=new fg;this.O=new fg};Roc.prototype.Ah=ca("H");function Znc(a){return yqa&&a.D?a.D.then(function(){return this.F.slice()},null,a):Yi(a.C.slice())}
function Soc(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function Toc(a){Ub(a,function(a,c){return c.weight-a.weight});return wb(a,function(a){return a.gua})}
function Uoc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}function wV(a,b,c,d,e){e=Math.pow(Math.random(),1/(Uoc(d)*(void 0===e?1:e)));a.L.contains(c)||(b.push({gua:{query:c,Kq:void 0,type:d},weight:e}),a.O.add(d),a.L.add(c))}
function xV(a,b){return!a.O.contains(b)}function woc(a){return Znc(a).then(function(a){return 3>=a.length?a:Qb(a,0,3)},null,a)}function Voc(a,b){var c=[];b=zoc(b);for(var d=0;d<b.length&&-1!=a.ma.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function Woc(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Xoc;break a;case 4:a=Yoc;break a}a=Zoc}return a[nV(a.length)]}
function $oc(a){var b=null;a.D=new Wi(function(a){if(!this.H||3<=this.H.getStatus().getState().C)this.F=this.C,a();var c=Xu(this.J.rect),e=wb(this.C,function(a){return a.query});b=ak(Zj(Pi(Ri(Si(this.H.Zf("/answers/parsesuggestions").zg("gid",this.J.hd,"range",c),v(function(b){apc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.ma.vc(2833,this.ea);this.F=this.C;a()},this)).setContent(["queries",yi(e)]).setTimeout(2E3),1)),"POST").rf()},a);cj(a.D,function(){b&&b.dispose()})}
function apc(a,b){return a.Z.C.D.Be.then(function(){var a=[];if(b.Ol())for(var d=b.qg(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.V&&!!B(this.V,4),f=loc(this.Z,d[e],this.J,f),f=moc(f);f&&(this.C[e].Kq=d[e],a.push(this.C[e]))}this.F=a},function(){this.F.length=0},a)}var bpc="Minimum Maximum Most Least Highest Lowest".split(" "),Zoc=["Average","Median"],Xoc=["Total","Average","Median"],Yoc=["Median"],cpc=["before","after"];function dpc(a){this.F=a;this.D=[];this.C=[]}x(dpc,E);function epc(a,b){fpc(a);if(null!=b){var c=KA(a.F),d=c.Fd(),d=wb(gc(Ig),d.m4,d);b=wb(d,Ga(dh,b.rect));for(d=0;d<b.length;d++)if(b[d]&&mh(b[d])){var e=ZR(c,b[d],"waffle-assistant-answers-styled-rect");F(a,e);mG(BH(c),e,!0);e.setVisible(!0);a.D.push(e);e=hH(c,b[d],"waffle-assistant-answers-styled-border",1,0);F(a,e);e.setVisible(!0);a.C.push(e)}}}function fpc(a){Hc(a.D);Hc(a.C);a.D=[];a.C=[]};function yV(a,b,c,d,e,f,h,k){YU.call(this,1,f,e,k);this.Db=c;this.Ea=null;this.ma=new Gr("",new ZU,this.oa());this.Ta(this.ma);this.va=new Gr("",new ZU,this.oa());this.Ta(this.va);a=new Kvb(a,!0,!0);a=new yoc(a,c);this.qb=new snc(e);this.O=new Roc(a,e);this.L=new pV(this.O,0,b,c,d,e,this.jb,a,this.qb,h,k);this.F=new dpc(b);F(this,this.F);this.D=this.J=null;this.Ab=Rn(new Qn,10).build()}x(yV,YU);
var gpc={r0a:"waffle-assistant-answers-input-box",O1a:"waffle-assistant-answers-query-box",Rpc:"waffle-assistant-answers-query-box-focused",G0a:"waffle-assistant-answers-learn-more",Tkc:"waffle-assistant-answers-logging-message-container",s1a:"waffle-assistant-answers-logging-opt-out"};q=yV.prototype;q.qa=function(){yV.$.qa.call(this);var a=vq(xoc);this.oa().appendChild(gmc(this),a)};
q.Ja=function(){yV.$.Ja.call(this);var a=this.kb(gpc.O1a),b=this.kb(gpc.r0a);this.va.tb(this.kb(gpc.s1a));this.ma.tb(this.kb(gpc.G0a));this.getHandler().R(a,"focus",this.rzb,!0).R(a,"blur",this.pzb,!0).R(a,"mouseover",this.tzb).R(a,"mouseout",this.szb).R(a,"click",this.qzb).R(b,"input",this.e_b).R(this.va,"action",this.Nxb).R(this.ma,"action",this.yub).R(zu(this.Db),"eb",wgc(this.f_b,25,this));this.setVisible(null!=this.J);hpc(this,xqa&&Bqa&&hm("showAnswersLoggingOptOut"))};q.KUa=Hf;q.CNa=If;
q.rta=Hf;q.cW=n("Answers");q.sea=n(1);q.Z6=function(a){return 3==a||0==a};q.rva=function(a,b){Ub(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Ec(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,f=XR(B(d,10)),0<zc(d,4)?ipc(this,XR(B(d,4,0)),B(d,9),f,c):ipc(this,e,B(d,9),f,c),this.D||(yV.$.rva.call(this,a,b),this.getHandler().R(this.D,"sqc",this.kDb))):this.bW(!0)};
q.HZ=function(a){if(!this.D){var b=woc(this.O);this.D=new lV(a,this.qb,b,Knc,void 0,this.oa())}return this.D};q.xDa=g("L");q.zoa=function(){return this.sb()};
q.bW=function(a,b,c){this.O.reset();(a||b)&&this.D&&(yV.$.bW.call(this,a,b,c),this.D.dispose(),this.D=null);if(a||t(b)&&!b)this.D&&(yV.$.bW.call(this,a,b,c),this.D.dispose(),this.D=null),this.Dc()&&(this.O.reset(),this.J=null,a=this.L,a.Dc()&&(b=a.Ga,b.F=[],b.C.clear(),a.D&&Wmc(a.D),a.h7(),a.L=null,a.dI(!0),a.H&&!a.H.isDisposed()&&a.H.setVisible(!1),a.Db=!1),this.setVisible(!1),this.tc()&&fpc(this.F));c&&this.L.reset()};q.Ah=function(a){this.Ea=a;this.L.Ah(a);this.O.Ah(a)};
q.setActive=function(a){yV.$.setActive.call(this,a);a?epc(this.F,this.J):fpc(this.F)};function hpc(a,b){S(a.kb("waffle-assistant-answers-logging-message-container"),b)}function jpc(a,b){a=a.kb("waffle-assistant-answers-query-box");to(a,"waffle-assistant-answers-query-box-focused",b)}q.f_b=function(){this.tc()&&epc(this.F,this.J)};q.rzb=function(){jpc(this,!0);epc(this.F,this.J)};q.pzb=function(){jpc(this,!1);this.tc()||fpc(this.F)};q.tzb=function(){epc(this.F,this.J)};
q.szb=function(){this.tc()||fpc(this.F)};q.qzb=function(){kpc(this,"")};q.e_b=function(){var a=this.kb("waffle-assistant-answers-input-box");kpc(this,a.value);a.value=""};q.kDb=function(a){kpc(this,a.V);var b=Enc(1,a.C,a.F,1);ek(v(function(a){$nc(this.L,b,a)},this,a.ma),300,this);this.V.vc(2652,this.Ab)};function kpc(a,b){a.setActive(!0);a.dispatchEvent("Te");ek(function(){var a=this.L;Wmc(a.D,b);a.D.focus()},300,a)}
function ipc(a,b,c,d,e){var f=c||new $S;a.J=b;var h=a.O,k=e;h.reset();var k=zqa?k:[],l=[],m=new Hoc(f,k);if(zqa)for(var p=k,r=0;r<p.length;r++){var u=p[r];switch(u.getChartType()){case "BarChart":var w=h,y=m,C=l;if(xV(w,13)||xV(w,2)){var G=B(u,6);if(G&&-1!=y.O.get(G.toLowerCase(),-1)){var N=Voc(y,u);1<N.length&&(Aqa&&xV(w,19)?wV(w,C,"Line chart of "+N[0].name+" vs "+N[1].name,19,2):xV(w,2)&&wV(w,C,"Correlation of "+N[0].name+" and "+N[1].name,2,1.5))}}break;case "ScatterChart":var R=h,Z=l,ha=Voc(m,
u);1<ha.length&&(Aqa&&xV(R,19)?wV(R,Z,"Line chart of "+ha[0].name+" vs "+ha[1].name,19,2):xV(R,2)&&wV(R,Z,"Correlation of "+ha[0].name+" and "+ha[1].name,2,1.5));break;case "PieChart":for(var ka=h,ga=l,pa,ya=[],Ka=zoc(u),jb=0;jb<Ka.length&&-1!=m.O.get(Ka[jb].name.toLowerCase(),-1);jb++)ya.push(Ka[jb]);pa=ya;1==pa.length&&4==pa[0].l4a&&(Aqa&&xV(ka,18)?wV(ka,ga,"Bar chart of distribution of "+pa[0].name,20,2):xV(ka,14)&&wV(ka,ga,"Distribution of "+pa[0].name,14,1.5))}}if(xV(h,1)){var Qa=m.C,lb=tV(m,
!1,!0),Oa=sV(m,!0,!1,!0,!0,lb);if(-1!=Oa&&-1!=lb){var fb=10<=zc(Qa.Nd(Oa),2)?"5 ":"",Wc=uV(m,Oa),hd=vV(m,lb);Wc!=hd&&wV(h,l,"Top "+fb+Wc+" by "+hd,1)}}if(xV(h,2)&&1<zc(m.C,1)){var md;a:if(2>m.H.length)md=[-1,-1];else{var wd=Loc([m.H],[m.L,m.D.F,m.D.Z]);if(-1!=wd){var Ib=Foc(m.D.H,wd);if(0<Ib.length){var Ud=[wd],bb=nV(Ib.length);Ud.push(Ib[bb]);md=Ud;break a}}md=Qoc(2<=m.L.length?m.L:m.H)}var fd=md,xd=vV(m,fd[0]),Yf=vV(m,fd[1]);xd!=Yf&&wV(h,l,"Correlation of "+xd+" and "+Yf,2)}if(xV(h,3)){var tk=m.C,
Zh=tV(m,!0);-1!=Zh&&wV(h,l,Woc(Dc(B(tk,1,Zh),3))+" of "+vV(m,Zh),3)}if(xV(h,5)){var Hi=m.C,kh=tV(m,!0,!0),Tk=sV(m,!0,!0,!1,!0,kh);if(-1!=kh&&-1!=Tk){var Ap=vV(m,kh),Uq=Hi.Nd(Tk),xs=uV(m,Tk);if(0<zc(Uq,3)&&xs!=Ap){var ys=Ooc(m,Tk);wV(h,l,Woc(Dc(B(Hi,1,kh),3))+" of "+Ap+" when "+xs+" is "+LU(Uq,ys),5)}}}if(xV(h,9)){var Vq=tV(m,!1,!0),zs=sV(m,!0,!1,!0,!0,Vq);if(-1!=zs&&-1!=Vq){var kn=vV(m,Vq),ln=uV(m,zs);ln!=kn&&wV(h,l,ln+" with "+bpc[nV(bpc.length)]+" "+kn,9)}}if(xV(h,10)&&0<zc(m.C,1)){var Bp=vV(m,
tV(m));wV(h,l,bpc[nV(bpc.length)]+" "+Bp,10)}if(xV(h,11)){var qo=m.C,Cp=sV(m,!0,!0,!1,!1,-1);if(-1!=Cp){var As=uV(m,Cp);0<zc(qo.Nd(Cp),3)&&wV(h,l,"Most frequent "+As,11)}}if(xV(h,12)){var Wq=m.C,ro=tV(m,!0),Dp;a:{if(1==m.V.length){var Bs=m.V[0];if(!B(m.C.Nd(Bs),5)){Dp=Bs;break a}}Dp=-1}var so=Dp;if(-1!=so&&-1!=ro){var mn=vV(m,ro),wA=Wq.Nd(so);if(0<zc(wA,2)){var zb=Noc(m,so);wV(h,l,Woc(Dc(B(Wq,1,ro),3))+" of "+mn+" "+cpc[nV(cpc.length)]+" "+LU(wA,zb),12)}}}if(xV(h,15)){var YA=m.C,ZA=tV(m,!0),DE=sV(m,
!1,!0,!1,!0,ZA);if(-1!=ZA&&-1!=DE){var vK=vV(m,ZA),AR=uV(m,DE);if(AR!=vK){var zo=YA.Nd(DE);if(2<=zc(zo,3)){var BR=Onc(zc(zo,3),2);wV(h,l,"Compare "+Woc(Dc(B(YA,1,ZA),3))+" "+vK+" for "+AR+" "+LU(zo,B(zo,3,BR[0]))+" and "+LU(zo,B(zo,3,BR[1])),15)}}}}if(xV(h,16)){var p1=sV(m,!0,!0,!1,!1);if(-1!=p1){var wK=uV(m,p1);wV(h,l,"List unique values in "+wK,16)}}if(xV(h,17)){var xK=m.C,hx=sV(m,!0,!0,!1,!1);if(-1!=hx){var yK=xK.Nd(hx),CR=uV(m,hx);if(!(1>zc(yK,3))){var DR=Ooc(m,hx);wV(h,l,"What percentage of "+
CR+" is "+LU(yK,DR),17)}}}if(xV(h,13)){var ER=m.C,$A=tV(m,!0,!0),Cu=sV(m,!0,!0,!1,!0,$A);if(-1!=$A&&-1!=Cu){var aB=vV(m,$A),Du=uV(m,Cu);Du!=aB&&wV(h,l,Woc(Dc(B(ER,1,$A),3))+" of "+aB+" by "+Du,13)}}var ix=3>l.length;if((ix||0==nV(5))&&xV(h,7)){var EE=m.C,bB=tV(m,!1,!0),jx=sV(m,!1,!1,!1,!0,bB);if(-1!=jx&&-1!=bB){var cB=EE.Nd(jx),Ns=uV(m,jx),zK=vV(m,bB);if(0<zc(cB,2)&&Ns!=zK){var FE=Noc(m,jx);wV(h,l,"Show "+zK+" for "+Ns+" "+LU(cB,FE),7)}}}if((ix||0==nV(5))&&xV(h,8)){var Os=m.C,dB;a:if(2>m.F.length)dB=
[-1,-1];else{var FR=[m.J,m.D.D,m.D.L],AK=[m.F];AK.push(m.ea);AK.push(m.Z);var kx=Loc(AK,FR);if(-1!=kx){var Eu=Foc(m.D.C,kx);if(0<Eu.length){var eB=[kx],q1=nV(Eu.length);eB.push(Eu[q1]);dB=eB;break a}}var Ip=Qoc(2<=m.J.length?m.J:m.F);Ip[0]!=kx&&(Ip[1]=Ip[0],Ip[0]=kx);dB=Ip}var GR=dB,GE=GR[0];if(1<zc(Os,2)&&-1!=GE){var r1=GR[1],fB=Os.Nd(r1),Ao=uV(m,r1),s1=uV(m,GE);if(0<zc(fB,2)&&Ao!=s1){var vAa=Noc(m,r1);wV(h,l,"What is "+s1+" where "+Ao+" is "+LU(fB,vAa),8)}}}h.C=Toc(l);h.J=b;h.V=f;yqa&&$oc(h);a.setVisible(null!=
b);Ync(a.L,b,f,d);a.tc()&&epc(a.F,a.J)}q.Nxb=function(a){a.stopPropagation();a.preventDefault();this.Ea&&(ak(Ri(Si(this.Ea.Zf("/answers/logoptout"),v(this.lvb,this)),v(this.kvb,this)),"POST").rf(),this.V.vc(2663,this.Ab))};q.yub=function(a){a.stopPropagation();a.preventDefault();Vn("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.lvb=function(a){a.Ol()&&hpc(this,!1)};q.kvb=ba();function lpc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+mpc()+"</div>");return V(a)}
function npc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+mpc()+"</div>")}function mpc(){var a;a=""+U(Nr({Je:"waffle-assistant-formatting-edit-button",content:Fq("Edit"),style:4}));return V(a)};function zV(a,b,c){bV.call(this,a,c);a=wb(Dc(this.D,7),Ggc);this.C=new SS(!1,a,7);this.Ta(this.C);this.J=new Or("",this.oa());this.Ta(this.J);this.Z=b;this.H=!1;this.F=-1}x(zV,bV);var opc={Tea:"waffle-assistant-banding-color-picker-container",dfa:"waffle-assistant-formatting-edit-button",tJ:"waffle-assistant-banding-range"};q=zV.prototype;q.qa=function(){zV.$.qa.call(this);cV(this).appendChild(vq(lpc))};
q.Ja=function(){zV.$.Ja.call(this);this.getHandler().R(this.J,"action",this.sqb).R(this.C,"banding-scheme-changed",this.Elb);this.Z.C(2768)};q.JA=function(a){var b=this.kb(opc.Tea);this.C.render(b);Mgc(this.C);var b=this.kb(opc.tJ),c=B(this.D,4,0),d=th(c);il(b,Xu(d));ppc(this,c);b=this.kb(opc.dfa);this.J.tb(b);a()};q.zA=function(){jo(this.Aa,"Suggested alternating background colors");Xp(this.C,"Choose a color scheme")};q.zz=n("assistantBandingFeedback");q.dG=n(2672);q.cG=n(2671);
q.sqb=function(a){Cm.dispatchEvent({type:"show-banding-pane-recommendation",RSa:this.D,s7a:Ngc(this.C)});a.stopPropagation()};q.Elb=function(a){if(!this.H&&TS(this.C)){var b=this.F;this.F=this.C.Ci();this.F==b?this.dispatchEvent(new UU("Se",this,2797)):this.dispatchEvent(new UU("Me",this,2673));a.stopPropagation()}};
function ppc(a,b){a.H=!0;var c;c=b.Ib();b=th(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.Bc(),b.yc(),b.Xc(),b.dd(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new qh).qd(Bd.Fa(),c),c=Ggc(c)):c=null;c?(c=Ogc(a.C,c),LH(a.C,c?c.getElement():null)):LH(a.C,null);a.F=a.C.Ci();a.H=!1};function AV(a,b){bV.call(this,a,b);this.C=new Or("",this.oa());this.Ta(this.C);this.Db=Dc(a,6)}x(AV,bV);var BV={dfa:"waffle-assistant-formatting-edit-button",U_a:"waffle-assistant-conditionalformat-format-preview",j2a:"waffle-assistant-conditionalformat-rule-holder",L4:"waffle-assistant-conditionalformat-description",p1a:"one-rule",l3a:"two-rules",Z2a:"three-rules",H1a:"waffle-assistant-conditionalformat-format-preview-label"};q=AV.prototype;q.qa=function(){AV.$.qa.call(this);cV(this).appendChild(vq(npc))};
q.Ja=function(){AV.$.Ja.call(this);var a=this.kb(BV.dfa);this.C.tb(a);VU(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.clb)};q.JA=function(a){il(this.kb(BV.L4),Ec(this.D,3));var b=this.kb(BV.j2a),c=new qpc(this,this.oa());this.Ta(c);c.tb(b);VU(b,"Apply conditional format rules");a()};q.zA=sa;q.zz=n("assistantConditionalFormatFeedback");q.dG=n(2630);q.cG=n(2629);
q.clb=function(){this.dispatchEvent(new UU("Ne",this,2563));this.dispatchEvent(new UU("Pe",this,2670,void 0,void 0,th(B(this.Db[0],1,0))));Gm()};function qpc(a,b){Up.call(this,void 0,void 0,b);this.C=a}x(qpc,Up);
qpc.prototype.Fe=function(a){qpc.$.Fe.call(this,a);var b=this.C.Db,c;switch(b.length){case 0:break;case 1:c=BV.p1a;break;case 2:case 4:c=BV.l3a;break;default:c=BV.Z2a}for(var d=0;d<b.length;d++){var e=b[d],f=Rk("DIV");no(f,[BV.U_a,c]);var h=Rk("DIV");mo(h,BV.H1a);f.appendChild(h);il(h,"123");if(yc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=Dc(B(k,1),2)[0],l=Dc(e,1)[0];il(h,Oy(k,Ec(l,1),Ec(l,2),Ec(l,4)))}}dgc(e,f);a.appendChild(f)}};
qpc.prototype.Oi=function(){var a=this.C;a.dispatchEvent(new UU("Ne",a,2563));return!0};function rpc(a,b,c){YU.call(this,2,b,a,c)}x(rpc,YU);q=rpc.prototype;q.cW=n("Formatting");q.Z6=function(a){return 2==a||4==a};q.HZ=function(a){var b=B(a,1);switch(b){case 2:return new AV(a,this.oa());case 4:return a=new zV(a,this.V,this.oa()),this.getHandler().R(a,"Me",this.OSb).R(a,"Se",this.$Fb),a;default:throw Error("Unsupported recommendation type: "+b);}};q.OSb=function(a){jV(this.jb,"Alternating colors applied",this.oa(),v(this.Flb,this,a.C))};q.$Fb=function(){this.jb.clear()};
q.Flb=function(a){this.dispatchEvent(new UU("We",a,2796))};q.qf=function(a){rpc.$.qf.call(this,a);this.setVisible(!a)};q.n4=function(a){return this.Pd()?(this.setVisible(!1),a):rpc.$.n4.call(this,a)};q.sea=n(3);function spc(){var a;a=""+('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper">Detected Table: <input spellcheck="false" type="text" autocomplete="off" class="waffle-assistant-range waffle-assistant-tables-range" disabled /></div>'+tpc({hZ:"waffle-assistant-tables-edit-table-button"})+'</div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Table Headers: <input spellcheck="false" type="text" autocomplete="off" class="waffle-assistant-range waffle-assistant-tables-headers" disabled /></div>'+
tpc({hZ:"waffle-assistant-tables-edit-headers-button"})+'</div></div><div class="waffle-assistant-canvas-container"><canvas class = "waffle-assistant-table-canvas"/></div>');return V(a)}function tpc(a){return V('<div class="waffle-assistant-tables-edit-button-holder"><div class="'+W(a.hZ)+' waffle-assistant-tables-edit-button">'+U(it({icon:"docs-icon-img docs-icon-mode-edit"}))+"</div></div>")};function upc(a,b,c){bV.call(this,a);this.Z=B(a,4,0);this.va=B(a,10);a=th(this.Z);this.J=Xu(a);a=th(this.va);this.H=Xu(a);this.ma=b;this.Ea=c;this.F=new Gr("",new $U,this.oa());this.Ta(this.F);this.C=new Gr("",new $U,this.oa());this.Ta(this.C)}x(upc,bV);var CV={o_a:"waffle-assistant-tables-edit-headers-button",p_a:"waffle-assistant-tables-edit-table-button",Exa:"waffle-assistant-tables-headers",S2a:"waffle-assistant-table-canvas",T2a:"waffle-assistant-canvas-container",AAa:"waffle-assistant-tables-range"};
q=upc.prototype;q.qa=function(){upc.$.qa.call(this);cV(this).appendChild(vq(spc))};q.Ja=function(){upc.$.Ja.call(this);this.getHandler().R(this.F,"action",this.tqb).R(this.C,"action",this.pqb)};
q.JA=function(a){this.F.tb(this.kb(CV.p_a));this.C.tb(this.kb(CV.o_a));vpc(this);var b=this.kb(CV.S2a);gvb(b);var c=fvb(b),d=th(this.Z),d=new $g(d.Bc(),d.yc(),Math.min(d.Xc(),d.Bc()+6),Math.min(d.dd(),d.yc()+3)),e=KA(this.ma).Zd(),f=e.yg(new Pg(d.Bc(),d.Xc()),"r",!1,!1,!0,!0)-1,e=e.yg(new Pg(d.yc(),d.dd()),"c",!1,!1,!0,!0)-1,h=this.kb(CV.T2a),f=Math.min(h.offsetHeight-2,f),e=Math.min(h.offsetWidth-12-2,e);hvb(b,c,e,f);this.Ea.Nj(b).Jca(c,d,!1);a()};
function vpc(a){var b=a.kb(CV.AAa),c=a.kb(CV.Exa);b.value=a.J;c.value=a.H}q.zA=function(){jo(this.Aa,"Detected table")};q.zz=n("assistantTablesFeedback");function wpc(a,b,c,d){b.disabled=!0;kd(b,"keydown");c&&(d(),a.dispatchEvent(new UU("Ue",a,2859)))}
function xpc(a,b,c){b.disabled=!1;b.focus();b.select();a.getHandler().R(b,"keydown",function(d){switch(d.keyCode){case 13:wpc(a,b,!0,c);d.stopPropagation();d.preventDefault();break;case 27:d.stopPropagation(),d.preventDefault(),vpc(a),wpc(a,b,!1,c)}})}q.tqb=function(){var a=this,b=this.kb(CV.AAa);xpc(this,b,function(){a.J=b.value})};q.pqb=function(){var a=this,b=this.kb(CV.Exa);xpc(this,b,function(){a.H=b.value})};function ypc(a,b,c,d,e){YU.call(this,1,b,a,e);this.D=c;this.F=d}x(ypc,YU);q=ypc.prototype;q.cW=n("Tables");q.Z6=function(a){return 5==a};q.HZ=function(a){return new upc(a,this.D,this.F)};q.qf=function(a){ypc.$.qf.call(this,a);this.setVisible(!a)};q.n4=function(a){return this.Pd()?(this.setVisible(!1),a):ypc.$.n4.call(this,a)};q.sea=n(2);function DV(a,b,c,d){mt.call(this,a,b,c,d,void 0,void 0,!0)}x(DV,mt);DV.prototype.qa=function(){DV.$.qa.call(this);mo(this.Aa,"waffle-assistant-toast");mo(this.kb("docs-ui-toast-content"),"waffle-assistant-toast-content")};DV.prototype.CE=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=jp(this,b);DV.$.CE.call(this,a,b,c)};DV.prototype.gi=function(a,b,c,d){this.CE(a,b,d);a=lp(this,b);this.getHandler().Ei(a,gd,v(function(){this.setVisible(!1);c()},this))};function zpc(){this.C=null}x(zpc,E);zpc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function jV(a,b,c,d){a.clear();a.C=new DV(b,c,!1,5E3);a.C.render();d&&a.C.gi("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}zpc.prototype.xa=function(){zpc.$.xa.call(this);this.clear()};function Apc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Jq("Press enter to insert formula")+'"></span></div>');return V(a)};function EV(a,b){T.call(this);this.C=a;this.D=b}x(EV,T);q=EV.prototype;q.qa=function(){this.Aa=vq(Apc,{name:this.C,title:this.D})};q.Ja=function(){EV.$.Ja.call(this);var a=this.kb("waffle-assistant-quicksum-entry-name");VU(a);this.getHandler().R(this.Aa,"keypress",this.PZb);S(this.Aa,!1)};q.getFunctionName=g("C");q.mb=function(a){il(this.kb("waffle-assistant-quicksum-entry-value"),a||"");S(this.Aa,!!a)};q.sb=function(){return To(this.Aa)};
q.PZb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new I("insert",this)))};function FV(a,b,c,d,e){T.call(this,e);this.Ga=a;this.va=b;this.O=c;this.J=d;this.D=a.C;this.Ea=new qh;this.Z=Rn(new Qn,17).build();this.V=Rn(new Qn,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}x(FV,T);
FV.prototype.Ja=function(){FV.$.Ja.call(this);this.Hi(new EV(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Hi(new EV(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Hi(new EV(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Hi(new EV(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Hi(new EV(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new hV(this.Aa,
this.va,this.D,this.O);this.C.qf(this.L);F(this,this.C);this.getHandler().R(this,"insert",this.ea).R(this.C,"formula_inserted",this.ma)};
function Bpc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(Au(a.D)){var c=Bu(a.D),d=c.lk(),e=JC(a.D);if(Ab(d,c.Tt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=Kha(e+"",h.Bc(),h.yc(),h.Xc(),h.dd());c.push(a.Ea.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){S(a.Aa,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ed(0).mb(b(d.sum));a.Ed(1).mb(b(d.average));a.Ed(2).mb(b(d.min));a.Ed(3).mb(b(d.max));
1<e?a.Ed(4).mb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):S(a.Aa,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.Cd();++d)e=a.Ed(d),a.H.push(Cpc(a,e.getFunctionName()));a.C.J=a.H}}else S(a.Aa,!1)}else S(a.Aa,!1)}else S(a.Aa,!1)}FV.prototype.qf=function(a){this.L=a;this.C&&this.C.qf(a);to(this.Aa,"waffle-assistant-quicksum-panel-readonly",a)};
FV.prototype.ea=function(a){var b=a.target;a=this.F[0];a=new L(a.left,a.Xc());b=b.getFunctionName();b=Cpc(this,b);a=new CF(Bu(this.D),a,b);this.O.C(a);this.J.vc(2624,this.V)};FV.prototype.ma=function(){this.J.vc(2624,this.Z)};function Cpc(a,b){var c=dv(a.Ga.L);a=wb(a.F,function(a){return Xu(a)});return"="+b+"("+a.join(c)+")"};function Dpc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(Nr({content:Fq("INSERT CHART"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(Nr({Je:"waffle-autovis-lightbox-close",content:Gq(""+U(it({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Fq("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(Nr({content:Gq("&#10094;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Hq('aria-label="'+Jq("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(Nr({content:Gq("&#10095;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Hq('aria-label="'+Jq("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.dKb)+"</div></div></div>");return V(a)}function Epc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function GV(a,b,c,d){T.call(this,d);this.F=a;this.D=b;this.V=c;this.H=[];this.C=new Or("",this.oa());this.Ta(this.C);this.O=new Or("",this.oa());this.Ta(this.O);this.L=new Or("",this.oa());this.Ta(this.L);this.J=new Or("",this.oa());this.Ta(this.J)}x(GV,T);q=GV.prototype;q.qa=function(){GV.$.qa.call(this);this.Aa=vq(Dpc,{dKb:this.F.length})};
q.Ja=function(){GV.$.Ja.call(this);var a=X.RI.isEnabled();this.qf(!a);a=this.kb("waffle-autovis-lightbox-close");this.C.tb(a);a=this.kb("waffle-autovis-lightbox-insert");this.O.tb(a);var b=this.kb("waffle-autovis-lightbox-previous");this.L.tb(b);b=this.kb("waffle-autovis-lightbox-next");this.J.tb(b);Fpc(this);Gpc(this,this.D,!1);this.getHandler().R(document.body,Vba,this.OVb).R(this.Aa,"keydown",this.PVb).R(Qk(),"resize",this.SVb).R(this.C,"action",this.close).R(this.O,"action",this.Ptb).R(this.L,
"action",this.RVb).R(this.J,"action",this.QVb);b=new Ot(this.Aa,this.oa());Pt(b);F(this,b);a.focus()};function Fpc(a){var b=a.kb("waffle-autovis-lightbox-content"),c=a.kb("waffle-autovis-lightbox-content-inner");a=a.kb("waffle-autovis-lightbox-page-count");var d=Ok();a=Qo(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;No(c,d,e);No(b,d,e+a.height+35)}q.qf=function(a){to(this.Aa,"waffle-autovis-lightbox-readonly",a)};
function Gpc(a,b,c){c&&Em("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Hpc(a,b):a.F[b]&&Jmc(a.F[b],v(a.Rmb,a,b),!0)}q.Rmb=function(a,b){if(!this.isDisposed()&&b){var c=this.kb("waffle-autovis-lightbox-container"),d=vq(Epc);c.appendChild(d);this.H[a]=d;nU(b,d,this.V,em);Hpc(this,a)}};function Hpc(a,b){S(a.H[a.D],!1);S(a.H[b],!0);a.L.cb(0!=b);a.J.cb(b!=a.F.length-1);var c=a.kb("waffle-autovis-lightbox-page-number");il(c,b+1);a.D=b}q.OVb=function(a){!gl(this.Aa,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.PVb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Gpc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Ipc(this);a.stopPropagation()};q.SVb=function(){var a=this.kb("waffle-autovis-lightbox-container");Xk(a);this.H=[];Fpc(this);Gpc(this,this.D,!0)};q.Ptb=function(){this.close();Mmc(this.F[this.D],2256)};q.RVb=function(){0!=this.D&&Gpc(this,this.D-1,!0);0==this.D&&this.J.Aa.focus()};q.QVb=function(){Ipc(this);this.D==this.F.length-1&&this.L.Aa.focus()};
function Ipc(a){a.D!=a.F.length-1&&Gpc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.Ad=function(){GV.$.Ad.call(this);var a=this.F[this.D];a&&a.Aa&&a.Aa.focus()};function Jpc(a,b){J.call(this);this.jc=a;this.Lb=b;this.J=a.C;this.Ke=new qh;this.Ga=lj();this.O=lj();this.Pb=this.C=this.F=this.V=this.L=this.ma=this.ea=null;this.Db=!1;this.D=null;this.Yb=!0;this.Ua=this.Wa=!1;this.Ab=this.Hb=null;this.Z=EH.getInstance();this.Ea=this.va="";this.jb=this.qb=null;b=this.jc.L.Mr();this.H=new dT;D(this.H,15,!0);D(this.H,2,eqa);a=Jqa&&!a.Pd();D(this.H,3,a);D(this.H,4,Cqa);a=bm&&(Xqa||"en"==yC(b));D(this.H,5,a);D(this.H,6,Eqa);D(this.H,7,Kqa);D(this.H,10,!1);D(this.H,
11,Wqa);D(this.H,12,Yqa);D(this.H,14,Fpa);a=new K(this);F(this,a);a.R(this.Lb,"$",this.q_b)}x(Jpc,J);var Kpc={T4b:"cu",OYa:"cs",NYa:"ce",P0a:"ls",N0a:"le"};function Lpc(a){a.Ua=!0;a.O.cancel(!0);a.ma=null;a.L=null;a.V=null;a.F=null;a.ea&&(a.ea.cancel(!0),a.ea=null)}q=Jpc.prototype;
q.update=function(a,b,c){c&&this.C&&!Bb(c,function(a){return Bha(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].Th()&&this.C.rect.contains(c[0])||(this.Ga.cancel(!0),a&&Lpc(this),this.Ga=Mpc(),this.Ga.addCallback(this.z5a,this),this.Ga.addCallback(Ga(this.A5a,b),this))};q.Ah=ca("Hb");q.q_b=function(){this.ea&&3==this.Lb.getState()&&(this.ea.kc(),this.ea=null)};function Mpc(){var a=null,b=new ej(function(){null===a||fk(a)}),a=ek(function(){b.kc()});return b}
function Npc(a,b,c,d,e){b&&(a.Ea=FH(a.Z,Ni.jxa));a.qb=d;a.jb=e;a.O.cancel(!0);a.O=lj();a.O.addCallback(a.H5a,a);a.O.addCallback(a.Z7a,a);b&&(a.O.addCallback(Ga(a.V7a,c),a),a.Hb&&!rKa(a.jc)&&Fqa?a.O.addCallback(a.thb,a):(a.O.addCallback(a.E5a,a),a.O.addCallback(a.F5a,a)),a.O.addCallback(a.U7a,a));hj(a.O,a.p_b,a)}q.p_b=function(){this.Wa=!0};
q.z5a=function(){var a=this.J.getActiveGrid();if(a){var b=Bu(this.J),c=b.lk(),d=Opc(this,c||[]),e=Opc(this,this.Pb||[]);d&&!e||!d&&!Ppc(c,this.Pb)?(this.F=null,this.Db=!0):this.Db=!1;this.Pb=c;var f=rA(b).clone();z(b.lk(),function(a){f.Vn(a)});this.D=new nh(a.Ib(),"",f)}else this.D=null};
q.A5a=function(a){this.va=FH(this.Z,Ni.ixa);var b=this.J.getActiveGrid(),c=this.D&&this.D.hd;this.C&&this.C.hd!=c&&(this.C=null);if(!b||b.Ib()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=Jy(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||vu(this.J)!=c)return null;var b=Bu(this.J),f=Qpc(this,a),h=Gy(b.D,"r"),k=b.po("r");return!b.Tt(f)||h>=f.Bc()&&KPa(b)||k<=f.Xc()&&JPa(b)?(this.dispatchEvent(new I("ls")),Ky(d,f,gc(Hg),a?void 0:500).addCallback(this.b8a,this)):
f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.Ib()==c&&null!==c?Rpc(this,a,Bu(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.Th()&&(d=b&&new nh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.V=this.L=this.ma=null;b=null!==d&&d.equals(this.C);if(b=this.Ua||this.Db||!b&&(null===this.L||null!==this.V&&null===this.F))this.Yb=this.Wa&&this.Yb||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.va&&(GH(this.Z,this.va),this.va="");b&&Npc(this,a,e,null,null)},this);return b};function Qpc(a,b){return null!=a.D?ritz_api.AssistantApi.getExploreTableRectForSelection(""+a.D.hd,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Qqa,$g):null}
q.H5a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.ma){var a=FH(this.Z,Ni.Yva);this.ma=ritz_api.AssistantApi.getAssistantConfidence(""+this.C.hd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Ke.serialize(this.H));GH(this.Z,a)}};q.b8a=function(){this.dispatchEvent(new I("le"))};q.Z7a=function(){this.dispatchEvent(new Spc(this.C,this.ma))};q.V7a=function(a){a=new Tpc(a,this.Ua);this.Ua=!1;this.dispatchEvent(a)};
q.thb=function(){if(null===this.C||null===this.C.rect||null!==this.V&&null!==this.F)return null;H(this.Ab);return 3!=this.Lb.getState()?(this.ea=new ej,this.ea.addCallback(this.LTa,this),this.ea):this.LTa()};
q.LTa=function(){var a=FH(this.Z,Ni.lxa),b=Upc(this),c=b&&!b.bPa,b=ritz_api.AssistantApi.getAssistantRequestProto(this.C.hd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Ne:[]),b=this.Ke.qd(bT.Fa(),b),c=new qh;c.Kw=!0;var b=yi(c.serialize(b)),d=new ej;this.Ab=Ri(Si(Pi(Zj(ak(this.Hb.Zf("/explore/getrecommendations").zg("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=FH(this.Z,Ni.kxa);b=Vpc(this,b.qg());GH(this.Z,
c);this.V=Dc(b,1);this.F=Dc(b,2);this.Ab=null;GH(this.Z,a);d.kc()},this),function(){this.V=[];this.F=[];d.kc()},this).rf();return d};
q.E5a=function(){function a(){d=null;ritz_api.AssistantApi.continueAssistantRecommendation(this.L)?(this.V=Dc(Vpc(this,ritz_api.AssistantApi.getAssistantRecommendations(this.L)),1),e.kc()):d=ek(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.L&&null!==this.V)return null;this.L=ritz_api.AssistantApi.newAssistantRecommender(this.Ke.serialize(this.H));this.F=this.V=null;if(this.qb&&this.jb){var b=XR(this.qb),c=XR(this.jb);ritz_api.AssistantApi.startAssistantRecommendationWithHeader(this.L,
""+b.hd,b.rect.top,b.rect.height+b.rect.top,b.rect.left,b.rect.width+b.rect.left,c.rect.top,c.rect.height+c.rect.top,c.rect.left,c.rect.width+c.rect.left)}else ritz_api.AssistantApi.startAssistantRecommendation(this.L,""+this.C.hd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var d=null,b=v(function(){null!==d&&(fk(d),this.F=this.V=this.L=d=null)},this),e=new ej(b),d=ek(a,5,this);return e};
q.F5a=function(){var a=Upc(this);a&&this.L&&null===this.F&&(this.F=a.bPa?[]:Dc(Vpc(this,ritz_api.AssistantApi.getAssistantRecommendationsOnlySelection(this.L,a.rows,a.Ne)),2))};q.U7a=function(){this.Wa=!1;var a=this.F&&0<this.F.length?this.F:this.V;""!=this.Ea&&(GH(this.Z,this.Ea),this.Ea="");this.dispatchEvent(new Wpc(this.C,a||[],this.Yb))};function Vpc(a,b){return a.Ke.qd(aT.Fa(),b)}
function Rpc(a,b,c){b=b.clone();ec(Hg,function(a){for(var d=!0;d&&b;){for(var f=Lg(a),h=0;h<(f?b.width:b.height);h++){var k=lh(b,a),l=f?b.yc():b.Bc(),k=f?c.Pf(k,l+h):c.Pf(l+h,k);if(!pRb(k)&&k.Sr()){d=!1;break}}d&&(Eha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function Ppc(a,b){return Wb(a,b,function(a,b){return eh(a,b)})}
function Upc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.Ib()!=a.C.hd)return null;for(var c=Bu(a.J).lk(),c=wb(c,Ga(dh,a.C.rect)),c=vb(c,va),d=wb(c,function(a){return new Wg(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new fg,e=new fg,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=Opc(a,c);return{rows:b.Dd(),Ne:e.Dd(),bPa:a}}
function Opc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(xha(b)||0==b.Th())return!0;a=$Ta(Bu(a.J).Z,b.top,b.left);return b.equals(a)}function Spc(a,b){I.call(this,"cu");this.C=a;this.F=b}x(Spc,I);function Wpc(a,b,c){I.call(this,"ce");this.C=a;this.F=b;this.V=c}x(Wpc,I);function Tpc(a,b){I.call(this,"cs");this.C=a;this.F=b}x(Tpc,I);function HV(a,b,c,d,e,f){KS.call(this,f);this.ea=a;this.Hb=b.C;this.Z=c;this.zc=d;this.H=e;this.va=new FV(b,c,d,e,this.oa());this.Ta(this.va);this.O=new tU(!1,"#4285f4");this.Ta(this.O);this.L=null;this.Db=this.Ab=!1;this.jb=!0;this.Wa=EH.getInstance();this.Ga=this.Ea="";this.V=Rn(new Qn,10).build()}x(HV,KS);q=HV.prototype;q.qa=function(){HV.$.qa.call(this);this.Aa=vq(this.wXa(),{JSb:bm})};
q.Ja=function(){HV.$.Ja.call(this);var a=this.kb("waffle-assistant-quicksum-panel");this.va.tb(a);a=this.kb("waffle-assistant-spinner-container");this.O.render(a);this.getHandler().R(this,"close-sidebar",this.loa).R(this.ea,Kpc.P0a,this.boa).R(this.ea,Kpc.N0a,this.aoa).R(this.ea,Kpc.OYa,this.Ana).R(this.ea,Kpc.NYa,this.zna).R(this.kb("waffle-assistant-scroll-pane"),"scroll",wgc(this.tea,10,this));a=X.RI.isEnabled();this.qf(!a)};
q.resize=function(){var a=this.kb("waffle-assistant-sidepane-content"),a=Qo(a).height,b=this.kb("waffle-assistant-spinner-container");wo(b,"margin-top",a/2-16+"px")};q.Ah=sa;function Xpc(a,b){var c=a.VO();0!=c.length&&(H(a.L),c=c.filter(function(a){return a instanceof dV}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new GV(c,b,a.H,a.oa()),a.L.render(),F(a,a.L),a.L.qf(a.Db)))}q.qf=function(a){this.Db=a;to(this.Aa,"waffle-assistant-readonly",a);this.va.qf(a);this.L&&!this.L.isDisposed()&&this.L.qf(a)};
q.setVisible=function(a){var b=this.sb();HV.$.setVisible.call(this,a);if(a&&!b){var c=Qpc(this.ea,a);c?(b=new Clc,P(b,1,jh(c,"r")),P(b,2,jh(c,"c")),c=c.Th(),P(b,3,c),c=new pwa,Ii(c,4,b),b=Ewa(Fwa(this.V),c).build()):b=this.V;this.Ga=FH(this.Wa,Ni.qxa,!1,b);this.O.setActive(!0);IV(this)}a||this.o4(!0)};q.boa=function(){this.sb()&&(this.o4(!0),this.O.setActive(!0),IV(this))};q.aoa=function(){this.sb()&&(this.O.setActive(!1),IV(this))};
q.Ana=function(a){this.sb()&&(this.H.C(2775,this.V),this.o4(void 0,a.C,a.F),this.Dpa()||this.O.setActive(!0),IV(this),this.jb=!1)};q.zna=function(a){if(this.sb()){this.H.C(2776,this.V);var b=a.F;0<b.length&&(this.Ea=FH(this.Wa,Ni.oxa));this.o4(!1);this.O.setActive(!1);this.vXa(b,a.C);a=a.V;b=this.VO();0<b.length&&this.Ab&&(b[b.length-1].Lb=!0);this.Ab=!1;IV(this);this.xXa(a);this.tea()}};
function IV(a){var b=a.Dpa(),c=To(a.kb("waffle-assistant-quicksum-panel")),d=a.O.tc(),b=b||c||d;a=a.kb(a.WHa());S(a,!b)}q.OIa=Jf;function Ypc(a){return a.kb("waffle-assistant-scroll-pane").scrollTop+Qo(a.kb("waffle-assistant-sidepane-content")).height}q.Lc=sa;q.nsa=sa;q.Pd=g("Db");q.loa=function(){this.H.vc(2226,this.V)};q.TIb=function(){""!=this.Ea&&(GH(this.Wa,this.Ea),this.Ea="");""!=this.Ga&&(GH(this.Wa,this.Ga),this.Ga="");this.jb||(this.H.vc(2777,this.V),this.jb=!0)};function Zpc(a){a=a||{};return V(U(US(Eq({title:Gq(""+$pc()),Kk:Gq('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+V('<div class="waffle-assistant-empty-list-old" style="display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>')+
'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:Fq("autovis"),DV:Fq("waffle-assistant-sidepanel"),M3:Fq("waffle-assistant-title"),VQ:Fq("waffle-assistant-sidepane-content")},a))))}
function aqc(a){a=a||{};var b=V,c=Gq('<div class="waffle-assistant-replaceable-title">'+$pc()+"</div>"),d,e;e=a||{};d=V;e=e||{};var f;f=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(amc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');f=e.JSb?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=d('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>');return b(U(US(Eq({title:c,Kk:Gq(""+d),id:Fq("autovis"),DV:Fq("waffle-assistant-sidepanel"),M3:Fq("waffle-assistant-title"),VQ:Fq("waffle-assistant-sidepane-content")},a))))}
function $pc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(amc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function JV(a,b,c,d,e,f,h,k){HV.call(this,a,b,c,d,e,k);this.Yb=f;this.qb=b;this.ma=new T(this.oa());this.Ta(this.ma);this.J=new zpc;F(this,this.J);this.D=[];this.F=null;this.Ua=new Or("",k,4);aq(this.Ua,2);this.Ta(this.Ua);this.jc=h}x(JV,HV);
var KV={YA:"waffle-assistant-scroll-pane-feature-content",r_a:"waffle-assistant-empty-list",H_a:"waffle-assistant-features",F0a:"waffle-assistant-empty-list-learn-more",Ufa:"waffle-assistant-expanded-panel",pza:"waffle-assistant-replaceable-title",ksc:"waffle-assistant-scroll-pane",RJ:"waffle-assistant-title"},bqc={defaultHelpArticleId:"6280499"};q=JV.prototype;q.wXa=function(){return aqc};q.WHa=n("waffle-assistant-empty-list");
q.Ja=function(){var a=this;JV.$.Ja.call(this);this.ma.tb(this.kb(KV.Ufa));VU(this.C.Aa,"Close");if(Fpa){var b=new ypc(this.H,this.J,this.Z,this.jc,this.oa());this.Ta(b);this.D.push(b)}b=this.qb.L.Mr();bm&&(Xqa||"en"==yC(b))&&(b=new yV(this.Yb,this.Z,this.Hb,this.zc,this.H,this.J,this.qb,this.oa()),this.Ta(b),this.D.push(b));if(Jqa||Kqa)b=new rpc(this.H,this.J,this.oa()),this.Ta(b),this.D.push(b);b=new gV(this.Hb,this.Z,this.H,this.J,this.oa());this.Ta(b);this.D.push(b);var c=this.kb(KV.H_a);z(this.D,
function(b){b.render(c);a.ma.Ta(b.C,!0)});this.Ua.tb(this.kb(KV.F0a));this.getHandler().R(this.Ua,"action",this.o_b);cqc(this)};q.o_b=function(){Q.Rn.Qc(bqc)};q.vXa=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var f=Ec(a[e],1);this.D[c].Z6(f)&&d.push(a[e])}0<d.length?this.D[c].rva(d,b):this.D[c].bW(!0)}};q.xXa=function(){z(this.D,function(a){imc(a)})};q.o4=function(a,b,c){z(this.D,function(d){d.bW(a,b,c)})};q.Dpa=function(){return!!Bb(this.D,function(a){return a.zoa()})};
q.tea=function(){var a=this,b=Ypc(this);z(this.D,function(c){a.F&&a.F!=c||(c instanceof gV&&a.getHandler().Kc(c,"Qe",a.TIb),b=c.n4(b))})};q.VO=function(){if(this.F)return this.F.C.C;var a=[];z(this.D,function(b){Pb(a,hmc(b))});return a};q.qf=function(a){JV.$.qf.call(this,a);cqc(this)};q.Ah=function(a){z(this.D,function(b){b.Ah(a)})};q.nsa=function(){var a=this.kb(KV.pza),b=this.kb(KV.RJ);Po(b,Qo(a).height)};
q.Lc=function(){this.oa();var a=this.kb(KV.YA),b=this.kb(KV.pza);this.kb(KV.RJ);var c=this.ma.Aa;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,S(a,!0),S(c,!1),sq(b,$pc),ho(b,"label"),this.resize();else if(this.F=Bb(this.D,function(a){return a.tc()}))S(a,!1),S(c,!0),this.F.C.setVisible(!0),jmc(this.F,b),jo(b,this.F.cW());this.nsa();ek(function(){var a=fu;a&&a.dispatchEvent("resize");this.tea()},300,this)};
q.setVisible=function(a){var b=this.sb();JV.$.setVisible.call(this,a);a&&!b&&dqc(this,!0);a||this.J.clear()};q.loa=function(){JV.$.loa.call(this);this.F&&this.Lc()};q.boa=function(){JV.$.boa.call(this);dqc(this,!0)};q.aoa=function(){JV.$.aoa.call(this);dqc(this,!1)};q.Ana=function(a){JV.$.Ana.call(this,a);dqc(this,!0,a.C)};q.zna=function(a){JV.$.zna.call(this,a);dqc(this,!1)};function cqc(a){z(a.D,function(b){b.qf(a.Pd())})}q.OIa=g("D");function dqc(a,b,c){z(a.D,function(a){c||emc(a.C,b)})};function eqc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base docs-ui-unprintable '+W(a.Gg)+'"><div class="docs-explore-promo-content">'+(a.JG?'<div class="docs-explore-promo-header">'+U(null==(b=a.JG)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.XZ)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.wK?U(Nr({Je:"docs-explore-promo-button docs-explore-promo-continue-button",content:Gq(""+U(a.wK)),style:4})):"")+(a.QK?U(Nr({Je:"docs-explore-promo-button docs-explore-promo-close-button",
content:Gq(""+U(a.QK)),style:4})):"")+"</div></div></div>"+(a.lOa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(amc({color:a.lOa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function fqc(a,b){T.call(this,b);this.F=new Or("",b);this.Ta(this.F);this.C=new Or("",b);this.Ta(this.C);this.D=new Or("",b);aq(this.D,2);this.Ta(this.D);this.H=a;Lua([Q.efa,Q.ffa,Q.nxa],!0)}x(fqc,T);q=fqc.prototype;q.qa=function(){this.Aa=vq(eqc,this.H)};
q.Ja=function(){fqc.$.Ja.call(this);var a=this.Gb("docs-explore-promo-continue-button");a&&this.F.tb(a);(a=this.Gb("docs-explore-promo-close-button"))&&this.C.tb(a);(a=this.Gb("docs-explore-promo-icon"))&&this.D.tb(a);this.getHandler().R(this.F,"action",this.fLa).R(this.C,"action",this.Z8a).R(this.D,"action",this.dtb)};q.show=function(a){Q.nxa.Qc();this.render(a)};q.fLa=function(a){Q.efa.Qc();a.stopPropagation()};q.Z8a=function(a){Q.ffa.Qc();a.stopPropagation()};q.dtb=function(a){this.fLa(a)};function gqc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.JG)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.XZ)+"</p>"+(a.wK?U(Nr({Je:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:Gq(""+U(a.wK)),style:4})):"")+(a.QK?U(Nr({Je:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:Gq(""+U(a.QK)),
style:4})):"")+"</div>")};function LV(a,b,c){NF.call(this,a,c);this.L=new Or("",c);this.C=new Or("",c);a=vq(gqc,b);this.setContent(a);this.Sg("docs-promo-bubble");this.setPosition(0,0);qs(this);ps(this,!1);this.zw=!1}x(LV,NF);LV.prototype.Ja=function(){LV.$.Ja.call(this);var a=this.Gb("waffle-assistant-walkthrough-promo-continue-button");a&&this.L.tb(a);(a=this.Gb("waffle-assistant-walkthrough-promo-close-button"))&&this.C.tb(a);this.getHandler().R(this.L,"action",this.H).R(this.C,"action",this.O)};
LV.prototype.H=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};LV.prototype.O=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function hqc(a){var b=Mk("waffle-assistant-chart-preview",void 0);LV.call(this,b,{JG:"See the big picture",XZ:"Data visualizations and text summaries make it easier to spot trends and outliers",wK:"Learn more",QK:"Got it"},a)}x(hqc,LV);var iqc={defaultHelpArticleId:"6280499"};hqc.prototype.H=function(a){Q.Rn.Qc(iqc);hqc.$.H.call(this,a)};function jqc(a,b){var c=Mk("waffle-assistant-answers-input",void 0),d=new gu;a="Interested in the "+(d.kf("b")+(a+(d.nf("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={JG:"Find answers in a snap",XZ:d.format(a),wK:"Next",QK:"Dismiss"};LV.call(this,c,d,b)}x(jqc,LV);function kqc(a,b){a={Gg:"waffle-assistant-entry-promo",JG:"Get insights instantly",XZ:bm&&"en"==yC(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",wK:"Check it out",QK:"Dismiss",lOa:"#0F9D58"};fqc.call(this,a,b)}x(kqc,fqc);function lqc(a){var b=Mk("waffle-assistant-banding-color-picker-container",void 0);LV.call(this,b,{JG:"Make it pop",XZ:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",wK:"Next",QK:"Dismiss"},a)}x(lqc,LV);function mqc(a,b,c,d,e,f,h,k,l){QS.call(this,b,h);this.va=a;this.C=b;this.Z=c;this.Ga=d;this.qb=e;this.ea=f;this.Ua=k;this.O=c.C;this.Wa=this.ma=!1;this.H=l;this.F=null;this.Ke=new qh;this.L=null;a=zu(this.qb);this.Bf().R(this.Ga,"selectionChange",this.s_b).R(this.O,"oa",this.r_b).R(a,"Ha",this.Yvb).R(this.C,"Ne",this.elb).R(this.C,"Me",this.dlb).R(this.C,"Se",this.bAb).R(this.C,"Pe",this.tmb).R(this.C,"Re",this.Qtb).R(this.C,"Ve",this.UCb).R(this.C,"Te",this.HBb).R(this.C,"Oe",this.Alb).R(this.C,
"We",this.t_b).R(this.va,"cu",this.Tnb).R(this.C,"Ue",this.LBb);Nn(this.V,X.RI,$m,this.Ttb).subscribe(X.aP,"action",this.xlb).subscribe(X.D4,"action",this.HCb).subscribe(X.Iea,"action",this.zCb);X.C4.cb(!0);a=new Dlc;P(a,6,nqc());b=new dn;Ii(b,58,a);this.J=Rn(Sn(new Qn,b),10).build();this.jb=EH.getInstance();this.Ea=FH(this.jb,Ni.mxa);ek(Ga(this.rZ,!1),100,this)}x(mqc,QS);q=mqc.prototype;q.Dh=function(){return X.Kea};q.Vv=function(){return X.$va};
q.qv=function(a){mqc.$.qv.call(this,a);X.D4.cb(a);this.rZ(!1);!this.ma&&a&&(this.ma=!0,Oqa&&VC(this.Ua,"ritz-DisplayExploreV2Promo",!1))};q.U0=function(a){this.C.nsa();ek(function(){mqc.$.U0.call(this,a)},300,this)};q.Ah=function(a){this.C.Ah(a);this.va.Ah(a)};q.xlb=function(){var a=this.C.sb();this.Dh().setVisible(!a);a?this.H.vc(2226,this.J):(this.C.focus(),this.H.vc(2253,this.J))};q.zCb=function(){this.C.sb()||this.qv(!0)};q.HCb=function(a){Xpc(this.C,a)};q.s_b=function(){this.rZ(!0)};
q.rZ=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.L&&b[0].equals(this.L)){this.L=null;return}}var c=this.C;c.sb()&&(Bpc(c.va),IV(c));this.va.update(!a,this.C.sb(),b)};
q.Tnb=function(a){""!=this.Ea&&(GH(this.jb,this.Ea),this.Ea="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Th()>=Rqa&&jh(c,"r")>=Tqa&&jh(c,"c")>=Uqa&&c.Th()<=Sqa)&&.6<=b;d!==this.Wa&&(this.Wa=d,X.C4.Qc(d),!d&&this.F&&(H(this.F),this.F=null));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=a.rect.Th(),c=ritz_api.RitzModelApi.isFormsRegion(""+a.hd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=Fqa&&!this.C.sb()&&!this.ma&&d&&e&&!rKa(this.Z),c=Gqa&&c,e=Hqa&&this.Z.Pd();d&&(c||
e)?(d=new Dlc,P(d,1,b),P(d,2,c),P(d,3,e),P(d,5,Yqa),P(d,6,nqc()),c=new dn,Ii(c,58,d),c=Sn(Rn(new Qn,10),c).build(),this.WBa(c),c=!0):c=!1}else c=!1;if(c=!c)if(c=Oqa){if(b=.6<=b&&!this.C.sb()&&!this.ma&&!this.F&&this.Ua.C["ritz-DisplayExploreV2Promo"].Va()&&a)b=a.rect,b=ritz_api.AssistantApi.hasBandingSuggestions(a.hd+"",b.Bc(),b.Xc(),b.yc(),b.dd());c=b}c&&(a=this.Z.L.Mr(),this.F=new kqc(a),F(this,this.F),this.F.show(),this.V.subscribe(Q.efa,"action",this.Kqb).subscribe(Q.ffa,"action",this.hoa),VC(this.Ua,
"ritz-DisplayExploreV2Promo",!1),this.H.vc(2788,this.J))}};q.WBa=function(a){this.C.Ab=!0;var b=KVa(Bu(this.O));ISb.C||b||(a=a||this.J,this.Dh().setVisible(!0),this.H.vc(2225,a),this.H.vc(2253,this.J),ek(Ga(this.W5a,a),5E3,this))};q.W5a=function(a){this.C.sb()||this.H.vc(2752,a)};function nqc(){switch(Vqa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}q.hoa=function(){H(this.F);this.F=null};
q.Kqb=function(){H(this.F);this.Dh().setVisible(!0);this.C.focus();this.Bf().Kc(this.C,"Qe",v(function(){var a;a:{this.C.sb();a=this.Z.L.Mr();a=bm&&(Xqa||"en"==yC(a));for(var b=!1,c=!1,d=!1,e=this.C.VO(),f=0;f<e.length;f++)if(e[f]instanceof lV?b=!0:e[f]instanceof zV?c=!0:e[f]instanceof dV&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.GMa():this.hoa()},this));this.H.vc(2253,this.J)};
q.GMa=function(){this.C.sb();H(this.F);var a=null;this.F instanceof kqc?(a=this.Z.L.Mr(),bm&&(Xqa||"en"==yC(a))?(a=this.C.OIa(),a=Soc(Bb(a,function(a){return a instanceof yV}).O).toLowerCase(),a=new jqc(a)):a=new lqc):this.F instanceof jqc?a=new lqc:this.F instanceof lqc&&(a=new hqc);if(this.F=a)F(this,this.F),this.F.render(),this.Bf().Kc(this.F,"promo-dismiss",this.hoa).Kc(this.F,"promo-continue",this.GMa)};q.Alb=function(){this.C.Lc()};
q.t_b=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.Ib(),10);this.L=th(c);this.ea.C(new ATb(d));ppc(b,c);this.H.vc(a.Bk(),this.J)};q.r_b=function(){Au(this.O)?(this.C.cb(!0),this.rZ(!1)):(this.Dh().setVisible(!1),this.C.cb(!1))};q.Ttb=function(){this.C.qf(!X.RI.isEnabled())};q.Yvb=function(a){this.rZ(!1,hHa(a))};
q.elb=function(a){var b=Bu(this.O),c=""+b.Fc(),d=[],e=egc(b);if(e){var b=new Ue,f=Ec(e,2);D(b,3,f);f=Ec(e,2);D(b,2,f);e=Ec(e,1);D(b,1,e);d.push(b)}b=a.C.Db;for(e=0;e<b.length;e++)f=new Ue,D(f,2,b[e]),d.push(f);this.ea.C(new eT(d,c));this.H.C(a.Bk(),this.J)};
q.dlb=function(a){var b=a.C,c=Ngc(b.C),d=B(b.D,4,0),e=c.rv?c.Ex:null,f=c.C?c.jx:null,h=parseInt(d.Ib(),10),k=oqc(d);this.L=th(d);k?this.ea.C(new PS(k,h,this.L,e,c.Xs,c.Nt,f)):this.ea.C(new NS(h,this.L,e,c.Xs,c.Nt,f));d=new sgc;P(d,1,1);c=new eS;b=B(b.D,2);P(c,2,b);Ii(c,5,d);b=new dn;Ii(b,46,c);b=Sn(Rn(new Qn,10),b).build();this.H.C(a.Bk(),b)};q.bAb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.Ib(),10),d=oqc(b);this.L=th(b);this.ea.C(new OS(d,c));ppc(a,b)};
q.LBb=function(a){var b=a.C,c=Bu(this.Z.C),d=c.Fc();a=rh(THa(b.J,c),d);b=rh(THa(b.H,c),d);c=this.va;Lpc(c);Npc(c,!0,!0,a,b)};function oqc(a){var b=a.Ib();a=th(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.Bc(),a.yc(),a.Xc(),a.dd(),7,!1);return 0<b.length?b[0]:null}q.tmb=function(a){yA(Bu(this.O),a.F);this.H.C(a.Bk(),this.J)};
q.UCb=function(a){var b=a.C;a=a.Bk();if(b instanceof iV||b instanceof lV)this.H.C(a,this.J);else{var c=this.C.VO(),d=new eS,e=B(b.D,2),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new dn;Ii(e,46,d);if(b instanceof dV){(d=b.J)?(b=pqc(this,b,d),b=Yjc(b,d,d.Nf)):b=null;if(!b)return;Ii(e,39,b)}else if(b instanceof fV){var f=b.D,c=new Llc;if(b instanceof fV)b=1;else throw Error("Unknown text analysis card type.");f=Dc(B(f,8),20).slice(0,10);P(c,2,f||[]);P(c,1,b);Ii(d,3,c)}e=Sn(Rn(new Qn,10),e).build();this.H.C(a,
e)}};q.HBb=function(){this.C.Lc()};
q.Qtb=function(a){var b=a.V;if(b){var c=Bu(this.O),d=a.$e();d||(d=KA(this.Ga).Fd().C.$e());var e=16,f=16,h=a.Wa;h&&(e=h.x,f=h.y);h=xZa(this.Z.J);c={oid:null,ar:FA(c,d.y),ac:GA(c,d.x),x:e,y:f,h:Vx.height,w:Vx.width,p:{context:{chartName:"Chart "+(h+1)}}};c=new oC(vu(this.O)||0,c,!1,!1);d=b.Nf;e=new yl(d);f=Il(e,"headers");f=null!=f&&Ba(f)&&Va(f)?parseInt(f,10):-1;c.Ga=f;c.L=0;f="1"==Il(e,"transpose");c.ma=f;c.H=f?"ROWS":"COLS";f=Il(e,"range");f=igc(uS(f,","),this.O);c.YH(f);aS(c,b);(e=Il(e,"dt"))&&
iZa(c,this.Ke.qd(ff.Fa(),JSON.parse(decodeURIComponent(e))));this.Ga.dispatchEvent(new bD("objectRequest"));this.ea.C(new AF(this.Z,c));e=qqc(this,b,a.ma,a.De());e.yl(c.getId()||0);$jc(this.H,a.Bk(),e,10,b,d)}};function pqc(a,b,c){var d=a.C.VO().filter(function(a){return a instanceof dV});return qqc(a,c,d.indexOf(b),b.J&&b.J.De())}
function qqc(a,b,c,d){var e=new kU;a=a.C.VO().filter(function(a){return a instanceof dV}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Xjc(e,b.getChartType());e.F=d?d.clone():null;return e};function rqc(a,b){bV.call(this,a,b)}x(rqc,bV);q=rqc.prototype;q.JA=function(a){a()};q.zA=sa;q.zz=n("assistantPivotTableFeedback");q.dG=n(2632);q.cG=n(2631);function sqc(a,b,c,d,e,f,h,k){HV.call(this,a,b,c,d,e,k);this.J=new T(this.oa());this.Ta(this.J);this.F=null;this.Ua=new K;F(this,this.Ua);this.D=[];this.qb=null;this.ma=!0}x(sqc,HV);var tqc={QYa:"waffle-assistant-card-holder",YA:"waffle-assistant-sidepane-content",h_a:"waffle-assistant-dragger-card",g_a:"waffle-assistant-dragged-card",r_a:"waffle-assistant-empty-list-old",$Aa:"waffle-assistant-visible"};q=sqc.prototype;q.wXa=function(){return Zpc};q.WHa=n("waffle-assistant-empty-list-old");
q.Ja=function(){sqc.$.Ja.call(this);var a=this.kb(tqc.QYa);this.J.tb(a)};q.setVisible=function(a){var b=this.sb();sqc.$.setVisible.call(this,a);a&&!b&&(this.ma=!0)};
q.vXa=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=B(c,1),e=null;switch(d){case 0:"WordCloud"==B(c,8).getChartType()?e=new fV(c,this.oa()):e=new dV(c,this.Hb,this.Z,this.H,null,this.oa());break;case 1:e=new rqc(c,this.oa());break;case 2:e=new AV(c,this.oa());break;case 4:e=new zV(c,this.H,this.oa());break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.Cd();e.V=c;this.J.Ta(e,!0);if(X.RI.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new uqc,mhc(this.F,this.J.Aa),
this.F.V=10,this.F.O=Wa(tqc.h_a).split(" "),this.F.va=!0,this.F.Usa(tqc.$Aa),this.F.J=!1,this.F.gf(),this.Ua.R(this.F,"beforedragstart",v(this.u_b,this)).R(this.F,"dragstart",v(this.Fm,this)).R(this.F,"beforedragend",v(this.Klb,this));var c=this.F,d=this.J.Aa,f=e.Aa;t(void 0)?Roa(d,f,void 0):d.appendChild(f);nhc(c,f)}0!=this.D.length&&e.getHandler().R(this.D[this.D.length-1],"content-rendered",e.hF);this.D.push(e)}};q.xXa=function(a){0<this.D.length&&this.D[0].hF();if(a||this.ma)this.ma=!1,vqc(this)};
function vqc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Aa;Eo(d,0,1E3);b+=Qo(d).height}b=Math.max(Qo(a.kb("waffle-assistant-sidepane-content")).height,b);Po(a.J.Aa,b);for(b=0;b<a.D.length;b++)ek(Ga(a.q4a,a.D[b]),100*b,a);ek(function(){Po(this.J.Aa,"auto")},100*a.D.length,a)}}q.q4a=function(a){!a.isDisposed()&&this.isEnabled()&&(new xS(a.Aa,[0,1E3],[0,0],100)).play()};
q.o4=function(){this.Ua.Oc();H(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.Dc()&&this.J.removeChild(b,!0);H(b)}this.D=[]};q.Dpa=function(){return 0<this.D.length};q.tea=function(){for(var a=Ypc(this),b=0,c=0;c<this.D.length;c++)b<a?(XU(this.D[c],!0),b+=Qo(this.D[c].Aa).height):XU(this.D[c],!1)};q.u_b=function(a){var b=tb(this.J.Aa.childNodes,a.C),b=this.J.Ed(b);b.QOa()?this.qb=b:a.preventDefault()};q.Fm=function(a){mo(a.F,tqc.g_a)};
q.Klb=function(a){var b=Fo(a.F),c=KA(this.Z).Zd();if(Xg(lF(c,"page",!1,!1)).contains(b)){var d=jF(c,b.x,b.y,"page"),c=nF(c,bh(d),"page");this.qb.R$(d,new L(b.x-c.left,b.y-c.top))}a.V.Ax(null,!0);a.preventDefault();this.qb=null};q.VO=g("D");function uqc(){fT.call(this)}x(uqc,fT);uqc.prototype.kma=function(a){a=uqc.$.kma.call(this,a);var b=wb(a.querySelectorAll("clippath"),function(a){return a.id});wqc(a,b);return a};
function wqc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];Ba(c)&&ab(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=bl(a);for(c=0;c<a.length;c++)wqc(a[c],b)};function xqc(){E.call(this)}x(xqc,sm);xqc.prototype.C=function(){return Jpc};xqc.prototype.F=function(){return Jqa||Kqa||bm?JV:sqc};xqc.prototype.D=function(){return mqc};zm("assistant",xqc);
