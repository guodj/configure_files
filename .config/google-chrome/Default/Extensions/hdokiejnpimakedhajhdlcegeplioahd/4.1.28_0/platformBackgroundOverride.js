(function(c){var h={},j={},f=window.cs={};c.initialize=function(){chrome.runtime.onConnect.addListener(function(a){if(0===a.name.indexOf("requestPort")){var b=function(b){return!a.disconnected?(a.postMessage(b),!0):!1},c=function(a){return b({backgroundResponse:a})},d=a.sender&&a.sender.tab?a.sender.tab.id:null,g=LPMessaging.getNewMessageSourceID(),l=a.sender?0===a.sender.frameId:!1,m=null;h[g]=a;if(d){var e=Interfaces.createInstance(Interfaces.ContentScriptInterface,{direct:!1,context:"background",
requestFunction:function(a){return b({contentScriptRequest:a,sourceFrameID:0})}});f.hasOwnProperty(d)||(f[d]=new TabInterface);l?(j[d]=g,f[d].setTop(e)):"requestPort"===a.name&&f[d].addFrame(g,e);m={additionalArguments:{url:a.sender.tab.url,id:d}}}a.onMessage.addListener(function(a){if(a.backgroundRequest)LPMessaging.handleRequest(Interfaces.BackgroundInterface,a.backgroundRequest,c,m);else if(a.contentScriptResponse&&0===a.frameID)LPMessaging.handleResponse(a.contentScriptResponse);else{var b=h[a.frameID];
b&&b.postMessage(a)}});a.onDisconnect.addListener(function(){h[g].disconnected=!0;delete h[g];delete j[g];var a=f[d];a&&(l?a.setTop(null):a.removeFrame(g),a.isEmpty()&&delete f[d])});b({initialization:{frameID:g,topFrameID:j[d]}})}})};c.openPopoverDialog=function(a){c.openTabDialog.apply(c,arguments)};c.refreshGroupNames=function(){};c.closePopovers=function(){chrome.extension.getViews({type:"popup"}).forEach(function(a){a.close()})};var k={},e=function(a,b){b.loadHandler&&(k[a.id]=function(){delete k[a.id];
b.loadHandler(a,b)})};chrome.tabs.onUpdated.addListener(function(a,b){var c=k[a];c&&"complete"===b.status&&c()});c.openDialogLoadHandler=function(a,b){return function(c,d){chrome.tabs.sendMessage(c.id,{name:a,params:b,tabId:c.id},function(){if(d.closeHandler){var a;a:{var b=chrome.extension.getViews({type:"tab",windowId:c.windowId});if(1===b.length)a=b[0];else{for(var e=0,f=b.length;e<f;++e){var h=b[e];if(h.tabId===c.id){a=h;break a}}a=null}}a&&a.addEventListener("beforeunload",function(){d.closeHandler(a)})}})}};
c.openDialogWindow=function(a){var b=a.features||{};b.url=a.url;b.type=chrome.windows.CreateType.POPUP;chrome.windows.create(b,function(b){e(b.tabs[0],a)})};c.openTab=function(a){chrome.tabs.create({url:a.url},function(b){e(b,a)})};c.openWindow=function(a){chrome.windows.create({url:a.url},function(b){e(b.tabs[0],a)})};c.openSame=function(a){chrome.tabs.update(null,{url:a.url},function(b){e(b,a)})};c.navigateTab=function(a){chrome.tabs.update(a.tabId,{url:a.url,active:!0},function(b){e(b,a)})};c.activateDialog=
function(a){chrome.windows.update(a.windowId,{focused:!0});chrome.tabs.update(a.id,{active:!0})};c.openLoginDialog=function(){c.openTabDialog("loginSimple")};c.openCreateAccountDialog=function(a){c.openTabDialog("createAccountSimple",a)}})(LPPlatform);
