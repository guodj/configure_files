(function(a){a.openLoginDialog=function(){a.openTabDialog("login")};a.openCreateAccountDialog=function(){openURL(getchromeurl("welcome.html"))};var f=null;a.getBackgroundInterface=function(){null===f&&(f=Interfaces.createInstance(Interfaces.BackgroundInterface,{source:window,direct:!0}));return f}})(LPPlatform);
(function(a){a.getBigIcons=function(d){var a=opendb();createDataTable(a);if(a){var e=function(a,b){d(0<b.rows.length&&null!==b.rows.item(0).data?b.rows.item(0).data:"")};if(g_indexeddb){var c={rows:{item:function(a){return this[a]},length:0}};a.transaction("LastPassData","readonly").objectStore("LastPassData").openCursor(IDBKeyRange.only(db_prepend(g_username_hash)+"_bigicons")).onsuccess=function(a){(a=a.target.result)?(c.rows[c.rows.length]=a.value,c.rows.length++,a["continue"]()):e(null,c)}}else a.transaction(function(a){a.executeSql("SELECT * FROM LastPassData WHERE username_hash=? AND type=?",
[db_prepend(g_username_hash),"bigicons"],e,function(a,d){console_log(d)})})}};a.saveBigIcons=function(a){var b=opendb();createDataTable(b);b&&(g_indexeddb?b.transaction("LastPassData","readwrite").objectStore("LastPassData").put({username_hash:db_prepend(g_username_hash),type:"bigicons",data:a,usertype:db_prepend(g_username_hash)+"_bigicons"}):b.transaction(function(b){b.executeSql("REPLACE INTO LastPassData (username_hash, type, data) VALUES (?, ?, ?)",[db_prepend(g_username_hash),"bigicons",a],
function(){console_log("server.js : inserted")},function(a,d){console_log(d)})}))};a.updateBigIcons=function(){};var f=function(a,b){for(var e in a){var c=b[e];c&&(c.group=a[e])}};a.refreshGroupNames=function(a){a&&(f(a.sites,g_sites),f(a.notes,g_securenotes),f(a.applications,g_applications))};a.useDialogWindows=function(){return Preferences.get("htmlindialog")};var h={},j=function(a,b){return function(){a.apply(this,arguments);b.apply(this,arguments)}};a.openTabDialog=function(d,b){var e=d+(b?"-"+
JSON.stringify(b):""),c=h[e];if(c)a.activateDialog(c);else{var g={dialogWindow:a.useDialogWindows()&&(void 0===b||null===b||!b.virtualKeyboard)},c={url:getchromeurl("tabDialog.html?dialog="+d),loadHandler:j(a.openDialogLoadHandler("openDialog",[d,a.copyDataIfEdge(b),g]),function(a){h[e]=a}),closeHandler:function(){delete h[e]},tabId:b&&b.tabId?b.tabId:void 0};if(c.tabId)a.navigateTab(c);else if(g.dialogWindow){var f=Preferences.get("dialogSizePrefs"),g=f[d];c.features={height:g?g.height:600,width:g?
g.width:800,left:g?g.left:0,top:g?g.top:0};c.features.width>window.screen.availWidth&&(c.features.width=window.screen.availWidth,c.features.left=0);c.features.height>window.screen.availHeight&&(c.features.height=window.screen.availHeight,c.features.top=0);c.closeHandler=j(c.closeHandler,function(a){f[d]={height:a.outerHeight,width:a.outerWidth,left:a.screenLeft||a.screenX,top:a.screenTop||a.screenY};Preferences.set("dialogSizePrefs",f);delete h[e]});a.openDialogWindow(c)}else switch(Preferences.get("openpref")){case "tabs":a.openTab(c);
break;case "windows":a.openWindow(c);break;case "same":a.openSame(c)}}};a.stringifyFeatures=function(a){var b=[],e;for(e in a)b.push(e+"="+a[e]);return b.join(",")};a.doAjax=function(a){LPServer.ajax(a)};a.ajax=function(d){isOffline()?d.error&&d.error(null,null,"offline"):a.doAjax(d)};a.isEdge=function(){return is_edge()};a.copyDataIfEdge=function(d){return a.isEdge()&&"undefined"!==typeof d?JSON.parse(JSON.stringify(d)):d};var k=a.setUserPreference;a.setUserPreference=function(a,b){k(a,b);g_userprefs_changed[a]=
b};var l=a.setGlobalPreference;a.setGlobalPreference=function(a,b){l(a,b);g_gblprefs_changed[a]=b};a.writePreferences=function(){lpWriteAllPrefs()};a.closePopovers=function(){}})(LPPlatform);
