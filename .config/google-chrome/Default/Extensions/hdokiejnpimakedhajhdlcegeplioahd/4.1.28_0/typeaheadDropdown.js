TypeaheadDropdown=function(a,b,d){this.hint=this.hintElement=null;this.autoCompleteBlurs=LPTools.getOption(d,"autoCompleteBlurs",!0);DropdownInput.call(this,a,b,d);var c=this;c.getElement().bind("keydown",function(a){if(c.dropdownEnabled)switch(a.keyCode||a.which){case 9:c.autocomplete(a);break;case 27:c.shown&&(c.hide(),a.stopPropagation(),a.preventDefault())}});c.optionFocusHandler=function(a){a=c.options[c.getDropdownValue(a)];var b=c.inputObject.getValue();c.queryMatches(a,b)?c.setHint(b,a):c.clearHint()}};
TypeaheadDropdown.prototype=Object.create(DropdownInput.prototype);TypeaheadDropdown.prototype.constructor=TypeaheadDropdown;
TypeaheadDropdown.prototype.build=function(){DropdownInput.prototype.build.apply(this,arguments);var a=$(LPTools.createElement("div","dropdownHint"));this.hintElement=LPTools.createElement("span");a.append(this.hintElement);var b=this.inputObject.getElement(),d=$(LPTools.createElement("div","relative"));b.before(d);d.append(a);d.append(b);b.prop("readonly",!1);a.css({"line-height":b.css("height"),"padding-left":b.css("padding-left"),"padding-right":b.css("padding-right"),margin:"0"});"border-box"===
b.css("box-sizing")&&a.css({left:b.css("border-left-width"),right:b.css("border-right-width")})};TypeaheadDropdown.prototype.autocomplete=function(a){this.hint&&(this.setValue(this.hint.value),this.autoCompleteBlurs||(a.preventDefault(),a.stopPropagation()))};TypeaheadDropdown.prototype.getDropdownClass=function(){return"typeaheadDropdown"};TypeaheadDropdown.prototype.clear=function(){DropdownInput.prototype.clear.apply(this,arguments);this.dynamic&&this.setOptions([])};
TypeaheadDropdown.prototype.default=function(){DropdownInput.prototype.default.apply(this,arguments);this.updateDropdown("")};TypeaheadDropdown.prototype.hide=function(){DropdownInput.prototype.hide.apply(this);this.clearHint()};TypeaheadDropdown.prototype.setHint=function(a,b){0<a.length?(this.hintElement.textContent=a+b.label.substring(Math.min(a.length,b.label.length)),this.hint=b):this.clearHint()};TypeaheadDropdown.prototype.clearHint=function(){this.hintElement.textContent="";this.hint=null};
TypeaheadDropdown.prototype.handleKeypress=function(a){this.updateDropdown(this.inputObject.getValue()+a)};TypeaheadDropdown.prototype.handleDelete=function(){this.updateDropdown(this.inputObject.getValue())};TypeaheadDropdown.prototype.handleDownArrow=function(){this.show();LPTools.setNavIndex(0)};DropdownInput.prototype.getKeyboardNavigationFocusHandler=function(){return this.optionFocusHandler};
TypeaheadDropdown.prototype.updateDropdown=function(a){var b=!1,d=!1,c=this.dropdownElement.children().first();c.empty();for(var f in this.options){var e=this.options[f];this.queryMatches(e,a,!0)&&(c.append(e.element),d=!0,!b&&this.queryMatches(e,a)&&(this.setHint(a,e),b=!0))}b||this.clearHint();d?this.shown?this.addKeyBoardNavigation():a&&this.show():this.hide()};
